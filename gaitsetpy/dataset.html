<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.4"/>
    <title>gaitsetpy.dataset API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../gaitsetpy.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;gaitsetpy</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#DaphnetLoader">DaphnetLoader</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DaphnetLoader.__init__">DaphnetLoader</a>
                        </li>
                        <li>
                                <a class="variable" href="#DaphnetLoader.metadata">metadata</a>
                        </li>
                        <li>
                                <a class="function" href="#DaphnetLoader.load_data">load_data</a>
                        </li>
                        <li>
                                <a class="function" href="#DaphnetLoader.create_sliding_windows">create_sliding_windows</a>
                        </li>
                        <li>
                                <a class="function" href="#DaphnetLoader.get_supported_formats">get_supported_formats</a>
                        </li>
                        <li>
                                <a class="function" href="#DaphnetLoader.get_sensor_info">get_sensor_info</a>
                        </li>
                        <li>
                                <a class="function" href="#DaphnetLoader.get_annotation_info">get_annotation_info</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MobiFallLoader">MobiFallLoader</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MobiFallLoader.__init__">MobiFallLoader</a>
                        </li>
                        <li>
                                <a class="variable" href="#MobiFallLoader.metadata">metadata</a>
                        </li>
                        <li>
                                <a class="function" href="#MobiFallLoader.load_data">load_data</a>
                        </li>
                        <li>
                                <a class="function" href="#MobiFallLoader.create_sliding_windows">create_sliding_windows</a>
                        </li>
                        <li>
                                <a class="function" href="#MobiFallLoader.get_supported_formats">get_supported_formats</a>
                        </li>
                        <li>
                                <a class="function" href="#MobiFallLoader.get_sensor_info">get_sensor_info</a>
                        </li>
                        <li>
                                <a class="function" href="#MobiFallLoader.get_activity_info">get_activity_info</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ArduousLoader">ArduousLoader</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ArduousLoader.__init__">ArduousLoader</a>
                        </li>
                        <li>
                                <a class="variable" href="#ArduousLoader.metadata">metadata</a>
                        </li>
                        <li>
                                <a class="function" href="#ArduousLoader.load_data">load_data</a>
                        </li>
                        <li>
                                <a class="function" href="#ArduousLoader.create_sliding_windows">create_sliding_windows</a>
                        </li>
                        <li>
                                <a class="function" href="#ArduousLoader.get_supported_formats">get_supported_formats</a>
                        </li>
                        <li>
                                <a class="function" href="#ArduousLoader.get_sensor_info">get_sensor_info</a>
                        </li>
                        <li>
                                <a class="function" href="#ArduousLoader.get_activity_info">get_activity_info</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PhysioNetLoader">PhysioNetLoader</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PhysioNetLoader.__init__">PhysioNetLoader</a>
                        </li>
                        <li>
                                <a class="variable" href="#PhysioNetLoader.metadata">metadata</a>
                        </li>
                        <li>
                                <a class="variable" href="#PhysioNetLoader.labels">labels</a>
                        </li>
                        <li>
                                <a class="variable" href="#PhysioNetLoader.subject_types">subject_types</a>
                        </li>
                        <li>
                                <a class="function" href="#PhysioNetLoader.load_data">load_data</a>
                        </li>
                        <li>
                                <a class="function" href="#PhysioNetLoader.create_sliding_windows">create_sliding_windows</a>
                        </li>
                        <li>
                                <a class="function" href="#PhysioNetLoader.get_supported_formats">get_supported_formats</a>
                        </li>
                        <li>
                                <a class="function" href="#PhysioNetLoader.get_sensor_info">get_sensor_info</a>
                        </li>
                        <li>
                                <a class="function" href="#PhysioNetLoader.get_subject_info">get_subject_info</a>
                        </li>
                        <li>
                                <a class="function" href="#PhysioNetLoader.get_labels">get_labels</a>
                        </li>
                        <li>
                                <a class="function" href="#PhysioNetLoader.filter_by_subject_type">filter_by_subject_type</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#HARUPLoader">HARUPLoader</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#HARUPLoader.__init__">HARUPLoader</a>
                        </li>
                        <li>
                                <a class="variable" href="#HARUPLoader.metadata">metadata</a>
                        </li>
                        <li>
                                <a class="variable" href="#HARUPLoader.features">features</a>
                        </li>
                        <li>
                                <a class="function" href="#HARUPLoader.download_harup_data">download_harup_data</a>
                        </li>
                        <li>
                                <a class="function" href="#HARUPLoader.load_data">load_data</a>
                        </li>
                        <li>
                                <a class="function" href="#HARUPLoader.create_sliding_windows">create_sliding_windows</a>
                        </li>
                        <li>
                                <a class="function" href="#HARUPLoader.extract_features">extract_features</a>
                        </li>
                        <li>
                                <a class="function" href="#HARUPLoader.get_supported_formats">get_supported_formats</a>
                        </li>
                        <li>
                                <a class="function" href="#HARUPLoader.get_sensor_info">get_sensor_info</a>
                        </li>
                        <li>
                                <a class="function" href="#HARUPLoader.get_activity_info">get_activity_info</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#UrFallLoader">UrFallLoader</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#UrFallLoader.__init__">UrFallLoader</a>
                        </li>
                        <li>
                                <a class="variable" href="#UrFallLoader.metadata">metadata</a>
                        </li>
                        <li>
                                <a class="function" href="#UrFallLoader.load_data">load_data</a>
                        </li>
                        <li>
                                <a class="function" href="#UrFallLoader.get_file_paths">get_file_paths</a>
                        </li>
                        <li>
                                <a class="function" href="#UrFallLoader.create_sliding_windows">create_sliding_windows</a>
                        </li>
                        <li>
                                <a class="function" href="#UrFallLoader.get_supported_formats">get_supported_formats</a>
                        </li>
                        <li>
                                <a class="function" href="#UrFallLoader.get_sensor_info">get_sensor_info</a>
                        </li>
                        <li>
                                <a class="function" href="#UrFallLoader.get_activity_info">get_activity_info</a>
                        </li>
                        <li>
                                <a class="function" href="#UrFallLoader.get_feature_info">get_feature_info</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#load_daphnet_data">load_daphnet_data</a>
            </li>
            <li>
                    <a class="function" href="#create_sliding_windows">create_sliding_windows</a>
            </li>
            <li>
                    <a class="function" href="#load_mobifall_data">load_mobifall_data</a>
            </li>
            <li>
                    <a class="function" href="#load_arduous_data">load_arduous_data</a>
            </li>
            <li>
                    <a class="function" href="#load_physionet_data">load_physionet_data</a>
            </li>
            <li>
                    <a class="function" href="#create_physionet_windows">create_physionet_windows</a>
            </li>
            <li>
                    <a class="function" href="#load_harup_data">load_harup_data</a>
            </li>
            <li>
                    <a class="function" href="#create_harup_windows">create_harup_windows</a>
            </li>
            <li>
                    <a class="function" href="#extract_harup_features">extract_harup_features</a>
            </li>
            <li>
                    <a class="function" href="#load_urfall_data">load_urfall_data</a>
            </li>
            <li>
                    <a class="function" href="#create_urfall_windows">create_urfall_windows</a>
            </li>
            <li>
                    <a class="function" href="#download_dataset">download_dataset</a>
            </li>
            <li>
                    <a class="function" href="#extract_dataset">extract_dataset</a>
            </li>
            <li>
                    <a class="function" href="#sliding_window">sliding_window</a>
            </li>
            <li>
                    <a class="function" href="#get_dataset_manager">get_dataset_manager</a>
            </li>
            <li>
                    <a class="function" href="#get_available_datasets">get_available_datasets</a>
            </li>
            <li>
                    <a class="function" href="#load_dataset">load_dataset</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../gaitsetpy.html">gaitsetpy</a><wbr>.dataset    </h1>

                        <div class="docstring"><p>dataset: Handles loading and processing of supported datasets.</p>

<p>This module provides both the new class-based dataset loaders and legacy function-based API.
All dataset loaders inherit from BaseDatasetLoader and are registered with the DatasetManager.</p>

<p>Supported datasets:</p>

<ul>
<li>Daphnet: Freezing of Gait dataset</li>
<li>MobiFall: Fall detection dataset</li>
<li>Arduous: Daily activity recognition dataset</li>
<li>PhysioNet: VGRF dataset for Parkinson's disease gait analysis</li>
<li>HAR-UP: Multimodal System for Fall Detection and Human Activity Recognition</li>
<li>UrFall: University of Rzeszow Fall Detection Dataset with multimodal data</li>
</ul>
</div>

                        <input id="mod-dataset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-dataset-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">dataset: Handles loading and processing of supported datasets.</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">This module provides both the new class-based dataset loaders and legacy function-based API.</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">All dataset loaders inherit from BaseDatasetLoader and are registered with the DatasetManager.</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">Supported datasets:</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">- Daphnet: Freezing of Gait dataset</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">- MobiFall: Fall detection dataset</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">- Arduous: Daily activity recognition dataset</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="sd">- PhysioNet: VGRF dataset for Parkinson&#39;s disease gait analysis</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="sd">- HAR-UP: Multimodal System for Fall Detection and Human Activity Recognition</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="sd">- UrFall: University of Rzeszow Fall Detection Dataset with multimodal data</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="c1"># Import the new class-based loaders</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.daphnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">DaphnetLoader</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.mobifall</span><span class="w"> </span><span class="kn">import</span> <span class="n">MobiFallLoader</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.arduous</span><span class="w"> </span><span class="kn">import</span> <span class="n">ArduousLoader</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.physionet</span><span class="w"> </span><span class="kn">import</span> <span class="n">PhysioNetLoader</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.harup</span><span class="w"> </span><span class="kn">import</span> <span class="n">HARUPLoader</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.urfall</span><span class="w"> </span><span class="kn">import</span> <span class="n">UrFallLoader</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="c1"># Import legacy functions for backward compatibility</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.daphnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_daphnet_data</span><span class="p">,</span> <span class="n">create_sliding_windows</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.mobifall</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_mobifall_data</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.arduous</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_arduous_data</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.physionet</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_physionet_data</span><span class="p">,</span> <span class="n">create_physionet_windows</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.harup</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_harup_data</span><span class="p">,</span> <span class="n">create_harup_windows</span><span class="p">,</span> <span class="n">extract_harup_features</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.urfall</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_urfall_data</span><span class="p">,</span> <span class="n">create_urfall_windows</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">download_dataset</span><span class="p">,</span> <span class="n">extract_dataset</span><span class="p">,</span> <span class="n">sliding_window</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="c1"># Import managers</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">..core.managers</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatasetManager</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="c1"># Register all dataset loaders with the manager</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="k">def</span><span class="w"> </span><span class="nf">_register_datasets</span><span class="p">():</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Register all available dataset loaders with the DatasetManager.&quot;&quot;&quot;</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>    <span class="n">manager</span> <span class="o">=</span> <span class="n">DatasetManager</span><span class="p">()</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>    <span class="n">manager</span><span class="o">.</span><span class="n">register_dataset</span><span class="p">(</span><span class="s2">&quot;daphnet&quot;</span><span class="p">,</span> <span class="n">DaphnetLoader</span><span class="p">)</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>    <span class="n">manager</span><span class="o">.</span><span class="n">register_dataset</span><span class="p">(</span><span class="s2">&quot;mobifall&quot;</span><span class="p">,</span> <span class="n">MobiFallLoader</span><span class="p">)</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>    <span class="n">manager</span><span class="o">.</span><span class="n">register_dataset</span><span class="p">(</span><span class="s2">&quot;arduous&quot;</span><span class="p">,</span> <span class="n">ArduousLoader</span><span class="p">)</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>    <span class="n">manager</span><span class="o">.</span><span class="n">register_dataset</span><span class="p">(</span><span class="s2">&quot;physionet&quot;</span><span class="p">,</span> <span class="n">PhysioNetLoader</span><span class="p">)</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>    <span class="n">manager</span><span class="o">.</span><span class="n">register_dataset</span><span class="p">(</span><span class="s2">&quot;harup&quot;</span><span class="p">,</span> <span class="n">HARUPLoader</span><span class="p">)</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>    <span class="n">manager</span><span class="o">.</span><span class="n">register_dataset</span><span class="p">(</span><span class="s2">&quot;urfall&quot;</span><span class="p">,</span> <span class="n">UrFallLoader</span><span class="p">)</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="c1"># Auto-register datasets when module is imported</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="n">_register_datasets</span><span class="p">()</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="c1"># Convenient access to the dataset manager</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_dataset_manager</span><span class="p">():</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the singleton DatasetManager instance.&quot;&quot;&quot;</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>    <span class="k">return</span> <span class="n">DatasetManager</span><span class="p">()</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="c1"># Helper function to get available datasets</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_available_datasets</span><span class="p">():</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get list of available dataset names.&quot;&quot;&quot;</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>    <span class="k">return</span> <span class="n">DatasetManager</span><span class="p">()</span><span class="o">.</span><span class="n">get_available_components</span><span class="p">()</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="c1"># Helper function to load dataset using manager</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="k">def</span><span class="w"> </span><span class="nf">load_dataset</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">    Load a dataset using the DatasetManager.</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">    </span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">    Args:</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">        name: Name of the dataset loader</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">        data_dir: Directory containing the dataset</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">        **kwargs: Additional arguments for the loader</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">        </span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">    Returns:</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">        Dataset loader instance with loaded data</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>    <span class="k">return</span> <span class="n">DatasetManager</span><span class="p">()</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>    <span class="c1"># New class-based loaders</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>    <span class="s1">&#39;DaphnetLoader&#39;</span><span class="p">,</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>    <span class="s1">&#39;MobiFallLoader&#39;</span><span class="p">,</span> 
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>    <span class="s1">&#39;ArduousLoader&#39;</span><span class="p">,</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>    <span class="s1">&#39;PhysioNetLoader&#39;</span><span class="p">,</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>    <span class="s1">&#39;HARUPLoader&#39;</span><span class="p">,</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>    <span class="s1">&#39;UrFallLoader&#39;</span><span class="p">,</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>    <span class="c1"># Legacy functions for backward compatibility</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>    <span class="s1">&#39;load_daphnet_data&#39;</span><span class="p">,</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>    <span class="s1">&#39;create_sliding_windows&#39;</span><span class="p">,</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>    <span class="s1">&#39;load_mobifall_data&#39;</span><span class="p">,</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>    <span class="s1">&#39;load_arduous_data&#39;</span><span class="p">,</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>    <span class="s1">&#39;load_physionet_data&#39;</span><span class="p">,</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>    <span class="s1">&#39;create_physionet_windows&#39;</span><span class="p">,</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>    <span class="s1">&#39;load_harup_data&#39;</span><span class="p">,</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>    <span class="s1">&#39;create_harup_windows&#39;</span><span class="p">,</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>    <span class="s1">&#39;extract_harup_features&#39;</span><span class="p">,</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>    <span class="s1">&#39;load_urfall_data&#39;</span><span class="p">,</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>    <span class="s1">&#39;create_urfall_windows&#39;</span><span class="p">,</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>    <span class="s1">&#39;download_dataset&#39;</span><span class="p">,</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>    <span class="s1">&#39;extract_dataset&#39;</span><span class="p">,</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>    <span class="s1">&#39;sliding_window&#39;</span><span class="p">,</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>    <span class="c1"># Manager functions</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>    <span class="s1">&#39;get_dataset_manager&#39;</span><span class="p">,</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>    <span class="s1">&#39;get_available_datasets&#39;</span><span class="p">,</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>    <span class="s1">&#39;load_dataset&#39;</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="DaphnetLoader">
                            <input id="DaphnetLoader-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DaphnetLoader</span><wbr>(<span class="base"><a href="core/base_classes.html#BaseDatasetLoader">gaitsetpy.core.base_classes.BaseDatasetLoader</a></span>):

                <label class="view-source-button" for="DaphnetLoader-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DaphnetLoader"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DaphnetLoader-18"><a href="#DaphnetLoader-18"><span class="linenos"> 18</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DaphnetLoader</span><span class="p">(</span><span class="n">BaseDatasetLoader</span><span class="p">):</span>
</span><span id="DaphnetLoader-19"><a href="#DaphnetLoader-19"><span class="linenos"> 19</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DaphnetLoader-20"><a href="#DaphnetLoader-20"><span class="linenos"> 20</span></a><span class="sd">    Daphnet dataset loader class.</span>
</span><span id="DaphnetLoader-21"><a href="#DaphnetLoader-21"><span class="linenos"> 21</span></a><span class="sd">    </span>
</span><span id="DaphnetLoader-22"><a href="#DaphnetLoader-22"><span class="linenos"> 22</span></a><span class="sd">    This class handles loading and processing of the Daphnet dataset for gait analysis.</span>
</span><span id="DaphnetLoader-23"><a href="#DaphnetLoader-23"><span class="linenos"> 23</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DaphnetLoader-24"><a href="#DaphnetLoader-24"><span class="linenos"> 24</span></a>    
</span><span id="DaphnetLoader-25"><a href="#DaphnetLoader-25"><span class="linenos"> 25</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">):</span>
</span><span id="DaphnetLoader-26"><a href="#DaphnetLoader-26"><span class="linenos"> 26</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DaphnetLoader-27"><a href="#DaphnetLoader-27"><span class="linenos"> 27</span></a><span class="sd">        Initialize Daphnet loader with concurrent download support.</span>
</span><span id="DaphnetLoader-28"><a href="#DaphnetLoader-28"><span class="linenos"> 28</span></a><span class="sd">        </span>
</span><span id="DaphnetLoader-29"><a href="#DaphnetLoader-29"><span class="linenos"> 29</span></a><span class="sd">        Args:</span>
</span><span id="DaphnetLoader-30"><a href="#DaphnetLoader-30"><span class="linenos"> 30</span></a><span class="sd">            max_workers: Maximum number of concurrent download threads (default: 8)</span>
</span><span id="DaphnetLoader-31"><a href="#DaphnetLoader-31"><span class="linenos"> 31</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DaphnetLoader-32"><a href="#DaphnetLoader-32"><span class="linenos"> 32</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="DaphnetLoader-33"><a href="#DaphnetLoader-33"><span class="linenos"> 33</span></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;daphnet&quot;</span><span class="p">,</span>
</span><span id="DaphnetLoader-34"><a href="#DaphnetLoader-34"><span class="linenos"> 34</span></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Daphnet Freezing of Gait Dataset - Contains accelerometer data from subjects with Parkinson&#39;s disease&quot;</span><span class="p">,</span>
</span><span id="DaphnetLoader-35"><a href="#DaphnetLoader-35"><span class="linenos"> 35</span></a>            <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span>
</span><span id="DaphnetLoader-36"><a href="#DaphnetLoader-36"><span class="linenos"> 36</span></a>        <span class="p">)</span>
</span><span id="DaphnetLoader-37"><a href="#DaphnetLoader-37"><span class="linenos"> 37</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DaphnetLoader-38"><a href="#DaphnetLoader-38"><span class="linenos"> 38</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;shank&#39;</span><span class="p">,</span> <span class="s1">&#39;thigh&#39;</span><span class="p">,</span> <span class="s1">&#39;trunk&#39;</span><span class="p">],</span>
</span><span id="DaphnetLoader-39"><a href="#DaphnetLoader-39"><span class="linenos"> 39</span></a>            <span class="s1">&#39;components&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;h_fd&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;h_l&#39;</span><span class="p">],</span>  <span class="c1"># horizontal forward, vertical, horizontal lateral</span>
</span><span id="DaphnetLoader-40"><a href="#DaphnetLoader-40"><span class="linenos"> 40</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span>
</span><span id="DaphnetLoader-41"><a href="#DaphnetLoader-41"><span class="linenos"> 41</span></a>            <span class="s1">&#39;annotations&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="DaphnetLoader-42"><a href="#DaphnetLoader-42"><span class="linenos"> 42</span></a>                <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;not_valid&#39;</span><span class="p">,</span>
</span><span id="DaphnetLoader-43"><a href="#DaphnetLoader-43"><span class="linenos"> 43</span></a>                <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;no_freeze&#39;</span><span class="p">,</span>
</span><span id="DaphnetLoader-44"><a href="#DaphnetLoader-44"><span class="linenos"> 44</span></a>                <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;freeze&#39;</span>
</span><span id="DaphnetLoader-45"><a href="#DaphnetLoader-45"><span class="linenos"> 45</span></a>            <span class="p">}</span>
</span><span id="DaphnetLoader-46"><a href="#DaphnetLoader-46"><span class="linenos"> 46</span></a>        <span class="p">}</span>
</span><span id="DaphnetLoader-47"><a href="#DaphnetLoader-47"><span class="linenos"> 47</span></a>    
</span><span id="DaphnetLoader-48"><a href="#DaphnetLoader-48"><span class="linenos"> 48</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="DaphnetLoader-49"><a href="#DaphnetLoader-49"><span class="linenos"> 49</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DaphnetLoader-50"><a href="#DaphnetLoader-50"><span class="linenos"> 50</span></a><span class="sd">        Load Daphnet dataset from the specified directory.</span>
</span><span id="DaphnetLoader-51"><a href="#DaphnetLoader-51"><span class="linenos"> 51</span></a><span class="sd">        </span>
</span><span id="DaphnetLoader-52"><a href="#DaphnetLoader-52"><span class="linenos"> 52</span></a><span class="sd">        Args:</span>
</span><span id="DaphnetLoader-53"><a href="#DaphnetLoader-53"><span class="linenos"> 53</span></a><span class="sd">            data_dir: Directory to store/find the dataset</span>
</span><span id="DaphnetLoader-54"><a href="#DaphnetLoader-54"><span class="linenos"> 54</span></a><span class="sd">            **kwargs: Additional arguments (unused for Daphnet)</span>
</span><span id="DaphnetLoader-55"><a href="#DaphnetLoader-55"><span class="linenos"> 55</span></a><span class="sd">            </span>
</span><span id="DaphnetLoader-56"><a href="#DaphnetLoader-56"><span class="linenos"> 56</span></a><span class="sd">        Returns:</span>
</span><span id="DaphnetLoader-57"><a href="#DaphnetLoader-57"><span class="linenos"> 57</span></a><span class="sd">            Tuple of (data_list, names_list)</span>
</span><span id="DaphnetLoader-58"><a href="#DaphnetLoader-58"><span class="linenos"> 58</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DaphnetLoader-59"><a href="#DaphnetLoader-59"><span class="linenos"> 59</span></a>        <span class="c1"># Download and extract if needed</span>
</span><span id="DaphnetLoader-60"><a href="#DaphnetLoader-60"><span class="linenos"> 60</span></a>        <span class="n">download_dataset</span><span class="p">(</span><span class="s2">&quot;daphnet&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</span><span id="DaphnetLoader-61"><a href="#DaphnetLoader-61"><span class="linenos"> 61</span></a>        <span class="n">extract_dataset</span><span class="p">(</span><span class="s2">&quot;daphnet&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</span><span id="DaphnetLoader-62"><a href="#DaphnetLoader-62"><span class="linenos"> 62</span></a>        
</span><span id="DaphnetLoader-63"><a href="#DaphnetLoader-63"><span class="linenos"> 63</span></a>        <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;dataset_fog_release/dataset&quot;</span><span class="p">)</span>
</span><span id="DaphnetLoader-64"><a href="#DaphnetLoader-64"><span class="linenos"> 64</span></a>        <span class="n">daphnet_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DaphnetLoader-65"><a href="#DaphnetLoader-65"><span class="linenos"> 65</span></a>        <span class="n">daphnet_names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DaphnetLoader-66"><a href="#DaphnetLoader-66"><span class="linenos"> 66</span></a>        
</span><span id="DaphnetLoader-67"><a href="#DaphnetLoader-67"><span class="linenos"> 67</span></a>        <span class="c1"># Load all subject files</span>
</span><span id="DaphnetLoader-68"><a href="#DaphnetLoader-68"><span class="linenos"> 68</span></a>        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;S*.txt&quot;</span><span class="p">))):</span>
</span><span id="DaphnetLoader-69"><a href="#DaphnetLoader-69"><span class="linenos"> 69</span></a>            <span class="c1"># Extract filename from path</span>
</span><span id="DaphnetLoader-70"><a href="#DaphnetLoader-70"><span class="linenos"> 70</span></a>            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span id="DaphnetLoader-71"><a href="#DaphnetLoader-71"><span class="linenos"> 71</span></a>            <span class="n">daphnet_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="DaphnetLoader-72"><a href="#DaphnetLoader-72"><span class="linenos"> 72</span></a>            
</span><span id="DaphnetLoader-73"><a href="#DaphnetLoader-73"><span class="linenos"> 73</span></a>            <span class="c1"># Load CSV with proper column names</span>
</span><span id="DaphnetLoader-74"><a href="#DaphnetLoader-74"><span class="linenos"> 74</span></a>            <span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DaphnetLoader-75"><a href="#DaphnetLoader-75"><span class="linenos"> 75</span></a>                <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;shank_h_fd&quot;</span><span class="p">,</span> <span class="s2">&quot;shank_v&quot;</span><span class="p">,</span> <span class="s2">&quot;shank_h_l&quot;</span><span class="p">,</span> 
</span><span id="DaphnetLoader-76"><a href="#DaphnetLoader-76"><span class="linenos"> 76</span></a>                <span class="s2">&quot;thigh_h_fd&quot;</span><span class="p">,</span> <span class="s2">&quot;thigh_v&quot;</span><span class="p">,</span> <span class="s2">&quot;thigh_h_l&quot;</span><span class="p">,</span> 
</span><span id="DaphnetLoader-77"><a href="#DaphnetLoader-77"><span class="linenos"> 77</span></a>                <span class="s2">&quot;trunk_h_fd&quot;</span><span class="p">,</span> <span class="s2">&quot;trunk_v&quot;</span><span class="p">,</span> <span class="s2">&quot;trunk_h_l&quot;</span><span class="p">,</span> <span class="s2">&quot;annotations&quot;</span>
</span><span id="DaphnetLoader-78"><a href="#DaphnetLoader-78"><span class="linenos"> 78</span></a>            <span class="p">]</span>
</span><span id="DaphnetLoader-79"><a href="#DaphnetLoader-79"><span class="linenos"> 79</span></a>            
</span><span id="DaphnetLoader-80"><a href="#DaphnetLoader-80"><span class="linenos"> 80</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">column_names</span><span class="p">)</span>
</span><span id="DaphnetLoader-81"><a href="#DaphnetLoader-81"><span class="linenos"> 81</span></a>            
</span><span id="DaphnetLoader-82"><a href="#DaphnetLoader-82"><span class="linenos"> 82</span></a>            <span class="c1"># Set time as index</span>
</span><span id="DaphnetLoader-83"><a href="#DaphnetLoader-83"><span class="linenos"> 83</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
</span><span id="DaphnetLoader-84"><a href="#DaphnetLoader-84"><span class="linenos"> 84</span></a>            
</span><span id="DaphnetLoader-85"><a href="#DaphnetLoader-85"><span class="linenos"> 85</span></a>            <span class="c1"># Calculate magnitude for each sensor</span>
</span><span id="DaphnetLoader-86"><a href="#DaphnetLoader-86"><span class="linenos"> 86</span></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;thigh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;thigh_h_l&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;thigh_v&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;thigh_h_fd&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DaphnetLoader-87"><a href="#DaphnetLoader-87"><span class="linenos"> 87</span></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;shank&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;shank_h_l&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;shank_v&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;shank_h_fd&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DaphnetLoader-88"><a href="#DaphnetLoader-88"><span class="linenos"> 88</span></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;trunk&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;trunk_h_l&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;trunk_v&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;trunk_h_fd&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DaphnetLoader-89"><a href="#DaphnetLoader-89"><span class="linenos"> 89</span></a>            
</span><span id="DaphnetLoader-90"><a href="#DaphnetLoader-90"><span class="linenos"> 90</span></a>            <span class="c1"># Reorder columns for consistency</span>
</span><span id="DaphnetLoader-91"><a href="#DaphnetLoader-91"><span class="linenos"> 91</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;shank&quot;</span><span class="p">,</span> <span class="s2">&quot;shank_h_fd&quot;</span><span class="p">,</span> <span class="s2">&quot;shank_v&quot;</span><span class="p">,</span> <span class="s2">&quot;shank_h_l&quot;</span><span class="p">,</span> 
</span><span id="DaphnetLoader-92"><a href="#DaphnetLoader-92"><span class="linenos"> 92</span></a>                    <span class="s2">&quot;thigh&quot;</span><span class="p">,</span> <span class="s2">&quot;thigh_h_fd&quot;</span><span class="p">,</span> <span class="s2">&quot;thigh_v&quot;</span><span class="p">,</span> <span class="s2">&quot;thigh_h_l&quot;</span><span class="p">,</span> 
</span><span id="DaphnetLoader-93"><a href="#DaphnetLoader-93"><span class="linenos"> 93</span></a>                    <span class="s2">&quot;trunk&quot;</span><span class="p">,</span> <span class="s2">&quot;trunk_h_fd&quot;</span><span class="p">,</span> <span class="s2">&quot;trunk_v&quot;</span><span class="p">,</span> <span class="s2">&quot;trunk_h_l&quot;</span><span class="p">,</span> <span class="s2">&quot;annotations&quot;</span><span class="p">]]</span>
</span><span id="DaphnetLoader-94"><a href="#DaphnetLoader-94"><span class="linenos"> 94</span></a>            
</span><span id="DaphnetLoader-95"><a href="#DaphnetLoader-95"><span class="linenos"> 95</span></a>            <span class="n">daphnet_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="DaphnetLoader-96"><a href="#DaphnetLoader-96"><span class="linenos"> 96</span></a>        
</span><span id="DaphnetLoader-97"><a href="#DaphnetLoader-97"><span class="linenos"> 97</span></a>        <span class="c1"># Store loaded data</span>
</span><span id="DaphnetLoader-98"><a href="#DaphnetLoader-98"><span class="linenos"> 98</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">daphnet_data</span>
</span><span id="DaphnetLoader-99"><a href="#DaphnetLoader-99"><span class="linenos"> 99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">daphnet_names</span>
</span><span id="DaphnetLoader-100"><a href="#DaphnetLoader-100"><span class="linenos">100</span></a>        
</span><span id="DaphnetLoader-101"><a href="#DaphnetLoader-101"><span class="linenos">101</span></a>        <span class="k">return</span> <span class="n">daphnet_data</span><span class="p">,</span> <span class="n">daphnet_names</span>
</span><span id="DaphnetLoader-102"><a href="#DaphnetLoader-102"><span class="linenos">102</span></a>    
</span><span id="DaphnetLoader-103"><a href="#DaphnetLoader-103"><span class="linenos">103</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_sliding_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> 
</span><span id="DaphnetLoader-104"><a href="#DaphnetLoader-104"><span class="linenos">104</span></a>                             <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">192</span><span class="p">,</span> <span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="DaphnetLoader-105"><a href="#DaphnetLoader-105"><span class="linenos">105</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DaphnetLoader-106"><a href="#DaphnetLoader-106"><span class="linenos">106</span></a><span class="sd">        Create sliding windows from the Daphnet dataset.</span>
</span><span id="DaphnetLoader-107"><a href="#DaphnetLoader-107"><span class="linenos">107</span></a><span class="sd">        </span>
</span><span id="DaphnetLoader-108"><a href="#DaphnetLoader-108"><span class="linenos">108</span></a><span class="sd">        Args:</span>
</span><span id="DaphnetLoader-109"><a href="#DaphnetLoader-109"><span class="linenos">109</span></a><span class="sd">            data: List of DataFrames containing Daphnet data</span>
</span><span id="DaphnetLoader-110"><a href="#DaphnetLoader-110"><span class="linenos">110</span></a><span class="sd">            names: List of names corresponding to the data</span>
</span><span id="DaphnetLoader-111"><a href="#DaphnetLoader-111"><span class="linenos">111</span></a><span class="sd">            window_size: Size of the sliding window (default: 192)</span>
</span><span id="DaphnetLoader-112"><a href="#DaphnetLoader-112"><span class="linenos">112</span></a><span class="sd">            step_size: Step size for the sliding window (default: 32)</span>
</span><span id="DaphnetLoader-113"><a href="#DaphnetLoader-113"><span class="linenos">113</span></a><span class="sd">            </span>
</span><span id="DaphnetLoader-114"><a href="#DaphnetLoader-114"><span class="linenos">114</span></a><span class="sd">        Returns:</span>
</span><span id="DaphnetLoader-115"><a href="#DaphnetLoader-115"><span class="linenos">115</span></a><span class="sd">            List of dictionaries containing sliding windows for each DataFrame</span>
</span><span id="DaphnetLoader-116"><a href="#DaphnetLoader-116"><span class="linenos">116</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DaphnetLoader-117"><a href="#DaphnetLoader-117"><span class="linenos">117</span></a>        <span class="n">windows_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DaphnetLoader-118"><a href="#DaphnetLoader-118"><span class="linenos">118</span></a>        
</span><span id="DaphnetLoader-119"><a href="#DaphnetLoader-119"><span class="linenos">119</span></a>        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span><span id="DaphnetLoader-120"><a href="#DaphnetLoader-120"><span class="linenos">120</span></a>            <span class="c1"># Filter out invalid data (annotations == 0)</span>
</span><span id="DaphnetLoader-121"><a href="#DaphnetLoader-121"><span class="linenos">121</span></a>            <span class="n">df_filtered</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">annotations</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="DaphnetLoader-122"><a href="#DaphnetLoader-122"><span class="linenos">122</span></a>            
</span><span id="DaphnetLoader-123"><a href="#DaphnetLoader-123"><span class="linenos">123</span></a>            <span class="k">if</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="DaphnetLoader-124"><a href="#DaphnetLoader-124"><span class="linenos">124</span></a>                <span class="k">continue</span>
</span><span id="DaphnetLoader-125"><a href="#DaphnetLoader-125"><span class="linenos">125</span></a>                
</span><span id="DaphnetLoader-126"><a href="#DaphnetLoader-126"><span class="linenos">126</span></a>            <span class="n">windows</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DaphnetLoader-127"><a href="#DaphnetLoader-127"><span class="linenos">127</span></a>            <span class="n">processed_columns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="DaphnetLoader-128"><a href="#DaphnetLoader-128"><span class="linenos">128</span></a>            
</span><span id="DaphnetLoader-129"><a href="#DaphnetLoader-129"><span class="linenos">129</span></a>            <span class="c1"># Process each sensor column</span>
</span><span id="DaphnetLoader-130"><a href="#DaphnetLoader-130"><span class="linenos">130</span></a>            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="DaphnetLoader-131"><a href="#DaphnetLoader-131"><span class="linenos">131</span></a>                <span class="k">if</span> <span class="n">col</span> <span class="o">!=</span> <span class="s2">&quot;annotations&quot;</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">processed_columns</span><span class="p">:</span>
</span><span id="DaphnetLoader-132"><a href="#DaphnetLoader-132"><span class="linenos">132</span></a>                    <span class="n">window_data</span> <span class="o">=</span> <span class="n">sliding_window</span><span class="p">(</span><span class="n">df_filtered</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span><span id="DaphnetLoader-133"><a href="#DaphnetLoader-133"><span class="linenos">133</span></a>                    <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">col</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">window_data</span><span class="p">})</span>
</span><span id="DaphnetLoader-134"><a href="#DaphnetLoader-134"><span class="linenos">134</span></a>                    <span class="n">processed_columns</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</span><span id="DaphnetLoader-135"><a href="#DaphnetLoader-135"><span class="linenos">135</span></a>            
</span><span id="DaphnetLoader-136"><a href="#DaphnetLoader-136"><span class="linenos">136</span></a>            <span class="c1"># Include annotations separately</span>
</span><span id="DaphnetLoader-137"><a href="#DaphnetLoader-137"><span class="linenos">137</span></a>            <span class="n">annotations_window</span> <span class="o">=</span> <span class="n">sliding_window</span><span class="p">(</span><span class="n">df_filtered</span><span class="p">[</span><span class="s2">&quot;annotations&quot;</span><span class="p">],</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span><span id="DaphnetLoader-138"><a href="#DaphnetLoader-138"><span class="linenos">138</span></a>            <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;annotations&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">annotations_window</span><span class="p">})</span>
</span><span id="DaphnetLoader-139"><a href="#DaphnetLoader-139"><span class="linenos">139</span></a>            
</span><span id="DaphnetLoader-140"><a href="#DaphnetLoader-140"><span class="linenos">140</span></a>            <span class="n">windows_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="s2">&quot;windows&quot;</span><span class="p">:</span> <span class="n">windows</span><span class="p">})</span>
</span><span id="DaphnetLoader-141"><a href="#DaphnetLoader-141"><span class="linenos">141</span></a>        
</span><span id="DaphnetLoader-142"><a href="#DaphnetLoader-142"><span class="linenos">142</span></a>        <span class="k">return</span> <span class="n">windows_data</span>
</span><span id="DaphnetLoader-143"><a href="#DaphnetLoader-143"><span class="linenos">143</span></a>    
</span><span id="DaphnetLoader-144"><a href="#DaphnetLoader-144"><span class="linenos">144</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_supported_formats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="DaphnetLoader-145"><a href="#DaphnetLoader-145"><span class="linenos">145</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DaphnetLoader-146"><a href="#DaphnetLoader-146"><span class="linenos">146</span></a><span class="sd">        Get list of supported file formats for Daphnet dataset.</span>
</span><span id="DaphnetLoader-147"><a href="#DaphnetLoader-147"><span class="linenos">147</span></a><span class="sd">        </span>
</span><span id="DaphnetLoader-148"><a href="#DaphnetLoader-148"><span class="linenos">148</span></a><span class="sd">        Returns:</span>
</span><span id="DaphnetLoader-149"><a href="#DaphnetLoader-149"><span class="linenos">149</span></a><span class="sd">            List of supported file extensions</span>
</span><span id="DaphnetLoader-150"><a href="#DaphnetLoader-150"><span class="linenos">150</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DaphnetLoader-151"><a href="#DaphnetLoader-151"><span class="linenos">151</span></a>        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;.txt&#39;</span><span class="p">]</span>
</span><span id="DaphnetLoader-152"><a href="#DaphnetLoader-152"><span class="linenos">152</span></a>    
</span><span id="DaphnetLoader-153"><a href="#DaphnetLoader-153"><span class="linenos">153</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sensor_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="DaphnetLoader-154"><a href="#DaphnetLoader-154"><span class="linenos">154</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DaphnetLoader-155"><a href="#DaphnetLoader-155"><span class="linenos">155</span></a><span class="sd">        Get information about sensors in the dataset.</span>
</span><span id="DaphnetLoader-156"><a href="#DaphnetLoader-156"><span class="linenos">156</span></a><span class="sd">        </span>
</span><span id="DaphnetLoader-157"><a href="#DaphnetLoader-157"><span class="linenos">157</span></a><span class="sd">        Returns:</span>
</span><span id="DaphnetLoader-158"><a href="#DaphnetLoader-158"><span class="linenos">158</span></a><span class="sd">            Dictionary containing sensor information</span>
</span><span id="DaphnetLoader-159"><a href="#DaphnetLoader-159"><span class="linenos">159</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DaphnetLoader-160"><a href="#DaphnetLoader-160"><span class="linenos">160</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="DaphnetLoader-161"><a href="#DaphnetLoader-161"><span class="linenos">161</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sensors&#39;</span><span class="p">],</span>
</span><span id="DaphnetLoader-162"><a href="#DaphnetLoader-162"><span class="linenos">162</span></a>            <span class="s1">&#39;components&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;components&#39;</span><span class="p">],</span>
</span><span id="DaphnetLoader-163"><a href="#DaphnetLoader-163"><span class="linenos">163</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sampling_frequency&#39;</span><span class="p">]</span>
</span><span id="DaphnetLoader-164"><a href="#DaphnetLoader-164"><span class="linenos">164</span></a>        <span class="p">}</span>
</span><span id="DaphnetLoader-165"><a href="#DaphnetLoader-165"><span class="linenos">165</span></a>    
</span><span id="DaphnetLoader-166"><a href="#DaphnetLoader-166"><span class="linenos">166</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_annotation_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="DaphnetLoader-167"><a href="#DaphnetLoader-167"><span class="linenos">167</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DaphnetLoader-168"><a href="#DaphnetLoader-168"><span class="linenos">168</span></a><span class="sd">        Get information about annotations in the dataset.</span>
</span><span id="DaphnetLoader-169"><a href="#DaphnetLoader-169"><span class="linenos">169</span></a><span class="sd">        </span>
</span><span id="DaphnetLoader-170"><a href="#DaphnetLoader-170"><span class="linenos">170</span></a><span class="sd">        Returns:</span>
</span><span id="DaphnetLoader-171"><a href="#DaphnetLoader-171"><span class="linenos">171</span></a><span class="sd">            Dictionary mapping annotation values to descriptions</span>
</span><span id="DaphnetLoader-172"><a href="#DaphnetLoader-172"><span class="linenos">172</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DaphnetLoader-173"><a href="#DaphnetLoader-173"><span class="linenos">173</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;annotations&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Daphnet dataset loader class.</p>

<p>This class handles loading and processing of the Daphnet dataset for gait analysis.</p>
</div>


                            <div id="DaphnetLoader.__init__" class="classattr">
                                        <input id="DaphnetLoader.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">DaphnetLoader</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span></span>)</span>

                <label class="view-source-button" for="DaphnetLoader.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DaphnetLoader.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DaphnetLoader.__init__-25"><a href="#DaphnetLoader.__init__-25"><span class="linenos">25</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">):</span>
</span><span id="DaphnetLoader.__init__-26"><a href="#DaphnetLoader.__init__-26"><span class="linenos">26</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DaphnetLoader.__init__-27"><a href="#DaphnetLoader.__init__-27"><span class="linenos">27</span></a><span class="sd">        Initialize Daphnet loader with concurrent download support.</span>
</span><span id="DaphnetLoader.__init__-28"><a href="#DaphnetLoader.__init__-28"><span class="linenos">28</span></a><span class="sd">        </span>
</span><span id="DaphnetLoader.__init__-29"><a href="#DaphnetLoader.__init__-29"><span class="linenos">29</span></a><span class="sd">        Args:</span>
</span><span id="DaphnetLoader.__init__-30"><a href="#DaphnetLoader.__init__-30"><span class="linenos">30</span></a><span class="sd">            max_workers: Maximum number of concurrent download threads (default: 8)</span>
</span><span id="DaphnetLoader.__init__-31"><a href="#DaphnetLoader.__init__-31"><span class="linenos">31</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DaphnetLoader.__init__-32"><a href="#DaphnetLoader.__init__-32"><span class="linenos">32</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="DaphnetLoader.__init__-33"><a href="#DaphnetLoader.__init__-33"><span class="linenos">33</span></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;daphnet&quot;</span><span class="p">,</span>
</span><span id="DaphnetLoader.__init__-34"><a href="#DaphnetLoader.__init__-34"><span class="linenos">34</span></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Daphnet Freezing of Gait Dataset - Contains accelerometer data from subjects with Parkinson&#39;s disease&quot;</span><span class="p">,</span>
</span><span id="DaphnetLoader.__init__-35"><a href="#DaphnetLoader.__init__-35"><span class="linenos">35</span></a>            <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span>
</span><span id="DaphnetLoader.__init__-36"><a href="#DaphnetLoader.__init__-36"><span class="linenos">36</span></a>        <span class="p">)</span>
</span><span id="DaphnetLoader.__init__-37"><a href="#DaphnetLoader.__init__-37"><span class="linenos">37</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DaphnetLoader.__init__-38"><a href="#DaphnetLoader.__init__-38"><span class="linenos">38</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;shank&#39;</span><span class="p">,</span> <span class="s1">&#39;thigh&#39;</span><span class="p">,</span> <span class="s1">&#39;trunk&#39;</span><span class="p">],</span>
</span><span id="DaphnetLoader.__init__-39"><a href="#DaphnetLoader.__init__-39"><span class="linenos">39</span></a>            <span class="s1">&#39;components&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;h_fd&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;h_l&#39;</span><span class="p">],</span>  <span class="c1"># horizontal forward, vertical, horizontal lateral</span>
</span><span id="DaphnetLoader.__init__-40"><a href="#DaphnetLoader.__init__-40"><span class="linenos">40</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span>
</span><span id="DaphnetLoader.__init__-41"><a href="#DaphnetLoader.__init__-41"><span class="linenos">41</span></a>            <span class="s1">&#39;annotations&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="DaphnetLoader.__init__-42"><a href="#DaphnetLoader.__init__-42"><span class="linenos">42</span></a>                <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;not_valid&#39;</span><span class="p">,</span>
</span><span id="DaphnetLoader.__init__-43"><a href="#DaphnetLoader.__init__-43"><span class="linenos">43</span></a>                <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;no_freeze&#39;</span><span class="p">,</span>
</span><span id="DaphnetLoader.__init__-44"><a href="#DaphnetLoader.__init__-44"><span class="linenos">44</span></a>                <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;freeze&#39;</span>
</span><span id="DaphnetLoader.__init__-45"><a href="#DaphnetLoader.__init__-45"><span class="linenos">45</span></a>            <span class="p">}</span>
</span><span id="DaphnetLoader.__init__-46"><a href="#DaphnetLoader.__init__-46"><span class="linenos">46</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Initialize Daphnet loader with concurrent download support.</p>

<p>Args:
    max_workers: Maximum number of concurrent download threads (default: 8)</p>
</div>


                            </div>
                            <div id="DaphnetLoader.metadata" class="classattr">
                                <div class="attr variable">
            <span class="name">metadata</span>

        
    </div>
    <a class="headerlink" href="#DaphnetLoader.metadata"></a>
    
    

                            </div>
                            <div id="DaphnetLoader.load_data" class="classattr">
                                        <input id="DaphnetLoader.load_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_data</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="DaphnetLoader.load_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DaphnetLoader.load_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DaphnetLoader.load_data-48"><a href="#DaphnetLoader.load_data-48"><span class="linenos"> 48</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="DaphnetLoader.load_data-49"><a href="#DaphnetLoader.load_data-49"><span class="linenos"> 49</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DaphnetLoader.load_data-50"><a href="#DaphnetLoader.load_data-50"><span class="linenos"> 50</span></a><span class="sd">        Load Daphnet dataset from the specified directory.</span>
</span><span id="DaphnetLoader.load_data-51"><a href="#DaphnetLoader.load_data-51"><span class="linenos"> 51</span></a><span class="sd">        </span>
</span><span id="DaphnetLoader.load_data-52"><a href="#DaphnetLoader.load_data-52"><span class="linenos"> 52</span></a><span class="sd">        Args:</span>
</span><span id="DaphnetLoader.load_data-53"><a href="#DaphnetLoader.load_data-53"><span class="linenos"> 53</span></a><span class="sd">            data_dir: Directory to store/find the dataset</span>
</span><span id="DaphnetLoader.load_data-54"><a href="#DaphnetLoader.load_data-54"><span class="linenos"> 54</span></a><span class="sd">            **kwargs: Additional arguments (unused for Daphnet)</span>
</span><span id="DaphnetLoader.load_data-55"><a href="#DaphnetLoader.load_data-55"><span class="linenos"> 55</span></a><span class="sd">            </span>
</span><span id="DaphnetLoader.load_data-56"><a href="#DaphnetLoader.load_data-56"><span class="linenos"> 56</span></a><span class="sd">        Returns:</span>
</span><span id="DaphnetLoader.load_data-57"><a href="#DaphnetLoader.load_data-57"><span class="linenos"> 57</span></a><span class="sd">            Tuple of (data_list, names_list)</span>
</span><span id="DaphnetLoader.load_data-58"><a href="#DaphnetLoader.load_data-58"><span class="linenos"> 58</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DaphnetLoader.load_data-59"><a href="#DaphnetLoader.load_data-59"><span class="linenos"> 59</span></a>        <span class="c1"># Download and extract if needed</span>
</span><span id="DaphnetLoader.load_data-60"><a href="#DaphnetLoader.load_data-60"><span class="linenos"> 60</span></a>        <span class="n">download_dataset</span><span class="p">(</span><span class="s2">&quot;daphnet&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</span><span id="DaphnetLoader.load_data-61"><a href="#DaphnetLoader.load_data-61"><span class="linenos"> 61</span></a>        <span class="n">extract_dataset</span><span class="p">(</span><span class="s2">&quot;daphnet&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</span><span id="DaphnetLoader.load_data-62"><a href="#DaphnetLoader.load_data-62"><span class="linenos"> 62</span></a>        
</span><span id="DaphnetLoader.load_data-63"><a href="#DaphnetLoader.load_data-63"><span class="linenos"> 63</span></a>        <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;dataset_fog_release/dataset&quot;</span><span class="p">)</span>
</span><span id="DaphnetLoader.load_data-64"><a href="#DaphnetLoader.load_data-64"><span class="linenos"> 64</span></a>        <span class="n">daphnet_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DaphnetLoader.load_data-65"><a href="#DaphnetLoader.load_data-65"><span class="linenos"> 65</span></a>        <span class="n">daphnet_names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DaphnetLoader.load_data-66"><a href="#DaphnetLoader.load_data-66"><span class="linenos"> 66</span></a>        
</span><span id="DaphnetLoader.load_data-67"><a href="#DaphnetLoader.load_data-67"><span class="linenos"> 67</span></a>        <span class="c1"># Load all subject files</span>
</span><span id="DaphnetLoader.load_data-68"><a href="#DaphnetLoader.load_data-68"><span class="linenos"> 68</span></a>        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;S*.txt&quot;</span><span class="p">))):</span>
</span><span id="DaphnetLoader.load_data-69"><a href="#DaphnetLoader.load_data-69"><span class="linenos"> 69</span></a>            <span class="c1"># Extract filename from path</span>
</span><span id="DaphnetLoader.load_data-70"><a href="#DaphnetLoader.load_data-70"><span class="linenos"> 70</span></a>            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span id="DaphnetLoader.load_data-71"><a href="#DaphnetLoader.load_data-71"><span class="linenos"> 71</span></a>            <span class="n">daphnet_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="DaphnetLoader.load_data-72"><a href="#DaphnetLoader.load_data-72"><span class="linenos"> 72</span></a>            
</span><span id="DaphnetLoader.load_data-73"><a href="#DaphnetLoader.load_data-73"><span class="linenos"> 73</span></a>            <span class="c1"># Load CSV with proper column names</span>
</span><span id="DaphnetLoader.load_data-74"><a href="#DaphnetLoader.load_data-74"><span class="linenos"> 74</span></a>            <span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DaphnetLoader.load_data-75"><a href="#DaphnetLoader.load_data-75"><span class="linenos"> 75</span></a>                <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;shank_h_fd&quot;</span><span class="p">,</span> <span class="s2">&quot;shank_v&quot;</span><span class="p">,</span> <span class="s2">&quot;shank_h_l&quot;</span><span class="p">,</span> 
</span><span id="DaphnetLoader.load_data-76"><a href="#DaphnetLoader.load_data-76"><span class="linenos"> 76</span></a>                <span class="s2">&quot;thigh_h_fd&quot;</span><span class="p">,</span> <span class="s2">&quot;thigh_v&quot;</span><span class="p">,</span> <span class="s2">&quot;thigh_h_l&quot;</span><span class="p">,</span> 
</span><span id="DaphnetLoader.load_data-77"><a href="#DaphnetLoader.load_data-77"><span class="linenos"> 77</span></a>                <span class="s2">&quot;trunk_h_fd&quot;</span><span class="p">,</span> <span class="s2">&quot;trunk_v&quot;</span><span class="p">,</span> <span class="s2">&quot;trunk_h_l&quot;</span><span class="p">,</span> <span class="s2">&quot;annotations&quot;</span>
</span><span id="DaphnetLoader.load_data-78"><a href="#DaphnetLoader.load_data-78"><span class="linenos"> 78</span></a>            <span class="p">]</span>
</span><span id="DaphnetLoader.load_data-79"><a href="#DaphnetLoader.load_data-79"><span class="linenos"> 79</span></a>            
</span><span id="DaphnetLoader.load_data-80"><a href="#DaphnetLoader.load_data-80"><span class="linenos"> 80</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">column_names</span><span class="p">)</span>
</span><span id="DaphnetLoader.load_data-81"><a href="#DaphnetLoader.load_data-81"><span class="linenos"> 81</span></a>            
</span><span id="DaphnetLoader.load_data-82"><a href="#DaphnetLoader.load_data-82"><span class="linenos"> 82</span></a>            <span class="c1"># Set time as index</span>
</span><span id="DaphnetLoader.load_data-83"><a href="#DaphnetLoader.load_data-83"><span class="linenos"> 83</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
</span><span id="DaphnetLoader.load_data-84"><a href="#DaphnetLoader.load_data-84"><span class="linenos"> 84</span></a>            
</span><span id="DaphnetLoader.load_data-85"><a href="#DaphnetLoader.load_data-85"><span class="linenos"> 85</span></a>            <span class="c1"># Calculate magnitude for each sensor</span>
</span><span id="DaphnetLoader.load_data-86"><a href="#DaphnetLoader.load_data-86"><span class="linenos"> 86</span></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;thigh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;thigh_h_l&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;thigh_v&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;thigh_h_fd&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DaphnetLoader.load_data-87"><a href="#DaphnetLoader.load_data-87"><span class="linenos"> 87</span></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;shank&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;shank_h_l&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;shank_v&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;shank_h_fd&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DaphnetLoader.load_data-88"><a href="#DaphnetLoader.load_data-88"><span class="linenos"> 88</span></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;trunk&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;trunk_h_l&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;trunk_v&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;trunk_h_fd&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DaphnetLoader.load_data-89"><a href="#DaphnetLoader.load_data-89"><span class="linenos"> 89</span></a>            
</span><span id="DaphnetLoader.load_data-90"><a href="#DaphnetLoader.load_data-90"><span class="linenos"> 90</span></a>            <span class="c1"># Reorder columns for consistency</span>
</span><span id="DaphnetLoader.load_data-91"><a href="#DaphnetLoader.load_data-91"><span class="linenos"> 91</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;shank&quot;</span><span class="p">,</span> <span class="s2">&quot;shank_h_fd&quot;</span><span class="p">,</span> <span class="s2">&quot;shank_v&quot;</span><span class="p">,</span> <span class="s2">&quot;shank_h_l&quot;</span><span class="p">,</span> 
</span><span id="DaphnetLoader.load_data-92"><a href="#DaphnetLoader.load_data-92"><span class="linenos"> 92</span></a>                    <span class="s2">&quot;thigh&quot;</span><span class="p">,</span> <span class="s2">&quot;thigh_h_fd&quot;</span><span class="p">,</span> <span class="s2">&quot;thigh_v&quot;</span><span class="p">,</span> <span class="s2">&quot;thigh_h_l&quot;</span><span class="p">,</span> 
</span><span id="DaphnetLoader.load_data-93"><a href="#DaphnetLoader.load_data-93"><span class="linenos"> 93</span></a>                    <span class="s2">&quot;trunk&quot;</span><span class="p">,</span> <span class="s2">&quot;trunk_h_fd&quot;</span><span class="p">,</span> <span class="s2">&quot;trunk_v&quot;</span><span class="p">,</span> <span class="s2">&quot;trunk_h_l&quot;</span><span class="p">,</span> <span class="s2">&quot;annotations&quot;</span><span class="p">]]</span>
</span><span id="DaphnetLoader.load_data-94"><a href="#DaphnetLoader.load_data-94"><span class="linenos"> 94</span></a>            
</span><span id="DaphnetLoader.load_data-95"><a href="#DaphnetLoader.load_data-95"><span class="linenos"> 95</span></a>            <span class="n">daphnet_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="DaphnetLoader.load_data-96"><a href="#DaphnetLoader.load_data-96"><span class="linenos"> 96</span></a>        
</span><span id="DaphnetLoader.load_data-97"><a href="#DaphnetLoader.load_data-97"><span class="linenos"> 97</span></a>        <span class="c1"># Store loaded data</span>
</span><span id="DaphnetLoader.load_data-98"><a href="#DaphnetLoader.load_data-98"><span class="linenos"> 98</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">daphnet_data</span>
</span><span id="DaphnetLoader.load_data-99"><a href="#DaphnetLoader.load_data-99"><span class="linenos"> 99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">daphnet_names</span>
</span><span id="DaphnetLoader.load_data-100"><a href="#DaphnetLoader.load_data-100"><span class="linenos">100</span></a>        
</span><span id="DaphnetLoader.load_data-101"><a href="#DaphnetLoader.load_data-101"><span class="linenos">101</span></a>        <span class="k">return</span> <span class="n">daphnet_data</span><span class="p">,</span> <span class="n">daphnet_names</span>
</span></pre></div>


            <div class="docstring"><p>Load Daphnet dataset from the specified directory.</p>

<p>Args:
    data_dir: Directory to store/find the dataset
    **kwargs: Additional arguments (unused for Daphnet)</p>

<p>Returns:
    Tuple of (data_list, names_list)</p>
</div>


                            </div>
                            <div id="DaphnetLoader.create_sliding_windows" class="classattr">
                                        <input id="DaphnetLoader.create_sliding_windows-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_sliding_windows</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>,</span><span class="param">	<span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">192</span>,</span><span class="param">	<span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="DaphnetLoader.create_sliding_windows-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DaphnetLoader.create_sliding_windows"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DaphnetLoader.create_sliding_windows-103"><a href="#DaphnetLoader.create_sliding_windows-103"><span class="linenos">103</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_sliding_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> 
</span><span id="DaphnetLoader.create_sliding_windows-104"><a href="#DaphnetLoader.create_sliding_windows-104"><span class="linenos">104</span></a>                             <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">192</span><span class="p">,</span> <span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="DaphnetLoader.create_sliding_windows-105"><a href="#DaphnetLoader.create_sliding_windows-105"><span class="linenos">105</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DaphnetLoader.create_sliding_windows-106"><a href="#DaphnetLoader.create_sliding_windows-106"><span class="linenos">106</span></a><span class="sd">        Create sliding windows from the Daphnet dataset.</span>
</span><span id="DaphnetLoader.create_sliding_windows-107"><a href="#DaphnetLoader.create_sliding_windows-107"><span class="linenos">107</span></a><span class="sd">        </span>
</span><span id="DaphnetLoader.create_sliding_windows-108"><a href="#DaphnetLoader.create_sliding_windows-108"><span class="linenos">108</span></a><span class="sd">        Args:</span>
</span><span id="DaphnetLoader.create_sliding_windows-109"><a href="#DaphnetLoader.create_sliding_windows-109"><span class="linenos">109</span></a><span class="sd">            data: List of DataFrames containing Daphnet data</span>
</span><span id="DaphnetLoader.create_sliding_windows-110"><a href="#DaphnetLoader.create_sliding_windows-110"><span class="linenos">110</span></a><span class="sd">            names: List of names corresponding to the data</span>
</span><span id="DaphnetLoader.create_sliding_windows-111"><a href="#DaphnetLoader.create_sliding_windows-111"><span class="linenos">111</span></a><span class="sd">            window_size: Size of the sliding window (default: 192)</span>
</span><span id="DaphnetLoader.create_sliding_windows-112"><a href="#DaphnetLoader.create_sliding_windows-112"><span class="linenos">112</span></a><span class="sd">            step_size: Step size for the sliding window (default: 32)</span>
</span><span id="DaphnetLoader.create_sliding_windows-113"><a href="#DaphnetLoader.create_sliding_windows-113"><span class="linenos">113</span></a><span class="sd">            </span>
</span><span id="DaphnetLoader.create_sliding_windows-114"><a href="#DaphnetLoader.create_sliding_windows-114"><span class="linenos">114</span></a><span class="sd">        Returns:</span>
</span><span id="DaphnetLoader.create_sliding_windows-115"><a href="#DaphnetLoader.create_sliding_windows-115"><span class="linenos">115</span></a><span class="sd">            List of dictionaries containing sliding windows for each DataFrame</span>
</span><span id="DaphnetLoader.create_sliding_windows-116"><a href="#DaphnetLoader.create_sliding_windows-116"><span class="linenos">116</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DaphnetLoader.create_sliding_windows-117"><a href="#DaphnetLoader.create_sliding_windows-117"><span class="linenos">117</span></a>        <span class="n">windows_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DaphnetLoader.create_sliding_windows-118"><a href="#DaphnetLoader.create_sliding_windows-118"><span class="linenos">118</span></a>        
</span><span id="DaphnetLoader.create_sliding_windows-119"><a href="#DaphnetLoader.create_sliding_windows-119"><span class="linenos">119</span></a>        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span><span id="DaphnetLoader.create_sliding_windows-120"><a href="#DaphnetLoader.create_sliding_windows-120"><span class="linenos">120</span></a>            <span class="c1"># Filter out invalid data (annotations == 0)</span>
</span><span id="DaphnetLoader.create_sliding_windows-121"><a href="#DaphnetLoader.create_sliding_windows-121"><span class="linenos">121</span></a>            <span class="n">df_filtered</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">annotations</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="DaphnetLoader.create_sliding_windows-122"><a href="#DaphnetLoader.create_sliding_windows-122"><span class="linenos">122</span></a>            
</span><span id="DaphnetLoader.create_sliding_windows-123"><a href="#DaphnetLoader.create_sliding_windows-123"><span class="linenos">123</span></a>            <span class="k">if</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="DaphnetLoader.create_sliding_windows-124"><a href="#DaphnetLoader.create_sliding_windows-124"><span class="linenos">124</span></a>                <span class="k">continue</span>
</span><span id="DaphnetLoader.create_sliding_windows-125"><a href="#DaphnetLoader.create_sliding_windows-125"><span class="linenos">125</span></a>                
</span><span id="DaphnetLoader.create_sliding_windows-126"><a href="#DaphnetLoader.create_sliding_windows-126"><span class="linenos">126</span></a>            <span class="n">windows</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DaphnetLoader.create_sliding_windows-127"><a href="#DaphnetLoader.create_sliding_windows-127"><span class="linenos">127</span></a>            <span class="n">processed_columns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="DaphnetLoader.create_sliding_windows-128"><a href="#DaphnetLoader.create_sliding_windows-128"><span class="linenos">128</span></a>            
</span><span id="DaphnetLoader.create_sliding_windows-129"><a href="#DaphnetLoader.create_sliding_windows-129"><span class="linenos">129</span></a>            <span class="c1"># Process each sensor column</span>
</span><span id="DaphnetLoader.create_sliding_windows-130"><a href="#DaphnetLoader.create_sliding_windows-130"><span class="linenos">130</span></a>            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="DaphnetLoader.create_sliding_windows-131"><a href="#DaphnetLoader.create_sliding_windows-131"><span class="linenos">131</span></a>                <span class="k">if</span> <span class="n">col</span> <span class="o">!=</span> <span class="s2">&quot;annotations&quot;</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">processed_columns</span><span class="p">:</span>
</span><span id="DaphnetLoader.create_sliding_windows-132"><a href="#DaphnetLoader.create_sliding_windows-132"><span class="linenos">132</span></a>                    <span class="n">window_data</span> <span class="o">=</span> <span class="n">sliding_window</span><span class="p">(</span><span class="n">df_filtered</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span><span id="DaphnetLoader.create_sliding_windows-133"><a href="#DaphnetLoader.create_sliding_windows-133"><span class="linenos">133</span></a>                    <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">col</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">window_data</span><span class="p">})</span>
</span><span id="DaphnetLoader.create_sliding_windows-134"><a href="#DaphnetLoader.create_sliding_windows-134"><span class="linenos">134</span></a>                    <span class="n">processed_columns</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</span><span id="DaphnetLoader.create_sliding_windows-135"><a href="#DaphnetLoader.create_sliding_windows-135"><span class="linenos">135</span></a>            
</span><span id="DaphnetLoader.create_sliding_windows-136"><a href="#DaphnetLoader.create_sliding_windows-136"><span class="linenos">136</span></a>            <span class="c1"># Include annotations separately</span>
</span><span id="DaphnetLoader.create_sliding_windows-137"><a href="#DaphnetLoader.create_sliding_windows-137"><span class="linenos">137</span></a>            <span class="n">annotations_window</span> <span class="o">=</span> <span class="n">sliding_window</span><span class="p">(</span><span class="n">df_filtered</span><span class="p">[</span><span class="s2">&quot;annotations&quot;</span><span class="p">],</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span><span id="DaphnetLoader.create_sliding_windows-138"><a href="#DaphnetLoader.create_sliding_windows-138"><span class="linenos">138</span></a>            <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;annotations&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">annotations_window</span><span class="p">})</span>
</span><span id="DaphnetLoader.create_sliding_windows-139"><a href="#DaphnetLoader.create_sliding_windows-139"><span class="linenos">139</span></a>            
</span><span id="DaphnetLoader.create_sliding_windows-140"><a href="#DaphnetLoader.create_sliding_windows-140"><span class="linenos">140</span></a>            <span class="n">windows_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="s2">&quot;windows&quot;</span><span class="p">:</span> <span class="n">windows</span><span class="p">})</span>
</span><span id="DaphnetLoader.create_sliding_windows-141"><a href="#DaphnetLoader.create_sliding_windows-141"><span class="linenos">141</span></a>        
</span><span id="DaphnetLoader.create_sliding_windows-142"><a href="#DaphnetLoader.create_sliding_windows-142"><span class="linenos">142</span></a>        <span class="k">return</span> <span class="n">windows_data</span>
</span></pre></div>


            <div class="docstring"><p>Create sliding windows from the Daphnet dataset.</p>

<p>Args:
    data: List of DataFrames containing Daphnet data
    names: List of names corresponding to the data
    window_size: Size of the sliding window (default: 192)
    step_size: Step size for the sliding window (default: 32)</p>

<p>Returns:
    List of dictionaries containing sliding windows for each DataFrame</p>
</div>


                            </div>
                            <div id="DaphnetLoader.get_supported_formats" class="classattr">
                                        <input id="DaphnetLoader.get_supported_formats-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_supported_formats</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="DaphnetLoader.get_supported_formats-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DaphnetLoader.get_supported_formats"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DaphnetLoader.get_supported_formats-144"><a href="#DaphnetLoader.get_supported_formats-144"><span class="linenos">144</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_supported_formats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="DaphnetLoader.get_supported_formats-145"><a href="#DaphnetLoader.get_supported_formats-145"><span class="linenos">145</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DaphnetLoader.get_supported_formats-146"><a href="#DaphnetLoader.get_supported_formats-146"><span class="linenos">146</span></a><span class="sd">        Get list of supported file formats for Daphnet dataset.</span>
</span><span id="DaphnetLoader.get_supported_formats-147"><a href="#DaphnetLoader.get_supported_formats-147"><span class="linenos">147</span></a><span class="sd">        </span>
</span><span id="DaphnetLoader.get_supported_formats-148"><a href="#DaphnetLoader.get_supported_formats-148"><span class="linenos">148</span></a><span class="sd">        Returns:</span>
</span><span id="DaphnetLoader.get_supported_formats-149"><a href="#DaphnetLoader.get_supported_formats-149"><span class="linenos">149</span></a><span class="sd">            List of supported file extensions</span>
</span><span id="DaphnetLoader.get_supported_formats-150"><a href="#DaphnetLoader.get_supported_formats-150"><span class="linenos">150</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DaphnetLoader.get_supported_formats-151"><a href="#DaphnetLoader.get_supported_formats-151"><span class="linenos">151</span></a>        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;.txt&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get list of supported file formats for Daphnet dataset.</p>

<p>Returns:
    List of supported file extensions</p>
</div>


                            </div>
                            <div id="DaphnetLoader.get_sensor_info" class="classattr">
                                        <input id="DaphnetLoader.get_sensor_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_sensor_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="DaphnetLoader.get_sensor_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DaphnetLoader.get_sensor_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DaphnetLoader.get_sensor_info-153"><a href="#DaphnetLoader.get_sensor_info-153"><span class="linenos">153</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sensor_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="DaphnetLoader.get_sensor_info-154"><a href="#DaphnetLoader.get_sensor_info-154"><span class="linenos">154</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DaphnetLoader.get_sensor_info-155"><a href="#DaphnetLoader.get_sensor_info-155"><span class="linenos">155</span></a><span class="sd">        Get information about sensors in the dataset.</span>
</span><span id="DaphnetLoader.get_sensor_info-156"><a href="#DaphnetLoader.get_sensor_info-156"><span class="linenos">156</span></a><span class="sd">        </span>
</span><span id="DaphnetLoader.get_sensor_info-157"><a href="#DaphnetLoader.get_sensor_info-157"><span class="linenos">157</span></a><span class="sd">        Returns:</span>
</span><span id="DaphnetLoader.get_sensor_info-158"><a href="#DaphnetLoader.get_sensor_info-158"><span class="linenos">158</span></a><span class="sd">            Dictionary containing sensor information</span>
</span><span id="DaphnetLoader.get_sensor_info-159"><a href="#DaphnetLoader.get_sensor_info-159"><span class="linenos">159</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DaphnetLoader.get_sensor_info-160"><a href="#DaphnetLoader.get_sensor_info-160"><span class="linenos">160</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="DaphnetLoader.get_sensor_info-161"><a href="#DaphnetLoader.get_sensor_info-161"><span class="linenos">161</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sensors&#39;</span><span class="p">],</span>
</span><span id="DaphnetLoader.get_sensor_info-162"><a href="#DaphnetLoader.get_sensor_info-162"><span class="linenos">162</span></a>            <span class="s1">&#39;components&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;components&#39;</span><span class="p">],</span>
</span><span id="DaphnetLoader.get_sensor_info-163"><a href="#DaphnetLoader.get_sensor_info-163"><span class="linenos">163</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sampling_frequency&#39;</span><span class="p">]</span>
</span><span id="DaphnetLoader.get_sensor_info-164"><a href="#DaphnetLoader.get_sensor_info-164"><span class="linenos">164</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Get information about sensors in the dataset.</p>

<p>Returns:
    Dictionary containing sensor information</p>
</div>


                            </div>
                            <div id="DaphnetLoader.get_annotation_info" class="classattr">
                                        <input id="DaphnetLoader.get_annotation_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_annotation_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="DaphnetLoader.get_annotation_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DaphnetLoader.get_annotation_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DaphnetLoader.get_annotation_info-166"><a href="#DaphnetLoader.get_annotation_info-166"><span class="linenos">166</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_annotation_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="DaphnetLoader.get_annotation_info-167"><a href="#DaphnetLoader.get_annotation_info-167"><span class="linenos">167</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DaphnetLoader.get_annotation_info-168"><a href="#DaphnetLoader.get_annotation_info-168"><span class="linenos">168</span></a><span class="sd">        Get information about annotations in the dataset.</span>
</span><span id="DaphnetLoader.get_annotation_info-169"><a href="#DaphnetLoader.get_annotation_info-169"><span class="linenos">169</span></a><span class="sd">        </span>
</span><span id="DaphnetLoader.get_annotation_info-170"><a href="#DaphnetLoader.get_annotation_info-170"><span class="linenos">170</span></a><span class="sd">        Returns:</span>
</span><span id="DaphnetLoader.get_annotation_info-171"><a href="#DaphnetLoader.get_annotation_info-171"><span class="linenos">171</span></a><span class="sd">            Dictionary mapping annotation values to descriptions</span>
</span><span id="DaphnetLoader.get_annotation_info-172"><a href="#DaphnetLoader.get_annotation_info-172"><span class="linenos">172</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DaphnetLoader.get_annotation_info-173"><a href="#DaphnetLoader.get_annotation_info-173"><span class="linenos">173</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;annotations&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get information about annotations in the dataset.</p>

<p>Returns:
    Dictionary mapping annotation values to descriptions</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="core/base_classes.html#BaseDatasetLoader">gaitsetpy.core.base_classes.BaseDatasetLoader</a></dt>
                                <dd id="DaphnetLoader.name" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.name">name</a></dd>
                <dd id="DaphnetLoader.description" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.description">description</a></dd>
                <dd id="DaphnetLoader.data" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.data">data</a></dd>
                <dd id="DaphnetLoader.max_workers" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.max_workers">max_workers</a></dd>
                <dd id="DaphnetLoader.download_files_concurrent" class="function"><a href="core/base_classes.html#BaseDatasetLoader.download_files_concurrent">download_files_concurrent</a></dd>
                <dd id="DaphnetLoader.set_max_workers" class="function"><a href="core/base_classes.html#BaseDatasetLoader.set_max_workers">set_max_workers</a></dd>
                <dd id="DaphnetLoader.get_download_stats" class="function"><a href="core/base_classes.html#BaseDatasetLoader.get_download_stats">get_download_stats</a></dd>
                <dd id="DaphnetLoader.get_info" class="function"><a href="core/base_classes.html#BaseDatasetLoader.get_info">get_info</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MobiFallLoader">
                            <input id="MobiFallLoader-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MobiFallLoader</span><wbr>(<span class="base"><a href="core/base_classes.html#BaseDatasetLoader">gaitsetpy.core.base_classes.BaseDatasetLoader</a></span>):

                <label class="view-source-button" for="MobiFallLoader-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MobiFallLoader"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MobiFallLoader-17"><a href="#MobiFallLoader-17"><span class="linenos"> 17</span></a><span class="k">class</span><span class="w"> </span><span class="nc">MobiFallLoader</span><span class="p">(</span><span class="n">BaseDatasetLoader</span><span class="p">):</span>
</span><span id="MobiFallLoader-18"><a href="#MobiFallLoader-18"><span class="linenos"> 18</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MobiFallLoader-19"><a href="#MobiFallLoader-19"><span class="linenos"> 19</span></a><span class="sd">    MobiFall dataset loader class.</span>
</span><span id="MobiFallLoader-20"><a href="#MobiFallLoader-20"><span class="linenos"> 20</span></a><span class="sd">    </span>
</span><span id="MobiFallLoader-21"><a href="#MobiFallLoader-21"><span class="linenos"> 21</span></a><span class="sd">    This class handles loading and processing of the MobiFall dataset for gait analysis.</span>
</span><span id="MobiFallLoader-22"><a href="#MobiFallLoader-22"><span class="linenos"> 22</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MobiFallLoader-23"><a href="#MobiFallLoader-23"><span class="linenos"> 23</span></a>    
</span><span id="MobiFallLoader-24"><a href="#MobiFallLoader-24"><span class="linenos"> 24</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">):</span>
</span><span id="MobiFallLoader-25"><a href="#MobiFallLoader-25"><span class="linenos"> 25</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MobiFallLoader-26"><a href="#MobiFallLoader-26"><span class="linenos"> 26</span></a><span class="sd">        Initialize MobiFall loader with concurrent download support.</span>
</span><span id="MobiFallLoader-27"><a href="#MobiFallLoader-27"><span class="linenos"> 27</span></a><span class="sd">        </span>
</span><span id="MobiFallLoader-28"><a href="#MobiFallLoader-28"><span class="linenos"> 28</span></a><span class="sd">        Args:</span>
</span><span id="MobiFallLoader-29"><a href="#MobiFallLoader-29"><span class="linenos"> 29</span></a><span class="sd">            max_workers: Maximum number of concurrent download threads (default: 8)</span>
</span><span id="MobiFallLoader-30"><a href="#MobiFallLoader-30"><span class="linenos"> 30</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MobiFallLoader-31"><a href="#MobiFallLoader-31"><span class="linenos"> 31</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="MobiFallLoader-32"><a href="#MobiFallLoader-32"><span class="linenos"> 32</span></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mobifall&quot;</span><span class="p">,</span>
</span><span id="MobiFallLoader-33"><a href="#MobiFallLoader-33"><span class="linenos"> 33</span></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;MobiFall Dataset - Contains accelerometer and gyroscope data for fall detection&quot;</span><span class="p">,</span>
</span><span id="MobiFallLoader-34"><a href="#MobiFallLoader-34"><span class="linenos"> 34</span></a>            <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span>
</span><span id="MobiFallLoader-35"><a href="#MobiFallLoader-35"><span class="linenos"> 35</span></a>        <span class="p">)</span>
</span><span id="MobiFallLoader-36"><a href="#MobiFallLoader-36"><span class="linenos"> 36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="MobiFallLoader-37"><a href="#MobiFallLoader-37"><span class="linenos"> 37</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;accelerometer&#39;</span><span class="p">,</span> <span class="s1">&#39;gyroscope&#39;</span><span class="p">],</span>
</span><span id="MobiFallLoader-38"><a href="#MobiFallLoader-38"><span class="linenos"> 38</span></a>            <span class="s1">&#39;components&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span>
</span><span id="MobiFallLoader-39"><a href="#MobiFallLoader-39"><span class="linenos"> 39</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>  <span class="c1"># Typical for MobiFall</span>
</span><span id="MobiFallLoader-40"><a href="#MobiFallLoader-40"><span class="linenos"> 40</span></a>            <span class="s1">&#39;activities&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ADL&#39;</span><span class="p">,</span> <span class="s1">&#39;FALL&#39;</span><span class="p">]</span>  <span class="c1"># Activities of Daily Living and Falls</span>
</span><span id="MobiFallLoader-41"><a href="#MobiFallLoader-41"><span class="linenos"> 41</span></a>        <span class="p">}</span>
</span><span id="MobiFallLoader-42"><a href="#MobiFallLoader-42"><span class="linenos"> 42</span></a>    
</span><span id="MobiFallLoader-43"><a href="#MobiFallLoader-43"><span class="linenos"> 43</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="MobiFallLoader-44"><a href="#MobiFallLoader-44"><span class="linenos"> 44</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MobiFallLoader-45"><a href="#MobiFallLoader-45"><span class="linenos"> 45</span></a><span class="sd">        Load MobiFall dataset from the specified directory.</span>
</span><span id="MobiFallLoader-46"><a href="#MobiFallLoader-46"><span class="linenos"> 46</span></a><span class="sd">        </span>
</span><span id="MobiFallLoader-47"><a href="#MobiFallLoader-47"><span class="linenos"> 47</span></a><span class="sd">        Args:</span>
</span><span id="MobiFallLoader-48"><a href="#MobiFallLoader-48"><span class="linenos"> 48</span></a><span class="sd">            data_dir: Directory to store/find the dataset</span>
</span><span id="MobiFallLoader-49"><a href="#MobiFallLoader-49"><span class="linenos"> 49</span></a><span class="sd">            **kwargs: Additional arguments (unused for MobiFall)</span>
</span><span id="MobiFallLoader-50"><a href="#MobiFallLoader-50"><span class="linenos"> 50</span></a><span class="sd">            </span>
</span><span id="MobiFallLoader-51"><a href="#MobiFallLoader-51"><span class="linenos"> 51</span></a><span class="sd">        Returns:</span>
</span><span id="MobiFallLoader-52"><a href="#MobiFallLoader-52"><span class="linenos"> 52</span></a><span class="sd">            Tuple of (data_list, names_list)</span>
</span><span id="MobiFallLoader-53"><a href="#MobiFallLoader-53"><span class="linenos"> 53</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MobiFallLoader-54"><a href="#MobiFallLoader-54"><span class="linenos"> 54</span></a>        <span class="c1"># TODO: Implement MobiFall data loading</span>
</span><span id="MobiFallLoader-55"><a href="#MobiFallLoader-55"><span class="linenos"> 55</span></a>        <span class="c1"># This is a placeholder implementation</span>
</span><span id="MobiFallLoader-56"><a href="#MobiFallLoader-56"><span class="linenos"> 56</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MobiFall data loading is not yet implemented&quot;</span><span class="p">)</span>
</span><span id="MobiFallLoader-57"><a href="#MobiFallLoader-57"><span class="linenos"> 57</span></a>        <span class="k">return</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="MobiFallLoader-58"><a href="#MobiFallLoader-58"><span class="linenos"> 58</span></a>    
</span><span id="MobiFallLoader-59"><a href="#MobiFallLoader-59"><span class="linenos"> 59</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_sliding_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> 
</span><span id="MobiFallLoader-60"><a href="#MobiFallLoader-60"><span class="linenos"> 60</span></a>                             <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">192</span><span class="p">,</span> <span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="MobiFallLoader-61"><a href="#MobiFallLoader-61"><span class="linenos"> 61</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MobiFallLoader-62"><a href="#MobiFallLoader-62"><span class="linenos"> 62</span></a><span class="sd">        Create sliding windows from the MobiFall dataset.</span>
</span><span id="MobiFallLoader-63"><a href="#MobiFallLoader-63"><span class="linenos"> 63</span></a><span class="sd">        </span>
</span><span id="MobiFallLoader-64"><a href="#MobiFallLoader-64"><span class="linenos"> 64</span></a><span class="sd">        Args:</span>
</span><span id="MobiFallLoader-65"><a href="#MobiFallLoader-65"><span class="linenos"> 65</span></a><span class="sd">            data: List of DataFrames containing MobiFall data</span>
</span><span id="MobiFallLoader-66"><a href="#MobiFallLoader-66"><span class="linenos"> 66</span></a><span class="sd">            names: List of names corresponding to the data</span>
</span><span id="MobiFallLoader-67"><a href="#MobiFallLoader-67"><span class="linenos"> 67</span></a><span class="sd">            window_size: Size of the sliding window (default: 192)</span>
</span><span id="MobiFallLoader-68"><a href="#MobiFallLoader-68"><span class="linenos"> 68</span></a><span class="sd">            step_size: Step size for the sliding window (default: 32)</span>
</span><span id="MobiFallLoader-69"><a href="#MobiFallLoader-69"><span class="linenos"> 69</span></a><span class="sd">            </span>
</span><span id="MobiFallLoader-70"><a href="#MobiFallLoader-70"><span class="linenos"> 70</span></a><span class="sd">        Returns:</span>
</span><span id="MobiFallLoader-71"><a href="#MobiFallLoader-71"><span class="linenos"> 71</span></a><span class="sd">            List of dictionaries containing sliding windows for each DataFrame</span>
</span><span id="MobiFallLoader-72"><a href="#MobiFallLoader-72"><span class="linenos"> 72</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MobiFallLoader-73"><a href="#MobiFallLoader-73"><span class="linenos"> 73</span></a>        <span class="c1"># TODO: Implement MobiFall sliding window creation</span>
</span><span id="MobiFallLoader-74"><a href="#MobiFallLoader-74"><span class="linenos"> 74</span></a>        <span class="c1"># This is a placeholder implementation</span>
</span><span id="MobiFallLoader-75"><a href="#MobiFallLoader-75"><span class="linenos"> 75</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MobiFall sliding window creation is not yet implemented&quot;</span><span class="p">)</span>
</span><span id="MobiFallLoader-76"><a href="#MobiFallLoader-76"><span class="linenos"> 76</span></a>        <span class="k">return</span> <span class="p">[]</span>
</span><span id="MobiFallLoader-77"><a href="#MobiFallLoader-77"><span class="linenos"> 77</span></a>    
</span><span id="MobiFallLoader-78"><a href="#MobiFallLoader-78"><span class="linenos"> 78</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_supported_formats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="MobiFallLoader-79"><a href="#MobiFallLoader-79"><span class="linenos"> 79</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MobiFallLoader-80"><a href="#MobiFallLoader-80"><span class="linenos"> 80</span></a><span class="sd">        Get list of supported file formats for MobiFall dataset.</span>
</span><span id="MobiFallLoader-81"><a href="#MobiFallLoader-81"><span class="linenos"> 81</span></a><span class="sd">        </span>
</span><span id="MobiFallLoader-82"><a href="#MobiFallLoader-82"><span class="linenos"> 82</span></a><span class="sd">        Returns:</span>
</span><span id="MobiFallLoader-83"><a href="#MobiFallLoader-83"><span class="linenos"> 83</span></a><span class="sd">            List of supported file extensions</span>
</span><span id="MobiFallLoader-84"><a href="#MobiFallLoader-84"><span class="linenos"> 84</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MobiFallLoader-85"><a href="#MobiFallLoader-85"><span class="linenos"> 85</span></a>        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;.txt&#39;</span><span class="p">]</span>
</span><span id="MobiFallLoader-86"><a href="#MobiFallLoader-86"><span class="linenos"> 86</span></a>    
</span><span id="MobiFallLoader-87"><a href="#MobiFallLoader-87"><span class="linenos"> 87</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sensor_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="MobiFallLoader-88"><a href="#MobiFallLoader-88"><span class="linenos"> 88</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MobiFallLoader-89"><a href="#MobiFallLoader-89"><span class="linenos"> 89</span></a><span class="sd">        Get information about sensors in the dataset.</span>
</span><span id="MobiFallLoader-90"><a href="#MobiFallLoader-90"><span class="linenos"> 90</span></a><span class="sd">        </span>
</span><span id="MobiFallLoader-91"><a href="#MobiFallLoader-91"><span class="linenos"> 91</span></a><span class="sd">        Returns:</span>
</span><span id="MobiFallLoader-92"><a href="#MobiFallLoader-92"><span class="linenos"> 92</span></a><span class="sd">            Dictionary containing sensor information</span>
</span><span id="MobiFallLoader-93"><a href="#MobiFallLoader-93"><span class="linenos"> 93</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MobiFallLoader-94"><a href="#MobiFallLoader-94"><span class="linenos"> 94</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="MobiFallLoader-95"><a href="#MobiFallLoader-95"><span class="linenos"> 95</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sensors&#39;</span><span class="p">],</span>
</span><span id="MobiFallLoader-96"><a href="#MobiFallLoader-96"><span class="linenos"> 96</span></a>            <span class="s1">&#39;components&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;components&#39;</span><span class="p">],</span>
</span><span id="MobiFallLoader-97"><a href="#MobiFallLoader-97"><span class="linenos"> 97</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sampling_frequency&#39;</span><span class="p">]</span>
</span><span id="MobiFallLoader-98"><a href="#MobiFallLoader-98"><span class="linenos"> 98</span></a>        <span class="p">}</span>
</span><span id="MobiFallLoader-99"><a href="#MobiFallLoader-99"><span class="linenos"> 99</span></a>    
</span><span id="MobiFallLoader-100"><a href="#MobiFallLoader-100"><span class="linenos">100</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_activity_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="MobiFallLoader-101"><a href="#MobiFallLoader-101"><span class="linenos">101</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MobiFallLoader-102"><a href="#MobiFallLoader-102"><span class="linenos">102</span></a><span class="sd">        Get information about activities in the dataset.</span>
</span><span id="MobiFallLoader-103"><a href="#MobiFallLoader-103"><span class="linenos">103</span></a><span class="sd">        </span>
</span><span id="MobiFallLoader-104"><a href="#MobiFallLoader-104"><span class="linenos">104</span></a><span class="sd">        Returns:</span>
</span><span id="MobiFallLoader-105"><a href="#MobiFallLoader-105"><span class="linenos">105</span></a><span class="sd">            List of activity types</span>
</span><span id="MobiFallLoader-106"><a href="#MobiFallLoader-106"><span class="linenos">106</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MobiFallLoader-107"><a href="#MobiFallLoader-107"><span class="linenos">107</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;activities&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>MobiFall dataset loader class.</p>

<p>This class handles loading and processing of the MobiFall dataset for gait analysis.</p>
</div>


                            <div id="MobiFallLoader.__init__" class="classattr">
                                        <input id="MobiFallLoader.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">MobiFallLoader</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span></span>)</span>

                <label class="view-source-button" for="MobiFallLoader.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MobiFallLoader.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MobiFallLoader.__init__-24"><a href="#MobiFallLoader.__init__-24"><span class="linenos">24</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">):</span>
</span><span id="MobiFallLoader.__init__-25"><a href="#MobiFallLoader.__init__-25"><span class="linenos">25</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MobiFallLoader.__init__-26"><a href="#MobiFallLoader.__init__-26"><span class="linenos">26</span></a><span class="sd">        Initialize MobiFall loader with concurrent download support.</span>
</span><span id="MobiFallLoader.__init__-27"><a href="#MobiFallLoader.__init__-27"><span class="linenos">27</span></a><span class="sd">        </span>
</span><span id="MobiFallLoader.__init__-28"><a href="#MobiFallLoader.__init__-28"><span class="linenos">28</span></a><span class="sd">        Args:</span>
</span><span id="MobiFallLoader.__init__-29"><a href="#MobiFallLoader.__init__-29"><span class="linenos">29</span></a><span class="sd">            max_workers: Maximum number of concurrent download threads (default: 8)</span>
</span><span id="MobiFallLoader.__init__-30"><a href="#MobiFallLoader.__init__-30"><span class="linenos">30</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MobiFallLoader.__init__-31"><a href="#MobiFallLoader.__init__-31"><span class="linenos">31</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="MobiFallLoader.__init__-32"><a href="#MobiFallLoader.__init__-32"><span class="linenos">32</span></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mobifall&quot;</span><span class="p">,</span>
</span><span id="MobiFallLoader.__init__-33"><a href="#MobiFallLoader.__init__-33"><span class="linenos">33</span></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;MobiFall Dataset - Contains accelerometer and gyroscope data for fall detection&quot;</span><span class="p">,</span>
</span><span id="MobiFallLoader.__init__-34"><a href="#MobiFallLoader.__init__-34"><span class="linenos">34</span></a>            <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span>
</span><span id="MobiFallLoader.__init__-35"><a href="#MobiFallLoader.__init__-35"><span class="linenos">35</span></a>        <span class="p">)</span>
</span><span id="MobiFallLoader.__init__-36"><a href="#MobiFallLoader.__init__-36"><span class="linenos">36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="MobiFallLoader.__init__-37"><a href="#MobiFallLoader.__init__-37"><span class="linenos">37</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;accelerometer&#39;</span><span class="p">,</span> <span class="s1">&#39;gyroscope&#39;</span><span class="p">],</span>
</span><span id="MobiFallLoader.__init__-38"><a href="#MobiFallLoader.__init__-38"><span class="linenos">38</span></a>            <span class="s1">&#39;components&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span>
</span><span id="MobiFallLoader.__init__-39"><a href="#MobiFallLoader.__init__-39"><span class="linenos">39</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>  <span class="c1"># Typical for MobiFall</span>
</span><span id="MobiFallLoader.__init__-40"><a href="#MobiFallLoader.__init__-40"><span class="linenos">40</span></a>            <span class="s1">&#39;activities&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ADL&#39;</span><span class="p">,</span> <span class="s1">&#39;FALL&#39;</span><span class="p">]</span>  <span class="c1"># Activities of Daily Living and Falls</span>
</span><span id="MobiFallLoader.__init__-41"><a href="#MobiFallLoader.__init__-41"><span class="linenos">41</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Initialize MobiFall loader with concurrent download support.</p>

<p>Args:
    max_workers: Maximum number of concurrent download threads (default: 8)</p>
</div>


                            </div>
                            <div id="MobiFallLoader.metadata" class="classattr">
                                <div class="attr variable">
            <span class="name">metadata</span>

        
    </div>
    <a class="headerlink" href="#MobiFallLoader.metadata"></a>
    
    

                            </div>
                            <div id="MobiFallLoader.load_data" class="classattr">
                                        <input id="MobiFallLoader.load_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_data</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="MobiFallLoader.load_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MobiFallLoader.load_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MobiFallLoader.load_data-43"><a href="#MobiFallLoader.load_data-43"><span class="linenos">43</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="MobiFallLoader.load_data-44"><a href="#MobiFallLoader.load_data-44"><span class="linenos">44</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MobiFallLoader.load_data-45"><a href="#MobiFallLoader.load_data-45"><span class="linenos">45</span></a><span class="sd">        Load MobiFall dataset from the specified directory.</span>
</span><span id="MobiFallLoader.load_data-46"><a href="#MobiFallLoader.load_data-46"><span class="linenos">46</span></a><span class="sd">        </span>
</span><span id="MobiFallLoader.load_data-47"><a href="#MobiFallLoader.load_data-47"><span class="linenos">47</span></a><span class="sd">        Args:</span>
</span><span id="MobiFallLoader.load_data-48"><a href="#MobiFallLoader.load_data-48"><span class="linenos">48</span></a><span class="sd">            data_dir: Directory to store/find the dataset</span>
</span><span id="MobiFallLoader.load_data-49"><a href="#MobiFallLoader.load_data-49"><span class="linenos">49</span></a><span class="sd">            **kwargs: Additional arguments (unused for MobiFall)</span>
</span><span id="MobiFallLoader.load_data-50"><a href="#MobiFallLoader.load_data-50"><span class="linenos">50</span></a><span class="sd">            </span>
</span><span id="MobiFallLoader.load_data-51"><a href="#MobiFallLoader.load_data-51"><span class="linenos">51</span></a><span class="sd">        Returns:</span>
</span><span id="MobiFallLoader.load_data-52"><a href="#MobiFallLoader.load_data-52"><span class="linenos">52</span></a><span class="sd">            Tuple of (data_list, names_list)</span>
</span><span id="MobiFallLoader.load_data-53"><a href="#MobiFallLoader.load_data-53"><span class="linenos">53</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MobiFallLoader.load_data-54"><a href="#MobiFallLoader.load_data-54"><span class="linenos">54</span></a>        <span class="c1"># TODO: Implement MobiFall data loading</span>
</span><span id="MobiFallLoader.load_data-55"><a href="#MobiFallLoader.load_data-55"><span class="linenos">55</span></a>        <span class="c1"># This is a placeholder implementation</span>
</span><span id="MobiFallLoader.load_data-56"><a href="#MobiFallLoader.load_data-56"><span class="linenos">56</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MobiFall data loading is not yet implemented&quot;</span><span class="p">)</span>
</span><span id="MobiFallLoader.load_data-57"><a href="#MobiFallLoader.load_data-57"><span class="linenos">57</span></a>        <span class="k">return</span> <span class="p">[],</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Load MobiFall dataset from the specified directory.</p>

<p>Args:
    data_dir: Directory to store/find the dataset
    **kwargs: Additional arguments (unused for MobiFall)</p>

<p>Returns:
    Tuple of (data_list, names_list)</p>
</div>


                            </div>
                            <div id="MobiFallLoader.create_sliding_windows" class="classattr">
                                        <input id="MobiFallLoader.create_sliding_windows-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_sliding_windows</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>,</span><span class="param">	<span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">192</span>,</span><span class="param">	<span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="MobiFallLoader.create_sliding_windows-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MobiFallLoader.create_sliding_windows"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MobiFallLoader.create_sliding_windows-59"><a href="#MobiFallLoader.create_sliding_windows-59"><span class="linenos">59</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_sliding_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> 
</span><span id="MobiFallLoader.create_sliding_windows-60"><a href="#MobiFallLoader.create_sliding_windows-60"><span class="linenos">60</span></a>                             <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">192</span><span class="p">,</span> <span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="MobiFallLoader.create_sliding_windows-61"><a href="#MobiFallLoader.create_sliding_windows-61"><span class="linenos">61</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MobiFallLoader.create_sliding_windows-62"><a href="#MobiFallLoader.create_sliding_windows-62"><span class="linenos">62</span></a><span class="sd">        Create sliding windows from the MobiFall dataset.</span>
</span><span id="MobiFallLoader.create_sliding_windows-63"><a href="#MobiFallLoader.create_sliding_windows-63"><span class="linenos">63</span></a><span class="sd">        </span>
</span><span id="MobiFallLoader.create_sliding_windows-64"><a href="#MobiFallLoader.create_sliding_windows-64"><span class="linenos">64</span></a><span class="sd">        Args:</span>
</span><span id="MobiFallLoader.create_sliding_windows-65"><a href="#MobiFallLoader.create_sliding_windows-65"><span class="linenos">65</span></a><span class="sd">            data: List of DataFrames containing MobiFall data</span>
</span><span id="MobiFallLoader.create_sliding_windows-66"><a href="#MobiFallLoader.create_sliding_windows-66"><span class="linenos">66</span></a><span class="sd">            names: List of names corresponding to the data</span>
</span><span id="MobiFallLoader.create_sliding_windows-67"><a href="#MobiFallLoader.create_sliding_windows-67"><span class="linenos">67</span></a><span class="sd">            window_size: Size of the sliding window (default: 192)</span>
</span><span id="MobiFallLoader.create_sliding_windows-68"><a href="#MobiFallLoader.create_sliding_windows-68"><span class="linenos">68</span></a><span class="sd">            step_size: Step size for the sliding window (default: 32)</span>
</span><span id="MobiFallLoader.create_sliding_windows-69"><a href="#MobiFallLoader.create_sliding_windows-69"><span class="linenos">69</span></a><span class="sd">            </span>
</span><span id="MobiFallLoader.create_sliding_windows-70"><a href="#MobiFallLoader.create_sliding_windows-70"><span class="linenos">70</span></a><span class="sd">        Returns:</span>
</span><span id="MobiFallLoader.create_sliding_windows-71"><a href="#MobiFallLoader.create_sliding_windows-71"><span class="linenos">71</span></a><span class="sd">            List of dictionaries containing sliding windows for each DataFrame</span>
</span><span id="MobiFallLoader.create_sliding_windows-72"><a href="#MobiFallLoader.create_sliding_windows-72"><span class="linenos">72</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MobiFallLoader.create_sliding_windows-73"><a href="#MobiFallLoader.create_sliding_windows-73"><span class="linenos">73</span></a>        <span class="c1"># TODO: Implement MobiFall sliding window creation</span>
</span><span id="MobiFallLoader.create_sliding_windows-74"><a href="#MobiFallLoader.create_sliding_windows-74"><span class="linenos">74</span></a>        <span class="c1"># This is a placeholder implementation</span>
</span><span id="MobiFallLoader.create_sliding_windows-75"><a href="#MobiFallLoader.create_sliding_windows-75"><span class="linenos">75</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MobiFall sliding window creation is not yet implemented&quot;</span><span class="p">)</span>
</span><span id="MobiFallLoader.create_sliding_windows-76"><a href="#MobiFallLoader.create_sliding_windows-76"><span class="linenos">76</span></a>        <span class="k">return</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Create sliding windows from the MobiFall dataset.</p>

<p>Args:
    data: List of DataFrames containing MobiFall data
    names: List of names corresponding to the data
    window_size: Size of the sliding window (default: 192)
    step_size: Step size for the sliding window (default: 32)</p>

<p>Returns:
    List of dictionaries containing sliding windows for each DataFrame</p>
</div>


                            </div>
                            <div id="MobiFallLoader.get_supported_formats" class="classattr">
                                        <input id="MobiFallLoader.get_supported_formats-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_supported_formats</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="MobiFallLoader.get_supported_formats-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MobiFallLoader.get_supported_formats"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MobiFallLoader.get_supported_formats-78"><a href="#MobiFallLoader.get_supported_formats-78"><span class="linenos">78</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_supported_formats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="MobiFallLoader.get_supported_formats-79"><a href="#MobiFallLoader.get_supported_formats-79"><span class="linenos">79</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MobiFallLoader.get_supported_formats-80"><a href="#MobiFallLoader.get_supported_formats-80"><span class="linenos">80</span></a><span class="sd">        Get list of supported file formats for MobiFall dataset.</span>
</span><span id="MobiFallLoader.get_supported_formats-81"><a href="#MobiFallLoader.get_supported_formats-81"><span class="linenos">81</span></a><span class="sd">        </span>
</span><span id="MobiFallLoader.get_supported_formats-82"><a href="#MobiFallLoader.get_supported_formats-82"><span class="linenos">82</span></a><span class="sd">        Returns:</span>
</span><span id="MobiFallLoader.get_supported_formats-83"><a href="#MobiFallLoader.get_supported_formats-83"><span class="linenos">83</span></a><span class="sd">            List of supported file extensions</span>
</span><span id="MobiFallLoader.get_supported_formats-84"><a href="#MobiFallLoader.get_supported_formats-84"><span class="linenos">84</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MobiFallLoader.get_supported_formats-85"><a href="#MobiFallLoader.get_supported_formats-85"><span class="linenos">85</span></a>        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;.txt&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get list of supported file formats for MobiFall dataset.</p>

<p>Returns:
    List of supported file extensions</p>
</div>


                            </div>
                            <div id="MobiFallLoader.get_sensor_info" class="classattr">
                                        <input id="MobiFallLoader.get_sensor_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_sensor_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="MobiFallLoader.get_sensor_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MobiFallLoader.get_sensor_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MobiFallLoader.get_sensor_info-87"><a href="#MobiFallLoader.get_sensor_info-87"><span class="linenos">87</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sensor_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="MobiFallLoader.get_sensor_info-88"><a href="#MobiFallLoader.get_sensor_info-88"><span class="linenos">88</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MobiFallLoader.get_sensor_info-89"><a href="#MobiFallLoader.get_sensor_info-89"><span class="linenos">89</span></a><span class="sd">        Get information about sensors in the dataset.</span>
</span><span id="MobiFallLoader.get_sensor_info-90"><a href="#MobiFallLoader.get_sensor_info-90"><span class="linenos">90</span></a><span class="sd">        </span>
</span><span id="MobiFallLoader.get_sensor_info-91"><a href="#MobiFallLoader.get_sensor_info-91"><span class="linenos">91</span></a><span class="sd">        Returns:</span>
</span><span id="MobiFallLoader.get_sensor_info-92"><a href="#MobiFallLoader.get_sensor_info-92"><span class="linenos">92</span></a><span class="sd">            Dictionary containing sensor information</span>
</span><span id="MobiFallLoader.get_sensor_info-93"><a href="#MobiFallLoader.get_sensor_info-93"><span class="linenos">93</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MobiFallLoader.get_sensor_info-94"><a href="#MobiFallLoader.get_sensor_info-94"><span class="linenos">94</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="MobiFallLoader.get_sensor_info-95"><a href="#MobiFallLoader.get_sensor_info-95"><span class="linenos">95</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sensors&#39;</span><span class="p">],</span>
</span><span id="MobiFallLoader.get_sensor_info-96"><a href="#MobiFallLoader.get_sensor_info-96"><span class="linenos">96</span></a>            <span class="s1">&#39;components&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;components&#39;</span><span class="p">],</span>
</span><span id="MobiFallLoader.get_sensor_info-97"><a href="#MobiFallLoader.get_sensor_info-97"><span class="linenos">97</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sampling_frequency&#39;</span><span class="p">]</span>
</span><span id="MobiFallLoader.get_sensor_info-98"><a href="#MobiFallLoader.get_sensor_info-98"><span class="linenos">98</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Get information about sensors in the dataset.</p>

<p>Returns:
    Dictionary containing sensor information</p>
</div>


                            </div>
                            <div id="MobiFallLoader.get_activity_info" class="classattr">
                                        <input id="MobiFallLoader.get_activity_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_activity_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="MobiFallLoader.get_activity_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MobiFallLoader.get_activity_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MobiFallLoader.get_activity_info-100"><a href="#MobiFallLoader.get_activity_info-100"><span class="linenos">100</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_activity_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="MobiFallLoader.get_activity_info-101"><a href="#MobiFallLoader.get_activity_info-101"><span class="linenos">101</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MobiFallLoader.get_activity_info-102"><a href="#MobiFallLoader.get_activity_info-102"><span class="linenos">102</span></a><span class="sd">        Get information about activities in the dataset.</span>
</span><span id="MobiFallLoader.get_activity_info-103"><a href="#MobiFallLoader.get_activity_info-103"><span class="linenos">103</span></a><span class="sd">        </span>
</span><span id="MobiFallLoader.get_activity_info-104"><a href="#MobiFallLoader.get_activity_info-104"><span class="linenos">104</span></a><span class="sd">        Returns:</span>
</span><span id="MobiFallLoader.get_activity_info-105"><a href="#MobiFallLoader.get_activity_info-105"><span class="linenos">105</span></a><span class="sd">            List of activity types</span>
</span><span id="MobiFallLoader.get_activity_info-106"><a href="#MobiFallLoader.get_activity_info-106"><span class="linenos">106</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MobiFallLoader.get_activity_info-107"><a href="#MobiFallLoader.get_activity_info-107"><span class="linenos">107</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;activities&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get information about activities in the dataset.</p>

<p>Returns:
    List of activity types</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="core/base_classes.html#BaseDatasetLoader">gaitsetpy.core.base_classes.BaseDatasetLoader</a></dt>
                                <dd id="MobiFallLoader.name" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.name">name</a></dd>
                <dd id="MobiFallLoader.description" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.description">description</a></dd>
                <dd id="MobiFallLoader.data" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.data">data</a></dd>
                <dd id="MobiFallLoader.max_workers" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.max_workers">max_workers</a></dd>
                <dd id="MobiFallLoader.download_files_concurrent" class="function"><a href="core/base_classes.html#BaseDatasetLoader.download_files_concurrent">download_files_concurrent</a></dd>
                <dd id="MobiFallLoader.set_max_workers" class="function"><a href="core/base_classes.html#BaseDatasetLoader.set_max_workers">set_max_workers</a></dd>
                <dd id="MobiFallLoader.get_download_stats" class="function"><a href="core/base_classes.html#BaseDatasetLoader.get_download_stats">get_download_stats</a></dd>
                <dd id="MobiFallLoader.get_info" class="function"><a href="core/base_classes.html#BaseDatasetLoader.get_info">get_info</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ArduousLoader">
                            <input id="ArduousLoader-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ArduousLoader</span><wbr>(<span class="base"><a href="core/base_classes.html#BaseDatasetLoader">gaitsetpy.core.base_classes.BaseDatasetLoader</a></span>):

                <label class="view-source-button" for="ArduousLoader-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ArduousLoader"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ArduousLoader-17"><a href="#ArduousLoader-17"><span class="linenos"> 17</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ArduousLoader</span><span class="p">(</span><span class="n">BaseDatasetLoader</span><span class="p">):</span>
</span><span id="ArduousLoader-18"><a href="#ArduousLoader-18"><span class="linenos"> 18</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ArduousLoader-19"><a href="#ArduousLoader-19"><span class="linenos"> 19</span></a><span class="sd">    Arduous dataset loader class.</span>
</span><span id="ArduousLoader-20"><a href="#ArduousLoader-20"><span class="linenos"> 20</span></a><span class="sd">    </span>
</span><span id="ArduousLoader-21"><a href="#ArduousLoader-21"><span class="linenos"> 21</span></a><span class="sd">    This class handles loading and processing of the Arduous dataset for gait analysis.</span>
</span><span id="ArduousLoader-22"><a href="#ArduousLoader-22"><span class="linenos"> 22</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ArduousLoader-23"><a href="#ArduousLoader-23"><span class="linenos"> 23</span></a>    
</span><span id="ArduousLoader-24"><a href="#ArduousLoader-24"><span class="linenos"> 24</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">):</span>
</span><span id="ArduousLoader-25"><a href="#ArduousLoader-25"><span class="linenos"> 25</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ArduousLoader-26"><a href="#ArduousLoader-26"><span class="linenos"> 26</span></a><span class="sd">        Initialize Arduous loader with concurrent download support.</span>
</span><span id="ArduousLoader-27"><a href="#ArduousLoader-27"><span class="linenos"> 27</span></a><span class="sd">        </span>
</span><span id="ArduousLoader-28"><a href="#ArduousLoader-28"><span class="linenos"> 28</span></a><span class="sd">        Args:</span>
</span><span id="ArduousLoader-29"><a href="#ArduousLoader-29"><span class="linenos"> 29</span></a><span class="sd">            max_workers: Maximum number of concurrent download threads (default: 8)</span>
</span><span id="ArduousLoader-30"><a href="#ArduousLoader-30"><span class="linenos"> 30</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ArduousLoader-31"><a href="#ArduousLoader-31"><span class="linenos"> 31</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="ArduousLoader-32"><a href="#ArduousLoader-32"><span class="linenos"> 32</span></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;arduous&quot;</span><span class="p">,</span>
</span><span id="ArduousLoader-33"><a href="#ArduousLoader-33"><span class="linenos"> 33</span></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Arduous Dataset - Contains multi-sensor wearable data for daily activity recognition&quot;</span><span class="p">,</span>
</span><span id="ArduousLoader-34"><a href="#ArduousLoader-34"><span class="linenos"> 34</span></a>            <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span>
</span><span id="ArduousLoader-35"><a href="#ArduousLoader-35"><span class="linenos"> 35</span></a>        <span class="p">)</span>
</span><span id="ArduousLoader-36"><a href="#ArduousLoader-36"><span class="linenos"> 36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ArduousLoader-37"><a href="#ArduousLoader-37"><span class="linenos"> 37</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;accelerometer&#39;</span><span class="p">,</span> <span class="s1">&#39;gyroscope&#39;</span><span class="p">,</span> <span class="s1">&#39;magnetometer&#39;</span><span class="p">],</span>
</span><span id="ArduousLoader-38"><a href="#ArduousLoader-38"><span class="linenos"> 38</span></a>            <span class="s1">&#39;components&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span>
</span><span id="ArduousLoader-39"><a href="#ArduousLoader-39"><span class="linenos"> 39</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>  <span class="c1"># Typical for Arduous</span>
</span><span id="ArduousLoader-40"><a href="#ArduousLoader-40"><span class="linenos"> 40</span></a>            <span class="s1">&#39;activities&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;walking&#39;</span><span class="p">,</span> <span class="s1">&#39;running&#39;</span><span class="p">,</span> <span class="s1">&#39;sitting&#39;</span><span class="p">,</span> <span class="s1">&#39;standing&#39;</span><span class="p">,</span> <span class="s1">&#39;lying&#39;</span><span class="p">]</span>
</span><span id="ArduousLoader-41"><a href="#ArduousLoader-41"><span class="linenos"> 41</span></a>        <span class="p">}</span>
</span><span id="ArduousLoader-42"><a href="#ArduousLoader-42"><span class="linenos"> 42</span></a>    
</span><span id="ArduousLoader-43"><a href="#ArduousLoader-43"><span class="linenos"> 43</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ArduousLoader-44"><a href="#ArduousLoader-44"><span class="linenos"> 44</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ArduousLoader-45"><a href="#ArduousLoader-45"><span class="linenos"> 45</span></a><span class="sd">        Load Arduous dataset from the specified directory.</span>
</span><span id="ArduousLoader-46"><a href="#ArduousLoader-46"><span class="linenos"> 46</span></a><span class="sd">        </span>
</span><span id="ArduousLoader-47"><a href="#ArduousLoader-47"><span class="linenos"> 47</span></a><span class="sd">        Args:</span>
</span><span id="ArduousLoader-48"><a href="#ArduousLoader-48"><span class="linenos"> 48</span></a><span class="sd">            data_dir: Directory to store/find the dataset</span>
</span><span id="ArduousLoader-49"><a href="#ArduousLoader-49"><span class="linenos"> 49</span></a><span class="sd">            **kwargs: Additional arguments (unused for Arduous)</span>
</span><span id="ArduousLoader-50"><a href="#ArduousLoader-50"><span class="linenos"> 50</span></a><span class="sd">            </span>
</span><span id="ArduousLoader-51"><a href="#ArduousLoader-51"><span class="linenos"> 51</span></a><span class="sd">        Returns:</span>
</span><span id="ArduousLoader-52"><a href="#ArduousLoader-52"><span class="linenos"> 52</span></a><span class="sd">            Tuple of (data_list, names_list)</span>
</span><span id="ArduousLoader-53"><a href="#ArduousLoader-53"><span class="linenos"> 53</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ArduousLoader-54"><a href="#ArduousLoader-54"><span class="linenos"> 54</span></a>        <span class="c1"># TODO: Implement Arduous data loading</span>
</span><span id="ArduousLoader-55"><a href="#ArduousLoader-55"><span class="linenos"> 55</span></a>        <span class="c1"># This is a placeholder implementation</span>
</span><span id="ArduousLoader-56"><a href="#ArduousLoader-56"><span class="linenos"> 56</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Arduous data loading is not yet implemented&quot;</span><span class="p">)</span>
</span><span id="ArduousLoader-57"><a href="#ArduousLoader-57"><span class="linenos"> 57</span></a>        <span class="k">return</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="ArduousLoader-58"><a href="#ArduousLoader-58"><span class="linenos"> 58</span></a>    
</span><span id="ArduousLoader-59"><a href="#ArduousLoader-59"><span class="linenos"> 59</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_sliding_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> 
</span><span id="ArduousLoader-60"><a href="#ArduousLoader-60"><span class="linenos"> 60</span></a>                             <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">192</span><span class="p">,</span> <span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="ArduousLoader-61"><a href="#ArduousLoader-61"><span class="linenos"> 61</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ArduousLoader-62"><a href="#ArduousLoader-62"><span class="linenos"> 62</span></a><span class="sd">        Create sliding windows from the Arduous dataset.</span>
</span><span id="ArduousLoader-63"><a href="#ArduousLoader-63"><span class="linenos"> 63</span></a><span class="sd">        </span>
</span><span id="ArduousLoader-64"><a href="#ArduousLoader-64"><span class="linenos"> 64</span></a><span class="sd">        Args:</span>
</span><span id="ArduousLoader-65"><a href="#ArduousLoader-65"><span class="linenos"> 65</span></a><span class="sd">            data: List of DataFrames containing Arduous data</span>
</span><span id="ArduousLoader-66"><a href="#ArduousLoader-66"><span class="linenos"> 66</span></a><span class="sd">            names: List of names corresponding to the data</span>
</span><span id="ArduousLoader-67"><a href="#ArduousLoader-67"><span class="linenos"> 67</span></a><span class="sd">            window_size: Size of the sliding window (default: 192)</span>
</span><span id="ArduousLoader-68"><a href="#ArduousLoader-68"><span class="linenos"> 68</span></a><span class="sd">            step_size: Step size for the sliding window (default: 32)</span>
</span><span id="ArduousLoader-69"><a href="#ArduousLoader-69"><span class="linenos"> 69</span></a><span class="sd">            </span>
</span><span id="ArduousLoader-70"><a href="#ArduousLoader-70"><span class="linenos"> 70</span></a><span class="sd">        Returns:</span>
</span><span id="ArduousLoader-71"><a href="#ArduousLoader-71"><span class="linenos"> 71</span></a><span class="sd">            List of dictionaries containing sliding windows for each DataFrame</span>
</span><span id="ArduousLoader-72"><a href="#ArduousLoader-72"><span class="linenos"> 72</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ArduousLoader-73"><a href="#ArduousLoader-73"><span class="linenos"> 73</span></a>        <span class="c1"># TODO: Implement Arduous sliding window creation</span>
</span><span id="ArduousLoader-74"><a href="#ArduousLoader-74"><span class="linenos"> 74</span></a>        <span class="c1"># This is a placeholder implementation</span>
</span><span id="ArduousLoader-75"><a href="#ArduousLoader-75"><span class="linenos"> 75</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Arduous sliding window creation is not yet implemented&quot;</span><span class="p">)</span>
</span><span id="ArduousLoader-76"><a href="#ArduousLoader-76"><span class="linenos"> 76</span></a>        <span class="k">return</span> <span class="p">[]</span>
</span><span id="ArduousLoader-77"><a href="#ArduousLoader-77"><span class="linenos"> 77</span></a>    
</span><span id="ArduousLoader-78"><a href="#ArduousLoader-78"><span class="linenos"> 78</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_supported_formats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="ArduousLoader-79"><a href="#ArduousLoader-79"><span class="linenos"> 79</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ArduousLoader-80"><a href="#ArduousLoader-80"><span class="linenos"> 80</span></a><span class="sd">        Get list of supported file formats for Arduous dataset.</span>
</span><span id="ArduousLoader-81"><a href="#ArduousLoader-81"><span class="linenos"> 81</span></a><span class="sd">        </span>
</span><span id="ArduousLoader-82"><a href="#ArduousLoader-82"><span class="linenos"> 82</span></a><span class="sd">        Returns:</span>
</span><span id="ArduousLoader-83"><a href="#ArduousLoader-83"><span class="linenos"> 83</span></a><span class="sd">            List of supported file extensions</span>
</span><span id="ArduousLoader-84"><a href="#ArduousLoader-84"><span class="linenos"> 84</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ArduousLoader-85"><a href="#ArduousLoader-85"><span class="linenos"> 85</span></a>        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;.txt&#39;</span><span class="p">]</span>
</span><span id="ArduousLoader-86"><a href="#ArduousLoader-86"><span class="linenos"> 86</span></a>    
</span><span id="ArduousLoader-87"><a href="#ArduousLoader-87"><span class="linenos"> 87</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sensor_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ArduousLoader-88"><a href="#ArduousLoader-88"><span class="linenos"> 88</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ArduousLoader-89"><a href="#ArduousLoader-89"><span class="linenos"> 89</span></a><span class="sd">        Get information about sensors in the dataset.</span>
</span><span id="ArduousLoader-90"><a href="#ArduousLoader-90"><span class="linenos"> 90</span></a><span class="sd">        </span>
</span><span id="ArduousLoader-91"><a href="#ArduousLoader-91"><span class="linenos"> 91</span></a><span class="sd">        Returns:</span>
</span><span id="ArduousLoader-92"><a href="#ArduousLoader-92"><span class="linenos"> 92</span></a><span class="sd">            Dictionary containing sensor information</span>
</span><span id="ArduousLoader-93"><a href="#ArduousLoader-93"><span class="linenos"> 93</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ArduousLoader-94"><a href="#ArduousLoader-94"><span class="linenos"> 94</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="ArduousLoader-95"><a href="#ArduousLoader-95"><span class="linenos"> 95</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sensors&#39;</span><span class="p">],</span>
</span><span id="ArduousLoader-96"><a href="#ArduousLoader-96"><span class="linenos"> 96</span></a>            <span class="s1">&#39;components&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;components&#39;</span><span class="p">],</span>
</span><span id="ArduousLoader-97"><a href="#ArduousLoader-97"><span class="linenos"> 97</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sampling_frequency&#39;</span><span class="p">]</span>
</span><span id="ArduousLoader-98"><a href="#ArduousLoader-98"><span class="linenos"> 98</span></a>        <span class="p">}</span>
</span><span id="ArduousLoader-99"><a href="#ArduousLoader-99"><span class="linenos"> 99</span></a>    
</span><span id="ArduousLoader-100"><a href="#ArduousLoader-100"><span class="linenos">100</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_activity_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="ArduousLoader-101"><a href="#ArduousLoader-101"><span class="linenos">101</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ArduousLoader-102"><a href="#ArduousLoader-102"><span class="linenos">102</span></a><span class="sd">        Get information about activities in the dataset.</span>
</span><span id="ArduousLoader-103"><a href="#ArduousLoader-103"><span class="linenos">103</span></a><span class="sd">        </span>
</span><span id="ArduousLoader-104"><a href="#ArduousLoader-104"><span class="linenos">104</span></a><span class="sd">        Returns:</span>
</span><span id="ArduousLoader-105"><a href="#ArduousLoader-105"><span class="linenos">105</span></a><span class="sd">            List of activity types</span>
</span><span id="ArduousLoader-106"><a href="#ArduousLoader-106"><span class="linenos">106</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ArduousLoader-107"><a href="#ArduousLoader-107"><span class="linenos">107</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;activities&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Arduous dataset loader class.</p>

<p>This class handles loading and processing of the Arduous dataset for gait analysis.</p>
</div>


                            <div id="ArduousLoader.__init__" class="classattr">
                                        <input id="ArduousLoader.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">ArduousLoader</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span></span>)</span>

                <label class="view-source-button" for="ArduousLoader.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ArduousLoader.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ArduousLoader.__init__-24"><a href="#ArduousLoader.__init__-24"><span class="linenos">24</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">):</span>
</span><span id="ArduousLoader.__init__-25"><a href="#ArduousLoader.__init__-25"><span class="linenos">25</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ArduousLoader.__init__-26"><a href="#ArduousLoader.__init__-26"><span class="linenos">26</span></a><span class="sd">        Initialize Arduous loader with concurrent download support.</span>
</span><span id="ArduousLoader.__init__-27"><a href="#ArduousLoader.__init__-27"><span class="linenos">27</span></a><span class="sd">        </span>
</span><span id="ArduousLoader.__init__-28"><a href="#ArduousLoader.__init__-28"><span class="linenos">28</span></a><span class="sd">        Args:</span>
</span><span id="ArduousLoader.__init__-29"><a href="#ArduousLoader.__init__-29"><span class="linenos">29</span></a><span class="sd">            max_workers: Maximum number of concurrent download threads (default: 8)</span>
</span><span id="ArduousLoader.__init__-30"><a href="#ArduousLoader.__init__-30"><span class="linenos">30</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ArduousLoader.__init__-31"><a href="#ArduousLoader.__init__-31"><span class="linenos">31</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="ArduousLoader.__init__-32"><a href="#ArduousLoader.__init__-32"><span class="linenos">32</span></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;arduous&quot;</span><span class="p">,</span>
</span><span id="ArduousLoader.__init__-33"><a href="#ArduousLoader.__init__-33"><span class="linenos">33</span></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Arduous Dataset - Contains multi-sensor wearable data for daily activity recognition&quot;</span><span class="p">,</span>
</span><span id="ArduousLoader.__init__-34"><a href="#ArduousLoader.__init__-34"><span class="linenos">34</span></a>            <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span>
</span><span id="ArduousLoader.__init__-35"><a href="#ArduousLoader.__init__-35"><span class="linenos">35</span></a>        <span class="p">)</span>
</span><span id="ArduousLoader.__init__-36"><a href="#ArduousLoader.__init__-36"><span class="linenos">36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ArduousLoader.__init__-37"><a href="#ArduousLoader.__init__-37"><span class="linenos">37</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;accelerometer&#39;</span><span class="p">,</span> <span class="s1">&#39;gyroscope&#39;</span><span class="p">,</span> <span class="s1">&#39;magnetometer&#39;</span><span class="p">],</span>
</span><span id="ArduousLoader.__init__-38"><a href="#ArduousLoader.__init__-38"><span class="linenos">38</span></a>            <span class="s1">&#39;components&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span>
</span><span id="ArduousLoader.__init__-39"><a href="#ArduousLoader.__init__-39"><span class="linenos">39</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>  <span class="c1"># Typical for Arduous</span>
</span><span id="ArduousLoader.__init__-40"><a href="#ArduousLoader.__init__-40"><span class="linenos">40</span></a>            <span class="s1">&#39;activities&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;walking&#39;</span><span class="p">,</span> <span class="s1">&#39;running&#39;</span><span class="p">,</span> <span class="s1">&#39;sitting&#39;</span><span class="p">,</span> <span class="s1">&#39;standing&#39;</span><span class="p">,</span> <span class="s1">&#39;lying&#39;</span><span class="p">]</span>
</span><span id="ArduousLoader.__init__-41"><a href="#ArduousLoader.__init__-41"><span class="linenos">41</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Initialize Arduous loader with concurrent download support.</p>

<p>Args:
    max_workers: Maximum number of concurrent download threads (default: 8)</p>
</div>


                            </div>
                            <div id="ArduousLoader.metadata" class="classattr">
                                <div class="attr variable">
            <span class="name">metadata</span>

        
    </div>
    <a class="headerlink" href="#ArduousLoader.metadata"></a>
    
    

                            </div>
                            <div id="ArduousLoader.load_data" class="classattr">
                                        <input id="ArduousLoader.load_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_data</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="ArduousLoader.load_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ArduousLoader.load_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ArduousLoader.load_data-43"><a href="#ArduousLoader.load_data-43"><span class="linenos">43</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ArduousLoader.load_data-44"><a href="#ArduousLoader.load_data-44"><span class="linenos">44</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ArduousLoader.load_data-45"><a href="#ArduousLoader.load_data-45"><span class="linenos">45</span></a><span class="sd">        Load Arduous dataset from the specified directory.</span>
</span><span id="ArduousLoader.load_data-46"><a href="#ArduousLoader.load_data-46"><span class="linenos">46</span></a><span class="sd">        </span>
</span><span id="ArduousLoader.load_data-47"><a href="#ArduousLoader.load_data-47"><span class="linenos">47</span></a><span class="sd">        Args:</span>
</span><span id="ArduousLoader.load_data-48"><a href="#ArduousLoader.load_data-48"><span class="linenos">48</span></a><span class="sd">            data_dir: Directory to store/find the dataset</span>
</span><span id="ArduousLoader.load_data-49"><a href="#ArduousLoader.load_data-49"><span class="linenos">49</span></a><span class="sd">            **kwargs: Additional arguments (unused for Arduous)</span>
</span><span id="ArduousLoader.load_data-50"><a href="#ArduousLoader.load_data-50"><span class="linenos">50</span></a><span class="sd">            </span>
</span><span id="ArduousLoader.load_data-51"><a href="#ArduousLoader.load_data-51"><span class="linenos">51</span></a><span class="sd">        Returns:</span>
</span><span id="ArduousLoader.load_data-52"><a href="#ArduousLoader.load_data-52"><span class="linenos">52</span></a><span class="sd">            Tuple of (data_list, names_list)</span>
</span><span id="ArduousLoader.load_data-53"><a href="#ArduousLoader.load_data-53"><span class="linenos">53</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ArduousLoader.load_data-54"><a href="#ArduousLoader.load_data-54"><span class="linenos">54</span></a>        <span class="c1"># TODO: Implement Arduous data loading</span>
</span><span id="ArduousLoader.load_data-55"><a href="#ArduousLoader.load_data-55"><span class="linenos">55</span></a>        <span class="c1"># This is a placeholder implementation</span>
</span><span id="ArduousLoader.load_data-56"><a href="#ArduousLoader.load_data-56"><span class="linenos">56</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Arduous data loading is not yet implemented&quot;</span><span class="p">)</span>
</span><span id="ArduousLoader.load_data-57"><a href="#ArduousLoader.load_data-57"><span class="linenos">57</span></a>        <span class="k">return</span> <span class="p">[],</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Load Arduous dataset from the specified directory.</p>

<p>Args:
    data_dir: Directory to store/find the dataset
    **kwargs: Additional arguments (unused for Arduous)</p>

<p>Returns:
    Tuple of (data_list, names_list)</p>
</div>


                            </div>
                            <div id="ArduousLoader.create_sliding_windows" class="classattr">
                                        <input id="ArduousLoader.create_sliding_windows-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_sliding_windows</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>,</span><span class="param">	<span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">192</span>,</span><span class="param">	<span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="ArduousLoader.create_sliding_windows-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ArduousLoader.create_sliding_windows"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ArduousLoader.create_sliding_windows-59"><a href="#ArduousLoader.create_sliding_windows-59"><span class="linenos">59</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_sliding_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> 
</span><span id="ArduousLoader.create_sliding_windows-60"><a href="#ArduousLoader.create_sliding_windows-60"><span class="linenos">60</span></a>                             <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">192</span><span class="p">,</span> <span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="ArduousLoader.create_sliding_windows-61"><a href="#ArduousLoader.create_sliding_windows-61"><span class="linenos">61</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ArduousLoader.create_sliding_windows-62"><a href="#ArduousLoader.create_sliding_windows-62"><span class="linenos">62</span></a><span class="sd">        Create sliding windows from the Arduous dataset.</span>
</span><span id="ArduousLoader.create_sliding_windows-63"><a href="#ArduousLoader.create_sliding_windows-63"><span class="linenos">63</span></a><span class="sd">        </span>
</span><span id="ArduousLoader.create_sliding_windows-64"><a href="#ArduousLoader.create_sliding_windows-64"><span class="linenos">64</span></a><span class="sd">        Args:</span>
</span><span id="ArduousLoader.create_sliding_windows-65"><a href="#ArduousLoader.create_sliding_windows-65"><span class="linenos">65</span></a><span class="sd">            data: List of DataFrames containing Arduous data</span>
</span><span id="ArduousLoader.create_sliding_windows-66"><a href="#ArduousLoader.create_sliding_windows-66"><span class="linenos">66</span></a><span class="sd">            names: List of names corresponding to the data</span>
</span><span id="ArduousLoader.create_sliding_windows-67"><a href="#ArduousLoader.create_sliding_windows-67"><span class="linenos">67</span></a><span class="sd">            window_size: Size of the sliding window (default: 192)</span>
</span><span id="ArduousLoader.create_sliding_windows-68"><a href="#ArduousLoader.create_sliding_windows-68"><span class="linenos">68</span></a><span class="sd">            step_size: Step size for the sliding window (default: 32)</span>
</span><span id="ArduousLoader.create_sliding_windows-69"><a href="#ArduousLoader.create_sliding_windows-69"><span class="linenos">69</span></a><span class="sd">            </span>
</span><span id="ArduousLoader.create_sliding_windows-70"><a href="#ArduousLoader.create_sliding_windows-70"><span class="linenos">70</span></a><span class="sd">        Returns:</span>
</span><span id="ArduousLoader.create_sliding_windows-71"><a href="#ArduousLoader.create_sliding_windows-71"><span class="linenos">71</span></a><span class="sd">            List of dictionaries containing sliding windows for each DataFrame</span>
</span><span id="ArduousLoader.create_sliding_windows-72"><a href="#ArduousLoader.create_sliding_windows-72"><span class="linenos">72</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ArduousLoader.create_sliding_windows-73"><a href="#ArduousLoader.create_sliding_windows-73"><span class="linenos">73</span></a>        <span class="c1"># TODO: Implement Arduous sliding window creation</span>
</span><span id="ArduousLoader.create_sliding_windows-74"><a href="#ArduousLoader.create_sliding_windows-74"><span class="linenos">74</span></a>        <span class="c1"># This is a placeholder implementation</span>
</span><span id="ArduousLoader.create_sliding_windows-75"><a href="#ArduousLoader.create_sliding_windows-75"><span class="linenos">75</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Arduous sliding window creation is not yet implemented&quot;</span><span class="p">)</span>
</span><span id="ArduousLoader.create_sliding_windows-76"><a href="#ArduousLoader.create_sliding_windows-76"><span class="linenos">76</span></a>        <span class="k">return</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Create sliding windows from the Arduous dataset.</p>

<p>Args:
    data: List of DataFrames containing Arduous data
    names: List of names corresponding to the data
    window_size: Size of the sliding window (default: 192)
    step_size: Step size for the sliding window (default: 32)</p>

<p>Returns:
    List of dictionaries containing sliding windows for each DataFrame</p>
</div>


                            </div>
                            <div id="ArduousLoader.get_supported_formats" class="classattr">
                                        <input id="ArduousLoader.get_supported_formats-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_supported_formats</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="ArduousLoader.get_supported_formats-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ArduousLoader.get_supported_formats"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ArduousLoader.get_supported_formats-78"><a href="#ArduousLoader.get_supported_formats-78"><span class="linenos">78</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_supported_formats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="ArduousLoader.get_supported_formats-79"><a href="#ArduousLoader.get_supported_formats-79"><span class="linenos">79</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ArduousLoader.get_supported_formats-80"><a href="#ArduousLoader.get_supported_formats-80"><span class="linenos">80</span></a><span class="sd">        Get list of supported file formats for Arduous dataset.</span>
</span><span id="ArduousLoader.get_supported_formats-81"><a href="#ArduousLoader.get_supported_formats-81"><span class="linenos">81</span></a><span class="sd">        </span>
</span><span id="ArduousLoader.get_supported_formats-82"><a href="#ArduousLoader.get_supported_formats-82"><span class="linenos">82</span></a><span class="sd">        Returns:</span>
</span><span id="ArduousLoader.get_supported_formats-83"><a href="#ArduousLoader.get_supported_formats-83"><span class="linenos">83</span></a><span class="sd">            List of supported file extensions</span>
</span><span id="ArduousLoader.get_supported_formats-84"><a href="#ArduousLoader.get_supported_formats-84"><span class="linenos">84</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ArduousLoader.get_supported_formats-85"><a href="#ArduousLoader.get_supported_formats-85"><span class="linenos">85</span></a>        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;.txt&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get list of supported file formats for Arduous dataset.</p>

<p>Returns:
    List of supported file extensions</p>
</div>


                            </div>
                            <div id="ArduousLoader.get_sensor_info" class="classattr">
                                        <input id="ArduousLoader.get_sensor_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_sensor_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="ArduousLoader.get_sensor_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ArduousLoader.get_sensor_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ArduousLoader.get_sensor_info-87"><a href="#ArduousLoader.get_sensor_info-87"><span class="linenos">87</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sensor_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ArduousLoader.get_sensor_info-88"><a href="#ArduousLoader.get_sensor_info-88"><span class="linenos">88</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ArduousLoader.get_sensor_info-89"><a href="#ArduousLoader.get_sensor_info-89"><span class="linenos">89</span></a><span class="sd">        Get information about sensors in the dataset.</span>
</span><span id="ArduousLoader.get_sensor_info-90"><a href="#ArduousLoader.get_sensor_info-90"><span class="linenos">90</span></a><span class="sd">        </span>
</span><span id="ArduousLoader.get_sensor_info-91"><a href="#ArduousLoader.get_sensor_info-91"><span class="linenos">91</span></a><span class="sd">        Returns:</span>
</span><span id="ArduousLoader.get_sensor_info-92"><a href="#ArduousLoader.get_sensor_info-92"><span class="linenos">92</span></a><span class="sd">            Dictionary containing sensor information</span>
</span><span id="ArduousLoader.get_sensor_info-93"><a href="#ArduousLoader.get_sensor_info-93"><span class="linenos">93</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ArduousLoader.get_sensor_info-94"><a href="#ArduousLoader.get_sensor_info-94"><span class="linenos">94</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="ArduousLoader.get_sensor_info-95"><a href="#ArduousLoader.get_sensor_info-95"><span class="linenos">95</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sensors&#39;</span><span class="p">],</span>
</span><span id="ArduousLoader.get_sensor_info-96"><a href="#ArduousLoader.get_sensor_info-96"><span class="linenos">96</span></a>            <span class="s1">&#39;components&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;components&#39;</span><span class="p">],</span>
</span><span id="ArduousLoader.get_sensor_info-97"><a href="#ArduousLoader.get_sensor_info-97"><span class="linenos">97</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sampling_frequency&#39;</span><span class="p">]</span>
</span><span id="ArduousLoader.get_sensor_info-98"><a href="#ArduousLoader.get_sensor_info-98"><span class="linenos">98</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Get information about sensors in the dataset.</p>

<p>Returns:
    Dictionary containing sensor information</p>
</div>


                            </div>
                            <div id="ArduousLoader.get_activity_info" class="classattr">
                                        <input id="ArduousLoader.get_activity_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_activity_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="ArduousLoader.get_activity_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ArduousLoader.get_activity_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ArduousLoader.get_activity_info-100"><a href="#ArduousLoader.get_activity_info-100"><span class="linenos">100</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_activity_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="ArduousLoader.get_activity_info-101"><a href="#ArduousLoader.get_activity_info-101"><span class="linenos">101</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ArduousLoader.get_activity_info-102"><a href="#ArduousLoader.get_activity_info-102"><span class="linenos">102</span></a><span class="sd">        Get information about activities in the dataset.</span>
</span><span id="ArduousLoader.get_activity_info-103"><a href="#ArduousLoader.get_activity_info-103"><span class="linenos">103</span></a><span class="sd">        </span>
</span><span id="ArduousLoader.get_activity_info-104"><a href="#ArduousLoader.get_activity_info-104"><span class="linenos">104</span></a><span class="sd">        Returns:</span>
</span><span id="ArduousLoader.get_activity_info-105"><a href="#ArduousLoader.get_activity_info-105"><span class="linenos">105</span></a><span class="sd">            List of activity types</span>
</span><span id="ArduousLoader.get_activity_info-106"><a href="#ArduousLoader.get_activity_info-106"><span class="linenos">106</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ArduousLoader.get_activity_info-107"><a href="#ArduousLoader.get_activity_info-107"><span class="linenos">107</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;activities&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get information about activities in the dataset.</p>

<p>Returns:
    List of activity types</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="core/base_classes.html#BaseDatasetLoader">gaitsetpy.core.base_classes.BaseDatasetLoader</a></dt>
                                <dd id="ArduousLoader.name" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.name">name</a></dd>
                <dd id="ArduousLoader.description" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.description">description</a></dd>
                <dd id="ArduousLoader.data" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.data">data</a></dd>
                <dd id="ArduousLoader.max_workers" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.max_workers">max_workers</a></dd>
                <dd id="ArduousLoader.download_files_concurrent" class="function"><a href="core/base_classes.html#BaseDatasetLoader.download_files_concurrent">download_files_concurrent</a></dd>
                <dd id="ArduousLoader.set_max_workers" class="function"><a href="core/base_classes.html#BaseDatasetLoader.set_max_workers">set_max_workers</a></dd>
                <dd id="ArduousLoader.get_download_stats" class="function"><a href="core/base_classes.html#BaseDatasetLoader.get_download_stats">get_download_stats</a></dd>
                <dd id="ArduousLoader.get_info" class="function"><a href="core/base_classes.html#BaseDatasetLoader.get_info">get_info</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="PhysioNetLoader">
                            <input id="PhysioNetLoader-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PhysioNetLoader</span><wbr>(<span class="base"><a href="core/base_classes.html#BaseDatasetLoader">gaitsetpy.core.base_classes.BaseDatasetLoader</a></span>):

                <label class="view-source-button" for="PhysioNetLoader-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PhysioNetLoader"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PhysioNetLoader-25"><a href="#PhysioNetLoader-25"><span class="linenos"> 25</span></a><span class="k">class</span><span class="w"> </span><span class="nc">PhysioNetLoader</span><span class="p">(</span><span class="n">BaseDatasetLoader</span><span class="p">):</span>
</span><span id="PhysioNetLoader-26"><a href="#PhysioNetLoader-26"><span class="linenos"> 26</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-27"><a href="#PhysioNetLoader-27"><span class="linenos"> 27</span></a><span class="sd">    PhysioNet VGRF dataset loader class.</span>
</span><span id="PhysioNetLoader-28"><a href="#PhysioNetLoader-28"><span class="linenos"> 28</span></a><span class="sd">    </span>
</span><span id="PhysioNetLoader-29"><a href="#PhysioNetLoader-29"><span class="linenos"> 29</span></a><span class="sd">    This class handles loading and processing of the PhysioNet Gait in Parkinson&#39;s Disease dataset.</span>
</span><span id="PhysioNetLoader-30"><a href="#PhysioNetLoader-30"><span class="linenos"> 30</span></a><span class="sd">    The dataset contains vertical ground reaction force (VGRF) data from subjects with Parkinson&#39;s </span>
</span><span id="PhysioNetLoader-31"><a href="#PhysioNetLoader-31"><span class="linenos"> 31</span></a><span class="sd">    disease and healthy controls.</span>
</span><span id="PhysioNetLoader-32"><a href="#PhysioNetLoader-32"><span class="linenos"> 32</span></a><span class="sd">    </span>
</span><span id="PhysioNetLoader-33"><a href="#PhysioNetLoader-33"><span class="linenos"> 33</span></a><span class="sd">    Features concurrent downloading for efficient data retrieval.</span>
</span><span id="PhysioNetLoader-34"><a href="#PhysioNetLoader-34"><span class="linenos"> 34</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-35"><a href="#PhysioNetLoader-35"><span class="linenos"> 35</span></a>    
</span><span id="PhysioNetLoader-36"><a href="#PhysioNetLoader-36"><span class="linenos"> 36</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">):</span>
</span><span id="PhysioNetLoader-37"><a href="#PhysioNetLoader-37"><span class="linenos"> 37</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-38"><a href="#PhysioNetLoader-38"><span class="linenos"> 38</span></a><span class="sd">        Initialize PhysioNet loader with concurrent download support.</span>
</span><span id="PhysioNetLoader-39"><a href="#PhysioNetLoader-39"><span class="linenos"> 39</span></a><span class="sd">        </span>
</span><span id="PhysioNetLoader-40"><a href="#PhysioNetLoader-40"><span class="linenos"> 40</span></a><span class="sd">        Args:</span>
</span><span id="PhysioNetLoader-41"><a href="#PhysioNetLoader-41"><span class="linenos"> 41</span></a><span class="sd">            max_workers: Maximum number of concurrent download threads (default: 8)</span>
</span><span id="PhysioNetLoader-42"><a href="#PhysioNetLoader-42"><span class="linenos"> 42</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-43"><a href="#PhysioNetLoader-43"><span class="linenos"> 43</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="PhysioNetLoader-44"><a href="#PhysioNetLoader-44"><span class="linenos"> 44</span></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;physionet&quot;</span><span class="p">,</span>
</span><span id="PhysioNetLoader-45"><a href="#PhysioNetLoader-45"><span class="linenos"> 45</span></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;PhysioNet Gait in Parkinson&#39;s Disease Dataset - Contains VGRF data from subjects with Parkinson&#39;s disease and healthy controls&quot;</span><span class="p">,</span>
</span><span id="PhysioNetLoader-46"><a href="#PhysioNetLoader-46"><span class="linenos"> 46</span></a>            <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span>
</span><span id="PhysioNetLoader-47"><a href="#PhysioNetLoader-47"><span class="linenos"> 47</span></a>        <span class="p">)</span>
</span><span id="PhysioNetLoader-48"><a href="#PhysioNetLoader-48"><span class="linenos"> 48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PhysioNetLoader-49"><a href="#PhysioNetLoader-49"><span class="linenos"> 49</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;VGRF_L1&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_L2&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_L3&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_L4&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_L5&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_L6&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_L7&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_L8&#39;</span><span class="p">,</span>
</span><span id="PhysioNetLoader-50"><a href="#PhysioNetLoader-50"><span class="linenos"> 50</span></a>                       <span class="s1">&#39;VGRF_R1&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_R2&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_R3&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_R4&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_R5&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_R6&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_R7&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_R8&#39;</span><span class="p">],</span>
</span><span id="PhysioNetLoader-51"><a href="#PhysioNetLoader-51"><span class="linenos"> 51</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>  <span class="c1"># 100 Hz sampling frequency</span>
</span><span id="PhysioNetLoader-52"><a href="#PhysioNetLoader-52"><span class="linenos"> 52</span></a>            <span class="s1">&#39;subjects&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="PhysioNetLoader-53"><a href="#PhysioNetLoader-53"><span class="linenos"> 53</span></a>                <span class="s1">&#39;Co&#39;</span><span class="p">:</span> <span class="s1">&#39;Control subjects&#39;</span><span class="p">,</span>
</span><span id="PhysioNetLoader-54"><a href="#PhysioNetLoader-54"><span class="linenos"> 54</span></a>                <span class="s1">&#39;Pt&#39;</span><span class="p">:</span> <span class="s1">&#39;Parkinson</span><span class="se">\&#39;</span><span class="s1">s disease patients&#39;</span>
</span><span id="PhysioNetLoader-55"><a href="#PhysioNetLoader-55"><span class="linenos"> 55</span></a>            <span class="p">},</span>
</span><span id="PhysioNetLoader-56"><a href="#PhysioNetLoader-56"><span class="linenos"> 56</span></a>            <span class="s1">&#39;window_size&#39;</span><span class="p">:</span> <span class="mi">600</span><span class="p">,</span>  <span class="c1"># 6 seconds at 100 Hz</span>
</span><span id="PhysioNetLoader-57"><a href="#PhysioNetLoader-57"><span class="linenos"> 57</span></a>            <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://physionet.org/files/gaitpdb/1.0.0/&#39;</span>
</span><span id="PhysioNetLoader-58"><a href="#PhysioNetLoader-58"><span class="linenos"> 58</span></a>        <span class="p">}</span>
</span><span id="PhysioNetLoader-59"><a href="#PhysioNetLoader-59"><span class="linenos"> 59</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PhysioNetLoader-60"><a href="#PhysioNetLoader-60"><span class="linenos"> 60</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subject_types</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PhysioNetLoader-61"><a href="#PhysioNetLoader-61"><span class="linenos"> 61</span></a>    
</span><span id="PhysioNetLoader-62"><a href="#PhysioNetLoader-62"><span class="linenos"> 62</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_download_physionet_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PhysioNetLoader-63"><a href="#PhysioNetLoader-63"><span class="linenos"> 63</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-64"><a href="#PhysioNetLoader-64"><span class="linenos"> 64</span></a><span class="sd">        Download PhysioNet dataset if not already present using concurrent downloads.</span>
</span><span id="PhysioNetLoader-65"><a href="#PhysioNetLoader-65"><span class="linenos"> 65</span></a><span class="sd">        </span>
</span><span id="PhysioNetLoader-66"><a href="#PhysioNetLoader-66"><span class="linenos"> 66</span></a><span class="sd">        This method uses multi-threaded downloading to significantly speed up the</span>
</span><span id="PhysioNetLoader-67"><a href="#PhysioNetLoader-67"><span class="linenos"> 67</span></a><span class="sd">        download process for the 100+ files in the PhysioNet dataset.</span>
</span><span id="PhysioNetLoader-68"><a href="#PhysioNetLoader-68"><span class="linenos"> 68</span></a><span class="sd">        </span>
</span><span id="PhysioNetLoader-69"><a href="#PhysioNetLoader-69"><span class="linenos"> 69</span></a><span class="sd">        Args:</span>
</span><span id="PhysioNetLoader-70"><a href="#PhysioNetLoader-70"><span class="linenos"> 70</span></a><span class="sd">            data_dir: Directory to store the dataset</span>
</span><span id="PhysioNetLoader-71"><a href="#PhysioNetLoader-71"><span class="linenos"> 71</span></a><span class="sd">            </span>
</span><span id="PhysioNetLoader-72"><a href="#PhysioNetLoader-72"><span class="linenos"> 72</span></a><span class="sd">        Returns:</span>
</span><span id="PhysioNetLoader-73"><a href="#PhysioNetLoader-73"><span class="linenos"> 73</span></a><span class="sd">            Path to the downloaded/existing dataset directory</span>
</span><span id="PhysioNetLoader-74"><a href="#PhysioNetLoader-74"><span class="linenos"> 74</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-75"><a href="#PhysioNetLoader-75"><span class="linenos"> 75</span></a>        <span class="n">dataset_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;physionet_gaitpdb&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-76"><a href="#PhysioNetLoader-76"><span class="linenos"> 76</span></a>        
</span><span id="PhysioNetLoader-77"><a href="#PhysioNetLoader-77"><span class="linenos"> 77</span></a>        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dataset_path</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">dataset_path</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PhysioNetLoader-78"><a href="#PhysioNetLoader-78"><span class="linenos"> 78</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PhysioNet dataset already exists at: </span><span class="si">{</span><span class="n">dataset_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-79"><a href="#PhysioNetLoader-79"><span class="linenos"> 79</span></a>            <span class="k">return</span> <span class="n">dataset_path</span>
</span><span id="PhysioNetLoader-80"><a href="#PhysioNetLoader-80"><span class="linenos"> 80</span></a>        
</span><span id="PhysioNetLoader-81"><a href="#PhysioNetLoader-81"><span class="linenos"> 81</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dataset_path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PhysioNetLoader-82"><a href="#PhysioNetLoader-82"><span class="linenos"> 82</span></a>        
</span><span id="PhysioNetLoader-83"><a href="#PhysioNetLoader-83"><span class="linenos"> 83</span></a>        <span class="c1"># Download the dataset files</span>
</span><span id="PhysioNetLoader-84"><a href="#PhysioNetLoader-84"><span class="linenos"> 84</span></a>        <span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;https://physionet.org/files/gaitpdb/1.0.0/&quot;</span>
</span><span id="PhysioNetLoader-85"><a href="#PhysioNetLoader-85"><span class="linenos"> 85</span></a>        
</span><span id="PhysioNetLoader-86"><a href="#PhysioNetLoader-86"><span class="linenos"> 86</span></a>        <span class="c1"># Get list of files (basic file names based on the reference)</span>
</span><span id="PhysioNetLoader-87"><a href="#PhysioNetLoader-87"><span class="linenos"> 87</span></a>        <span class="n">file_patterns</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PhysioNetLoader-88"><a href="#PhysioNetLoader-88"><span class="linenos"> 88</span></a>            <span class="c1"># Control subjects - Ga prefix</span>
</span><span id="PhysioNetLoader-89"><a href="#PhysioNetLoader-89"><span class="linenos"> 89</span></a>            <span class="o">*</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;GaCo</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">j</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">.txt&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span>
</span><span id="PhysioNetLoader-90"><a href="#PhysioNetLoader-90"><span class="linenos"> 90</span></a>            <span class="s2">&quot;GaCo22_01.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;GaCo22_10.txt&quot;</span><span class="p">,</span>
</span><span id="PhysioNetLoader-91"><a href="#PhysioNetLoader-91"><span class="linenos"> 91</span></a>            
</span><span id="PhysioNetLoader-92"><a href="#PhysioNetLoader-92"><span class="linenos"> 92</span></a>            <span class="c1"># Parkinson&#39;s patients - Ga prefix</span>
</span><span id="PhysioNetLoader-93"><a href="#PhysioNetLoader-93"><span class="linenos"> 93</span></a>            <span class="o">*</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;GaPt</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">j</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">.txt&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span>
</span><span id="PhysioNetLoader-94"><a href="#PhysioNetLoader-94"><span class="linenos"> 94</span></a>            <span class="o">*</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;GaPt</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">j</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">.txt&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">34</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span>
</span><span id="PhysioNetLoader-95"><a href="#PhysioNetLoader-95"><span class="linenos"> 95</span></a>            <span class="o">*</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;GaPt</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">_10.txt&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">34</span><span class="p">)],</span>
</span><span id="PhysioNetLoader-96"><a href="#PhysioNetLoader-96"><span class="linenos"> 96</span></a>            
</span><span id="PhysioNetLoader-97"><a href="#PhysioNetLoader-97"><span class="linenos"> 97</span></a>            <span class="c1"># Control subjects - Ju prefix</span>
</span><span id="PhysioNetLoader-98"><a href="#PhysioNetLoader-98"><span class="linenos"> 98</span></a>            <span class="o">*</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;JuCo</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">_01.txt&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">27</span><span class="p">)],</span>
</span><span id="PhysioNetLoader-99"><a href="#PhysioNetLoader-99"><span class="linenos"> 99</span></a>            
</span><span id="PhysioNetLoader-100"><a href="#PhysioNetLoader-100"><span class="linenos">100</span></a>            <span class="c1"># Parkinson&#39;s patients - Ju prefix</span>
</span><span id="PhysioNetLoader-101"><a href="#PhysioNetLoader-101"><span class="linenos">101</span></a>            <span class="o">*</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;JuPt</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">j</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">.txt&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)],</span>
</span><span id="PhysioNetLoader-102"><a href="#PhysioNetLoader-102"><span class="linenos">102</span></a>            
</span><span id="PhysioNetLoader-103"><a href="#PhysioNetLoader-103"><span class="linenos">103</span></a>            <span class="c1"># Control subjects - Si prefix</span>
</span><span id="PhysioNetLoader-104"><a href="#PhysioNetLoader-104"><span class="linenos">104</span></a>            <span class="o">*</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;SiCo</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">_01.txt&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">31</span><span class="p">)],</span>
</span><span id="PhysioNetLoader-105"><a href="#PhysioNetLoader-105"><span class="linenos">105</span></a>            
</span><span id="PhysioNetLoader-106"><a href="#PhysioNetLoader-106"><span class="linenos">106</span></a>            <span class="c1"># Parkinson&#39;s patients - Si prefix</span>
</span><span id="PhysioNetLoader-107"><a href="#PhysioNetLoader-107"><span class="linenos">107</span></a>            <span class="o">*</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;SiPt</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">_01.txt&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">41</span><span class="p">)]</span>
</span><span id="PhysioNetLoader-108"><a href="#PhysioNetLoader-108"><span class="linenos">108</span></a>        <span class="p">]</span>
</span><span id="PhysioNetLoader-109"><a href="#PhysioNetLoader-109"><span class="linenos">109</span></a>        
</span><span id="PhysioNetLoader-110"><a href="#PhysioNetLoader-110"><span class="linenos">110</span></a>        <span class="c1"># Prepare download tasks for concurrent execution</span>
</span><span id="PhysioNetLoader-111"><a href="#PhysioNetLoader-111"><span class="linenos">111</span></a>        <span class="n">download_tasks</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PhysioNetLoader-112"><a href="#PhysioNetLoader-112"><span class="linenos">112</span></a>            <span class="p">{</span>
</span><span id="PhysioNetLoader-113"><a href="#PhysioNetLoader-113"><span class="linenos">113</span></a>                <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">base_url</span> <span class="o">+</span> <span class="n">filename</span><span class="p">,</span>
</span><span id="PhysioNetLoader-114"><a href="#PhysioNetLoader-114"><span class="linenos">114</span></a>                <span class="s1">&#39;dest_path&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dataset_path</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</span><span id="PhysioNetLoader-115"><a href="#PhysioNetLoader-115"><span class="linenos">115</span></a>            <span class="p">}</span>
</span><span id="PhysioNetLoader-116"><a href="#PhysioNetLoader-116"><span class="linenos">116</span></a>            <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">file_patterns</span>
</span><span id="PhysioNetLoader-117"><a href="#PhysioNetLoader-117"><span class="linenos">117</span></a>        <span class="p">]</span>
</span><span id="PhysioNetLoader-118"><a href="#PhysioNetLoader-118"><span class="linenos">118</span></a>        
</span><span id="PhysioNetLoader-119"><a href="#PhysioNetLoader-119"><span class="linenos">119</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading PhysioNet dataset to </span><span class="si">{</span><span class="n">dataset_path</span><span class="si">}</span><span class="s2"> using </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_workers</span><span class="si">}</span><span class="s2"> threads&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-120"><a href="#PhysioNetLoader-120"><span class="linenos">120</span></a>        
</span><span id="PhysioNetLoader-121"><a href="#PhysioNetLoader-121"><span class="linenos">121</span></a>        <span class="c1"># Use concurrent downloading from base class</span>
</span><span id="PhysioNetLoader-122"><a href="#PhysioNetLoader-122"><span class="linenos">122</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">download_files_concurrent</span><span class="p">(</span>
</span><span id="PhysioNetLoader-123"><a href="#PhysioNetLoader-123"><span class="linenos">123</span></a>            <span class="n">download_tasks</span><span class="p">,</span> 
</span><span id="PhysioNetLoader-124"><a href="#PhysioNetLoader-124"><span class="linenos">124</span></a>            <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
</span><span id="PhysioNetLoader-125"><a href="#PhysioNetLoader-125"><span class="linenos">125</span></a>            <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Downloading PhysioNet files&quot;</span>
</span><span id="PhysioNetLoader-126"><a href="#PhysioNetLoader-126"><span class="linenos">126</span></a>        <span class="p">)</span>
</span><span id="PhysioNetLoader-127"><a href="#PhysioNetLoader-127"><span class="linenos">127</span></a>        
</span><span id="PhysioNetLoader-128"><a href="#PhysioNetLoader-128"><span class="linenos">128</span></a>        <span class="c1"># Print summary</span>
</span><span id="PhysioNetLoader-129"><a href="#PhysioNetLoader-129"><span class="linenos">129</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Download Summary:&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-130"><a href="#PhysioNetLoader-130"><span class="linenos">130</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Total files: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-131"><a href="#PhysioNetLoader-131"><span class="linenos">131</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Successfully downloaded: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-132"><a href="#PhysioNetLoader-132"><span class="linenos">132</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Already existed (skipped): </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;skipped&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-133"><a href="#PhysioNetLoader-133"><span class="linenos">133</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Failed: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;failed&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-134"><a href="#PhysioNetLoader-134"><span class="linenos">134</span></a>        
</span><span id="PhysioNetLoader-135"><a href="#PhysioNetLoader-135"><span class="linenos">135</span></a>        <span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;failed&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;failed_downloads&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PhysioNetLoader-136"><a href="#PhysioNetLoader-136"><span class="linenos">136</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed downloads (showing first 10):&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-137"><a href="#PhysioNetLoader-137"><span class="linenos">137</span></a>            <span class="k">for</span> <span class="n">failed</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;failed_downloads&#39;</span><span class="p">][:</span><span class="mi">10</span><span class="p">]:</span>
</span><span id="PhysioNetLoader-138"><a href="#PhysioNetLoader-138"><span class="linenos">138</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">failed</span><span class="p">[</span><span class="s1">&#39;dest_path&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">failed</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-139"><a href="#PhysioNetLoader-139"><span class="linenos">139</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;failed_downloads&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="PhysioNetLoader-140"><a href="#PhysioNetLoader-140"><span class="linenos">140</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ... and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;failed_downloads&#39;</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">10</span><span class="si">}</span><span class="s2"> more failures&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-141"><a href="#PhysioNetLoader-141"><span class="linenos">141</span></a>        
</span><span id="PhysioNetLoader-142"><a href="#PhysioNetLoader-142"><span class="linenos">142</span></a>        <span class="k">return</span> <span class="n">dataset_path</span>
</span><span id="PhysioNetLoader-143"><a href="#PhysioNetLoader-143"><span class="linenos">143</span></a>    
</span><span id="PhysioNetLoader-144"><a href="#PhysioNetLoader-144"><span class="linenos">144</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="PhysioNetLoader-145"><a href="#PhysioNetLoader-145"><span class="linenos">145</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-146"><a href="#PhysioNetLoader-146"><span class="linenos">146</span></a><span class="sd">        Load PhysioNet VGRF dataset from the specified directory.</span>
</span><span id="PhysioNetLoader-147"><a href="#PhysioNetLoader-147"><span class="linenos">147</span></a><span class="sd">        </span>
</span><span id="PhysioNetLoader-148"><a href="#PhysioNetLoader-148"><span class="linenos">148</span></a><span class="sd">        Args:</span>
</span><span id="PhysioNetLoader-149"><a href="#PhysioNetLoader-149"><span class="linenos">149</span></a><span class="sd">            data_dir: Directory to store/find the dataset</span>
</span><span id="PhysioNetLoader-150"><a href="#PhysioNetLoader-150"><span class="linenos">150</span></a><span class="sd">            **kwargs: Additional arguments (unused for PhysioNet)</span>
</span><span id="PhysioNetLoader-151"><a href="#PhysioNetLoader-151"><span class="linenos">151</span></a><span class="sd">            </span>
</span><span id="PhysioNetLoader-152"><a href="#PhysioNetLoader-152"><span class="linenos">152</span></a><span class="sd">        Returns:</span>
</span><span id="PhysioNetLoader-153"><a href="#PhysioNetLoader-153"><span class="linenos">153</span></a><span class="sd">            Tuple of (data_list, names_list)</span>
</span><span id="PhysioNetLoader-154"><a href="#PhysioNetLoader-154"><span class="linenos">154</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-155"><a href="#PhysioNetLoader-155"><span class="linenos">155</span></a>        <span class="c1"># Download dataset if needed</span>
</span><span id="PhysioNetLoader-156"><a href="#PhysioNetLoader-156"><span class="linenos">156</span></a>        <span class="n">dataset_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_download_physionet_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</span><span id="PhysioNetLoader-157"><a href="#PhysioNetLoader-157"><span class="linenos">157</span></a>        
</span><span id="PhysioNetLoader-158"><a href="#PhysioNetLoader-158"><span class="linenos">158</span></a>        <span class="n">physionet_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PhysioNetLoader-159"><a href="#PhysioNetLoader-159"><span class="linenos">159</span></a>        <span class="n">physionet_names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PhysioNetLoader-160"><a href="#PhysioNetLoader-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PhysioNetLoader-161"><a href="#PhysioNetLoader-161"><span class="linenos">161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subject_types</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PhysioNetLoader-162"><a href="#PhysioNetLoader-162"><span class="linenos">162</span></a>        
</span><span id="PhysioNetLoader-163"><a href="#PhysioNetLoader-163"><span class="linenos">163</span></a>        <span class="c1"># Load all available files</span>
</span><span id="PhysioNetLoader-164"><a href="#PhysioNetLoader-164"><span class="linenos">164</span></a>        <span class="k">for</span> <span class="n">filepath</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dataset_path</span><span class="p">,</span> <span class="s2">&quot;Ga*.txt&quot;</span><span class="p">))):</span>
</span><span id="PhysioNetLoader-165"><a href="#PhysioNetLoader-165"><span class="linenos">165</span></a>            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
</span><span id="PhysioNetLoader-166"><a href="#PhysioNetLoader-166"><span class="linenos">166</span></a>            
</span><span id="PhysioNetLoader-167"><a href="#PhysioNetLoader-167"><span class="linenos">167</span></a>            <span class="c1"># Extract subject type from filename</span>
</span><span id="PhysioNetLoader-168"><a href="#PhysioNetLoader-168"><span class="linenos">168</span></a>            <span class="k">if</span> <span class="s1">&#39;Co&#39;</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">:</span>
</span><span id="PhysioNetLoader-169"><a href="#PhysioNetLoader-169"><span class="linenos">169</span></a>                <span class="n">subject_type</span> <span class="o">=</span> <span class="s1">&#39;Control&#39;</span>
</span><span id="PhysioNetLoader-170"><a href="#PhysioNetLoader-170"><span class="linenos">170</span></a>                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Co&#39;</span>
</span><span id="PhysioNetLoader-171"><a href="#PhysioNetLoader-171"><span class="linenos">171</span></a>            <span class="k">elif</span> <span class="s1">&#39;Pt&#39;</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">:</span>
</span><span id="PhysioNetLoader-172"><a href="#PhysioNetLoader-172"><span class="linenos">172</span></a>                <span class="n">subject_type</span> <span class="o">=</span> <span class="s1">&#39;Patient&#39;</span>
</span><span id="PhysioNetLoader-173"><a href="#PhysioNetLoader-173"><span class="linenos">173</span></a>                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Pt&#39;</span>
</span><span id="PhysioNetLoader-174"><a href="#PhysioNetLoader-174"><span class="linenos">174</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PhysioNetLoader-175"><a href="#PhysioNetLoader-175"><span class="linenos">175</span></a>                <span class="k">continue</span>  <span class="c1"># Skip files that don&#39;t match expected pattern</span>
</span><span id="PhysioNetLoader-176"><a href="#PhysioNetLoader-176"><span class="linenos">176</span></a>            
</span><span id="PhysioNetLoader-177"><a href="#PhysioNetLoader-177"><span class="linenos">177</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PhysioNetLoader-178"><a href="#PhysioNetLoader-178"><span class="linenos">178</span></a>                <span class="c1"># Read the file - PhysioNet files are tab-delimited with variable columns</span>
</span><span id="PhysioNetLoader-179"><a href="#PhysioNetLoader-179"><span class="linenos">179</span></a>                <span class="c1"># Column 0: time, Columns 1-16: VGRF sensors, additional columns may exist</span>
</span><span id="PhysioNetLoader-180"><a href="#PhysioNetLoader-180"><span class="linenos">180</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="PhysioNetLoader-181"><a href="#PhysioNetLoader-181"><span class="linenos">181</span></a>                
</span><span id="PhysioNetLoader-182"><a href="#PhysioNetLoader-182"><span class="linenos">182</span></a>                <span class="c1"># Handle variable number of columns</span>
</span><span id="PhysioNetLoader-183"><a href="#PhysioNetLoader-183"><span class="linenos">183</span></a>                <span class="n">n_cols</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">19</span><span class="p">)</span>  <span class="c1"># Limit to 19 columns max</span>
</span><span id="PhysioNetLoader-184"><a href="#PhysioNetLoader-184"><span class="linenos">184</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="n">n_cols</span><span class="p">]</span>
</span><span id="PhysioNetLoader-185"><a href="#PhysioNetLoader-185"><span class="linenos">185</span></a>                
</span><span id="PhysioNetLoader-186"><a href="#PhysioNetLoader-186"><span class="linenos">186</span></a>                <span class="c1"># Create column names</span>
</span><span id="PhysioNetLoader-187"><a href="#PhysioNetLoader-187"><span class="linenos">187</span></a>                <span class="n">col_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>
</span><span id="PhysioNetLoader-188"><a href="#PhysioNetLoader-188"><span class="linenos">188</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">):</span>
</span><span id="PhysioNetLoader-189"><a href="#PhysioNetLoader-189"><span class="linenos">189</span></a>                    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="PhysioNetLoader-190"><a href="#PhysioNetLoader-190"><span class="linenos">190</span></a>                        <span class="n">col_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;VGRF_L</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-191"><a href="#PhysioNetLoader-191"><span class="linenos">191</span></a>                    <span class="k">elif</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">16</span><span class="p">:</span>
</span><span id="PhysioNetLoader-192"><a href="#PhysioNetLoader-192"><span class="linenos">192</span></a>                        <span class="n">col_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;VGRF_R</span><span class="si">{</span><span class="n">i</span><span class="o">-</span><span class="mi">8</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-193"><a href="#PhysioNetLoader-193"><span class="linenos">193</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="PhysioNetLoader-194"><a href="#PhysioNetLoader-194"><span class="linenos">194</span></a>                        <span class="n">col_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;sensor_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-195"><a href="#PhysioNetLoader-195"><span class="linenos">195</span></a>                
</span><span id="PhysioNetLoader-196"><a href="#PhysioNetLoader-196"><span class="linenos">196</span></a>                <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">col_names</span>
</span><span id="PhysioNetLoader-197"><a href="#PhysioNetLoader-197"><span class="linenos">197</span></a>                
</span><span id="PhysioNetLoader-198"><a href="#PhysioNetLoader-198"><span class="linenos">198</span></a>                <span class="c1"># Set time as index</span>
</span><span id="PhysioNetLoader-199"><a href="#PhysioNetLoader-199"><span class="linenos">199</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-200"><a href="#PhysioNetLoader-200"><span class="linenos">200</span></a>                
</span><span id="PhysioNetLoader-201"><a href="#PhysioNetLoader-201"><span class="linenos">201</span></a>                <span class="c1"># Add subject metadata</span>
</span><span id="PhysioNetLoader-202"><a href="#PhysioNetLoader-202"><span class="linenos">202</span></a>                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;subject_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subject_type</span>
</span><span id="PhysioNetLoader-203"><a href="#PhysioNetLoader-203"><span class="linenos">203</span></a>                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
</span><span id="PhysioNetLoader-204"><a href="#PhysioNetLoader-204"><span class="linenos">204</span></a>                
</span><span id="PhysioNetLoader-205"><a href="#PhysioNetLoader-205"><span class="linenos">205</span></a>                <span class="n">physionet_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="PhysioNetLoader-206"><a href="#PhysioNetLoader-206"><span class="linenos">206</span></a>                <span class="n">physionet_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="PhysioNetLoader-207"><a href="#PhysioNetLoader-207"><span class="linenos">207</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
</span><span id="PhysioNetLoader-208"><a href="#PhysioNetLoader-208"><span class="linenos">208</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">subject_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subject_type</span><span class="p">)</span>
</span><span id="PhysioNetLoader-209"><a href="#PhysioNetLoader-209"><span class="linenos">209</span></a>                
</span><span id="PhysioNetLoader-210"><a href="#PhysioNetLoader-210"><span class="linenos">210</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PhysioNetLoader-211"><a href="#PhysioNetLoader-211"><span class="linenos">211</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error loading </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-212"><a href="#PhysioNetLoader-212"><span class="linenos">212</span></a>                <span class="k">continue</span>
</span><span id="PhysioNetLoader-213"><a href="#PhysioNetLoader-213"><span class="linenos">213</span></a>        
</span><span id="PhysioNetLoader-214"><a href="#PhysioNetLoader-214"><span class="linenos">214</span></a>        <span class="c1"># Store loaded data</span>
</span><span id="PhysioNetLoader-215"><a href="#PhysioNetLoader-215"><span class="linenos">215</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">physionet_data</span>
</span><span id="PhysioNetLoader-216"><a href="#PhysioNetLoader-216"><span class="linenos">216</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">physionet_names</span>
</span><span id="PhysioNetLoader-217"><a href="#PhysioNetLoader-217"><span class="linenos">217</span></a>        
</span><span id="PhysioNetLoader-218"><a href="#PhysioNetLoader-218"><span class="linenos">218</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">physionet_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> PhysioNet files&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-219"><a href="#PhysioNetLoader-219"><span class="linenos">219</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Subject distribution: </span><span class="si">{</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subject_types</span><span class="p">,</span><span class="w"> </span><span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-220"><a href="#PhysioNetLoader-220"><span class="linenos">220</span></a>        
</span><span id="PhysioNetLoader-221"><a href="#PhysioNetLoader-221"><span class="linenos">221</span></a>        <span class="k">return</span> <span class="n">physionet_data</span><span class="p">,</span> <span class="n">physionet_names</span>
</span><span id="PhysioNetLoader-222"><a href="#PhysioNetLoader-222"><span class="linenos">222</span></a>    
</span><span id="PhysioNetLoader-223"><a href="#PhysioNetLoader-223"><span class="linenos">223</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_sliding_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> 
</span><span id="PhysioNetLoader-224"><a href="#PhysioNetLoader-224"><span class="linenos">224</span></a>                             <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">600</span><span class="p">,</span> <span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="PhysioNetLoader-225"><a href="#PhysioNetLoader-225"><span class="linenos">225</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-226"><a href="#PhysioNetLoader-226"><span class="linenos">226</span></a><span class="sd">        Create sliding windows from the PhysioNet dataset.</span>
</span><span id="PhysioNetLoader-227"><a href="#PhysioNetLoader-227"><span class="linenos">227</span></a><span class="sd">        </span>
</span><span id="PhysioNetLoader-228"><a href="#PhysioNetLoader-228"><span class="linenos">228</span></a><span class="sd">        Args:</span>
</span><span id="PhysioNetLoader-229"><a href="#PhysioNetLoader-229"><span class="linenos">229</span></a><span class="sd">            data: List of DataFrames containing PhysioNet data</span>
</span><span id="PhysioNetLoader-230"><a href="#PhysioNetLoader-230"><span class="linenos">230</span></a><span class="sd">            names: List of names corresponding to the data</span>
</span><span id="PhysioNetLoader-231"><a href="#PhysioNetLoader-231"><span class="linenos">231</span></a><span class="sd">            window_size: Size of the sliding window (default: 600 for 6 seconds at 100Hz)</span>
</span><span id="PhysioNetLoader-232"><a href="#PhysioNetLoader-232"><span class="linenos">232</span></a><span class="sd">            step_size: Step size for the sliding window (default: 100)</span>
</span><span id="PhysioNetLoader-233"><a href="#PhysioNetLoader-233"><span class="linenos">233</span></a><span class="sd">            </span>
</span><span id="PhysioNetLoader-234"><a href="#PhysioNetLoader-234"><span class="linenos">234</span></a><span class="sd">        Returns:</span>
</span><span id="PhysioNetLoader-235"><a href="#PhysioNetLoader-235"><span class="linenos">235</span></a><span class="sd">            List of dictionaries containing sliding windows for each DataFrame</span>
</span><span id="PhysioNetLoader-236"><a href="#PhysioNetLoader-236"><span class="linenos">236</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-237"><a href="#PhysioNetLoader-237"><span class="linenos">237</span></a>        <span class="n">windows_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PhysioNetLoader-238"><a href="#PhysioNetLoader-238"><span class="linenos">238</span></a>        
</span><span id="PhysioNetLoader-239"><a href="#PhysioNetLoader-239"><span class="linenos">239</span></a>        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span><span id="PhysioNetLoader-240"><a href="#PhysioNetLoader-240"><span class="linenos">240</span></a>            <span class="c1"># Remove metadata columns for windowing</span>
</span><span id="PhysioNetLoader-241"><a href="#PhysioNetLoader-241"><span class="linenos">241</span></a>            <span class="n">sensor_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;VGRF_&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;sensor_&#39;</span><span class="p">)]</span>
</span><span id="PhysioNetLoader-242"><a href="#PhysioNetLoader-242"><span class="linenos">242</span></a>            <span class="n">df_sensors</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">sensor_columns</span><span class="p">]</span>
</span><span id="PhysioNetLoader-243"><a href="#PhysioNetLoader-243"><span class="linenos">243</span></a>            
</span><span id="PhysioNetLoader-244"><a href="#PhysioNetLoader-244"><span class="linenos">244</span></a>            <span class="k">if</span> <span class="n">df_sensors</span><span class="o">.</span><span class="n">empty</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_sensors</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">window_size</span><span class="p">:</span>
</span><span id="PhysioNetLoader-245"><a href="#PhysioNetLoader-245"><span class="linenos">245</span></a>                <span class="k">continue</span>
</span><span id="PhysioNetLoader-246"><a href="#PhysioNetLoader-246"><span class="linenos">246</span></a>                
</span><span id="PhysioNetLoader-247"><a href="#PhysioNetLoader-247"><span class="linenos">247</span></a>            <span class="n">windows</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PhysioNetLoader-248"><a href="#PhysioNetLoader-248"><span class="linenos">248</span></a>            
</span><span id="PhysioNetLoader-249"><a href="#PhysioNetLoader-249"><span class="linenos">249</span></a>            <span class="c1"># Create windows for each sensor</span>
</span><span id="PhysioNetLoader-250"><a href="#PhysioNetLoader-250"><span class="linenos">250</span></a>            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">sensor_columns</span><span class="p">:</span>
</span><span id="PhysioNetLoader-251"><a href="#PhysioNetLoader-251"><span class="linenos">251</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="PhysioNetLoader-252"><a href="#PhysioNetLoader-252"><span class="linenos">252</span></a>                    <span class="n">window_data</span> <span class="o">=</span> <span class="n">sliding_window</span><span class="p">(</span><span class="n">df_sensors</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span><span id="PhysioNetLoader-253"><a href="#PhysioNetLoader-253"><span class="linenos">253</span></a>                    <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">col</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">window_data</span><span class="p">})</span>
</span><span id="PhysioNetLoader-254"><a href="#PhysioNetLoader-254"><span class="linenos">254</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PhysioNetLoader-255"><a href="#PhysioNetLoader-255"><span class="linenos">255</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error creating windows for </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">names</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-256"><a href="#PhysioNetLoader-256"><span class="linenos">256</span></a>                    <span class="k">continue</span>
</span><span id="PhysioNetLoader-257"><a href="#PhysioNetLoader-257"><span class="linenos">257</span></a>            
</span><span id="PhysioNetLoader-258"><a href="#PhysioNetLoader-258"><span class="linenos">258</span></a>            <span class="k">if</span> <span class="n">windows</span><span class="p">:</span>
</span><span id="PhysioNetLoader-259"><a href="#PhysioNetLoader-259"><span class="linenos">259</span></a>                <span class="n">windows_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="PhysioNetLoader-260"><a href="#PhysioNetLoader-260"><span class="linenos">260</span></a>                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="PhysioNetLoader-261"><a href="#PhysioNetLoader-261"><span class="linenos">261</span></a>                    <span class="s2">&quot;windows&quot;</span><span class="p">:</span> <span class="n">windows</span><span class="p">,</span>
</span><span id="PhysioNetLoader-262"><a href="#PhysioNetLoader-262"><span class="linenos">262</span></a>                    <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="PhysioNetLoader-263"><a href="#PhysioNetLoader-263"><span class="linenos">263</span></a>                        <span class="s2">&quot;subject_type&quot;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;subject_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;subject_type&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">else</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">,</span>
</span><span id="PhysioNetLoader-264"><a href="#PhysioNetLoader-264"><span class="linenos">264</span></a>                        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;label&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">else</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">,</span>
</span><span id="PhysioNetLoader-265"><a href="#PhysioNetLoader-265"><span class="linenos">265</span></a>                        <span class="s2">&quot;window_size&quot;</span><span class="p">:</span> <span class="n">window_size</span><span class="p">,</span>
</span><span id="PhysioNetLoader-266"><a href="#PhysioNetLoader-266"><span class="linenos">266</span></a>                        <span class="s2">&quot;step_size&quot;</span><span class="p">:</span> <span class="n">step_size</span><span class="p">,</span>
</span><span id="PhysioNetLoader-267"><a href="#PhysioNetLoader-267"><span class="linenos">267</span></a>                        <span class="s2">&quot;num_windows&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">windows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;data&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="n">windows</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="PhysioNetLoader-268"><a href="#PhysioNetLoader-268"><span class="linenos">268</span></a>                    <span class="p">}</span>
</span><span id="PhysioNetLoader-269"><a href="#PhysioNetLoader-269"><span class="linenos">269</span></a>                <span class="p">})</span>
</span><span id="PhysioNetLoader-270"><a href="#PhysioNetLoader-270"><span class="linenos">270</span></a>        
</span><span id="PhysioNetLoader-271"><a href="#PhysioNetLoader-271"><span class="linenos">271</span></a>        <span class="k">return</span> <span class="n">windows_data</span>
</span><span id="PhysioNetLoader-272"><a href="#PhysioNetLoader-272"><span class="linenos">272</span></a>    
</span><span id="PhysioNetLoader-273"><a href="#PhysioNetLoader-273"><span class="linenos">273</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_supported_formats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PhysioNetLoader-274"><a href="#PhysioNetLoader-274"><span class="linenos">274</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-275"><a href="#PhysioNetLoader-275"><span class="linenos">275</span></a><span class="sd">        Get list of supported file formats for PhysioNet dataset.</span>
</span><span id="PhysioNetLoader-276"><a href="#PhysioNetLoader-276"><span class="linenos">276</span></a><span class="sd">        </span>
</span><span id="PhysioNetLoader-277"><a href="#PhysioNetLoader-277"><span class="linenos">277</span></a><span class="sd">        Returns:</span>
</span><span id="PhysioNetLoader-278"><a href="#PhysioNetLoader-278"><span class="linenos">278</span></a><span class="sd">            List of supported file extensions</span>
</span><span id="PhysioNetLoader-279"><a href="#PhysioNetLoader-279"><span class="linenos">279</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-280"><a href="#PhysioNetLoader-280"><span class="linenos">280</span></a>        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;.txt&#39;</span><span class="p">]</span>
</span><span id="PhysioNetLoader-281"><a href="#PhysioNetLoader-281"><span class="linenos">281</span></a>    
</span><span id="PhysioNetLoader-282"><a href="#PhysioNetLoader-282"><span class="linenos">282</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sensor_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="PhysioNetLoader-283"><a href="#PhysioNetLoader-283"><span class="linenos">283</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-284"><a href="#PhysioNetLoader-284"><span class="linenos">284</span></a><span class="sd">        Get information about sensors in the dataset.</span>
</span><span id="PhysioNetLoader-285"><a href="#PhysioNetLoader-285"><span class="linenos">285</span></a><span class="sd">        </span>
</span><span id="PhysioNetLoader-286"><a href="#PhysioNetLoader-286"><span class="linenos">286</span></a><span class="sd">        Returns:</span>
</span><span id="PhysioNetLoader-287"><a href="#PhysioNetLoader-287"><span class="linenos">287</span></a><span class="sd">            Dictionary containing sensor information</span>
</span><span id="PhysioNetLoader-288"><a href="#PhysioNetLoader-288"><span class="linenos">288</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-289"><a href="#PhysioNetLoader-289"><span class="linenos">289</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="PhysioNetLoader-290"><a href="#PhysioNetLoader-290"><span class="linenos">290</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sensors&#39;</span><span class="p">],</span>
</span><span id="PhysioNetLoader-291"><a href="#PhysioNetLoader-291"><span class="linenos">291</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sampling_frequency&#39;</span><span class="p">],</span>
</span><span id="PhysioNetLoader-292"><a href="#PhysioNetLoader-292"><span class="linenos">292</span></a>            <span class="s1">&#39;window_size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;window_size&#39;</span><span class="p">]</span>
</span><span id="PhysioNetLoader-293"><a href="#PhysioNetLoader-293"><span class="linenos">293</span></a>        <span class="p">}</span>
</span><span id="PhysioNetLoader-294"><a href="#PhysioNetLoader-294"><span class="linenos">294</span></a>    
</span><span id="PhysioNetLoader-295"><a href="#PhysioNetLoader-295"><span class="linenos">295</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_subject_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="PhysioNetLoader-296"><a href="#PhysioNetLoader-296"><span class="linenos">296</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-297"><a href="#PhysioNetLoader-297"><span class="linenos">297</span></a><span class="sd">        Get information about subjects in the dataset.</span>
</span><span id="PhysioNetLoader-298"><a href="#PhysioNetLoader-298"><span class="linenos">298</span></a><span class="sd">        </span>
</span><span id="PhysioNetLoader-299"><a href="#PhysioNetLoader-299"><span class="linenos">299</span></a><span class="sd">        Returns:</span>
</span><span id="PhysioNetLoader-300"><a href="#PhysioNetLoader-300"><span class="linenos">300</span></a><span class="sd">            Dictionary containing subject information</span>
</span><span id="PhysioNetLoader-301"><a href="#PhysioNetLoader-301"><span class="linenos">301</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-302"><a href="#PhysioNetLoader-302"><span class="linenos">302</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;subjects&#39;</span><span class="p">]</span>
</span><span id="PhysioNetLoader-303"><a href="#PhysioNetLoader-303"><span class="linenos">303</span></a>    
</span><span id="PhysioNetLoader-304"><a href="#PhysioNetLoader-304"><span class="linenos">304</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PhysioNetLoader-305"><a href="#PhysioNetLoader-305"><span class="linenos">305</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-306"><a href="#PhysioNetLoader-306"><span class="linenos">306</span></a><span class="sd">        Get labels for loaded data.</span>
</span><span id="PhysioNetLoader-307"><a href="#PhysioNetLoader-307"><span class="linenos">307</span></a><span class="sd">        </span>
</span><span id="PhysioNetLoader-308"><a href="#PhysioNetLoader-308"><span class="linenos">308</span></a><span class="sd">        Returns:</span>
</span><span id="PhysioNetLoader-309"><a href="#PhysioNetLoader-309"><span class="linenos">309</span></a><span class="sd">            List of labels corresponding to loaded data</span>
</span><span id="PhysioNetLoader-310"><a href="#PhysioNetLoader-310"><span class="linenos">310</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-311"><a href="#PhysioNetLoader-311"><span class="linenos">311</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span>
</span><span id="PhysioNetLoader-312"><a href="#PhysioNetLoader-312"><span class="linenos">312</span></a>    
</span><span id="PhysioNetLoader-313"><a href="#PhysioNetLoader-313"><span class="linenos">313</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">filter_by_subject_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subject_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="PhysioNetLoader-314"><a href="#PhysioNetLoader-314"><span class="linenos">314</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-315"><a href="#PhysioNetLoader-315"><span class="linenos">315</span></a><span class="sd">        Filter loaded data by subject type.</span>
</span><span id="PhysioNetLoader-316"><a href="#PhysioNetLoader-316"><span class="linenos">316</span></a><span class="sd">        </span>
</span><span id="PhysioNetLoader-317"><a href="#PhysioNetLoader-317"><span class="linenos">317</span></a><span class="sd">        Args:</span>
</span><span id="PhysioNetLoader-318"><a href="#PhysioNetLoader-318"><span class="linenos">318</span></a><span class="sd">            subject_type: &#39;Control&#39; or &#39;Patient&#39;</span>
</span><span id="PhysioNetLoader-319"><a href="#PhysioNetLoader-319"><span class="linenos">319</span></a><span class="sd">            </span>
</span><span id="PhysioNetLoader-320"><a href="#PhysioNetLoader-320"><span class="linenos">320</span></a><span class="sd">        Returns:</span>
</span><span id="PhysioNetLoader-321"><a href="#PhysioNetLoader-321"><span class="linenos">321</span></a><span class="sd">            Tuple of (filtered_data, filtered_names)</span>
</span><span id="PhysioNetLoader-322"><a href="#PhysioNetLoader-322"><span class="linenos">322</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader-323"><a href="#PhysioNetLoader-323"><span class="linenos">323</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
</span><span id="PhysioNetLoader-324"><a href="#PhysioNetLoader-324"><span class="linenos">324</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No data loaded. Call load_data() first.&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader-325"><a href="#PhysioNetLoader-325"><span class="linenos">325</span></a>        
</span><span id="PhysioNetLoader-326"><a href="#PhysioNetLoader-326"><span class="linenos">326</span></a>        <span class="n">filtered_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PhysioNetLoader-327"><a href="#PhysioNetLoader-327"><span class="linenos">327</span></a>        <span class="n">filtered_names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PhysioNetLoader-328"><a href="#PhysioNetLoader-328"><span class="linenos">328</span></a>        
</span><span id="PhysioNetLoader-329"><a href="#PhysioNetLoader-329"><span class="linenos">329</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
</span><span id="PhysioNetLoader-330"><a href="#PhysioNetLoader-330"><span class="linenos">330</span></a>            <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;subject_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">subject_type</span><span class="p">:</span>
</span><span id="PhysioNetLoader-331"><a href="#PhysioNetLoader-331"><span class="linenos">331</span></a>                <span class="n">filtered_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="PhysioNetLoader-332"><a href="#PhysioNetLoader-332"><span class="linenos">332</span></a>                <span class="n">filtered_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="PhysioNetLoader-333"><a href="#PhysioNetLoader-333"><span class="linenos">333</span></a>        
</span><span id="PhysioNetLoader-334"><a href="#PhysioNetLoader-334"><span class="linenos">334</span></a>        <span class="k">return</span> <span class="n">filtered_data</span><span class="p">,</span> <span class="n">filtered_names</span>
</span></pre></div>


            <div class="docstring"><p>PhysioNet VGRF dataset loader class.</p>

<p>This class handles loading and processing of the PhysioNet Gait in Parkinson's Disease dataset.
The dataset contains vertical ground reaction force (VGRF) data from subjects with Parkinson's 
disease and healthy controls.</p>

<p>Features concurrent downloading for efficient data retrieval.</p>
</div>


                            <div id="PhysioNetLoader.__init__" class="classattr">
                                        <input id="PhysioNetLoader.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">PhysioNetLoader</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span></span>)</span>

                <label class="view-source-button" for="PhysioNetLoader.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PhysioNetLoader.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PhysioNetLoader.__init__-36"><a href="#PhysioNetLoader.__init__-36"><span class="linenos">36</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">):</span>
</span><span id="PhysioNetLoader.__init__-37"><a href="#PhysioNetLoader.__init__-37"><span class="linenos">37</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader.__init__-38"><a href="#PhysioNetLoader.__init__-38"><span class="linenos">38</span></a><span class="sd">        Initialize PhysioNet loader with concurrent download support.</span>
</span><span id="PhysioNetLoader.__init__-39"><a href="#PhysioNetLoader.__init__-39"><span class="linenos">39</span></a><span class="sd">        </span>
</span><span id="PhysioNetLoader.__init__-40"><a href="#PhysioNetLoader.__init__-40"><span class="linenos">40</span></a><span class="sd">        Args:</span>
</span><span id="PhysioNetLoader.__init__-41"><a href="#PhysioNetLoader.__init__-41"><span class="linenos">41</span></a><span class="sd">            max_workers: Maximum number of concurrent download threads (default: 8)</span>
</span><span id="PhysioNetLoader.__init__-42"><a href="#PhysioNetLoader.__init__-42"><span class="linenos">42</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader.__init__-43"><a href="#PhysioNetLoader.__init__-43"><span class="linenos">43</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="PhysioNetLoader.__init__-44"><a href="#PhysioNetLoader.__init__-44"><span class="linenos">44</span></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;physionet&quot;</span><span class="p">,</span>
</span><span id="PhysioNetLoader.__init__-45"><a href="#PhysioNetLoader.__init__-45"><span class="linenos">45</span></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;PhysioNet Gait in Parkinson&#39;s Disease Dataset - Contains VGRF data from subjects with Parkinson&#39;s disease and healthy controls&quot;</span><span class="p">,</span>
</span><span id="PhysioNetLoader.__init__-46"><a href="#PhysioNetLoader.__init__-46"><span class="linenos">46</span></a>            <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span>
</span><span id="PhysioNetLoader.__init__-47"><a href="#PhysioNetLoader.__init__-47"><span class="linenos">47</span></a>        <span class="p">)</span>
</span><span id="PhysioNetLoader.__init__-48"><a href="#PhysioNetLoader.__init__-48"><span class="linenos">48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PhysioNetLoader.__init__-49"><a href="#PhysioNetLoader.__init__-49"><span class="linenos">49</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;VGRF_L1&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_L2&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_L3&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_L4&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_L5&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_L6&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_L7&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_L8&#39;</span><span class="p">,</span>
</span><span id="PhysioNetLoader.__init__-50"><a href="#PhysioNetLoader.__init__-50"><span class="linenos">50</span></a>                       <span class="s1">&#39;VGRF_R1&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_R2&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_R3&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_R4&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_R5&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_R6&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_R7&#39;</span><span class="p">,</span> <span class="s1">&#39;VGRF_R8&#39;</span><span class="p">],</span>
</span><span id="PhysioNetLoader.__init__-51"><a href="#PhysioNetLoader.__init__-51"><span class="linenos">51</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>  <span class="c1"># 100 Hz sampling frequency</span>
</span><span id="PhysioNetLoader.__init__-52"><a href="#PhysioNetLoader.__init__-52"><span class="linenos">52</span></a>            <span class="s1">&#39;subjects&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="PhysioNetLoader.__init__-53"><a href="#PhysioNetLoader.__init__-53"><span class="linenos">53</span></a>                <span class="s1">&#39;Co&#39;</span><span class="p">:</span> <span class="s1">&#39;Control subjects&#39;</span><span class="p">,</span>
</span><span id="PhysioNetLoader.__init__-54"><a href="#PhysioNetLoader.__init__-54"><span class="linenos">54</span></a>                <span class="s1">&#39;Pt&#39;</span><span class="p">:</span> <span class="s1">&#39;Parkinson</span><span class="se">\&#39;</span><span class="s1">s disease patients&#39;</span>
</span><span id="PhysioNetLoader.__init__-55"><a href="#PhysioNetLoader.__init__-55"><span class="linenos">55</span></a>            <span class="p">},</span>
</span><span id="PhysioNetLoader.__init__-56"><a href="#PhysioNetLoader.__init__-56"><span class="linenos">56</span></a>            <span class="s1">&#39;window_size&#39;</span><span class="p">:</span> <span class="mi">600</span><span class="p">,</span>  <span class="c1"># 6 seconds at 100 Hz</span>
</span><span id="PhysioNetLoader.__init__-57"><a href="#PhysioNetLoader.__init__-57"><span class="linenos">57</span></a>            <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://physionet.org/files/gaitpdb/1.0.0/&#39;</span>
</span><span id="PhysioNetLoader.__init__-58"><a href="#PhysioNetLoader.__init__-58"><span class="linenos">58</span></a>        <span class="p">}</span>
</span><span id="PhysioNetLoader.__init__-59"><a href="#PhysioNetLoader.__init__-59"><span class="linenos">59</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PhysioNetLoader.__init__-60"><a href="#PhysioNetLoader.__init__-60"><span class="linenos">60</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subject_types</span> <span class="o">=</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Initialize PhysioNet loader with concurrent download support.</p>

<p>Args:
    max_workers: Maximum number of concurrent download threads (default: 8)</p>
</div>


                            </div>
                            <div id="PhysioNetLoader.metadata" class="classattr">
                                <div class="attr variable">
            <span class="name">metadata</span>

        
    </div>
    <a class="headerlink" href="#PhysioNetLoader.metadata"></a>
    
    

                            </div>
                            <div id="PhysioNetLoader.labels" class="classattr">
                                <div class="attr variable">
            <span class="name">labels</span>

        
    </div>
    <a class="headerlink" href="#PhysioNetLoader.labels"></a>
    
    

                            </div>
                            <div id="PhysioNetLoader.subject_types" class="classattr">
                                <div class="attr variable">
            <span class="name">subject_types</span>

        
    </div>
    <a class="headerlink" href="#PhysioNetLoader.subject_types"></a>
    
    

                            </div>
                            <div id="PhysioNetLoader.load_data" class="classattr">
                                        <input id="PhysioNetLoader.load_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_data</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="PhysioNetLoader.load_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PhysioNetLoader.load_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PhysioNetLoader.load_data-144"><a href="#PhysioNetLoader.load_data-144"><span class="linenos">144</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="PhysioNetLoader.load_data-145"><a href="#PhysioNetLoader.load_data-145"><span class="linenos">145</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader.load_data-146"><a href="#PhysioNetLoader.load_data-146"><span class="linenos">146</span></a><span class="sd">        Load PhysioNet VGRF dataset from the specified directory.</span>
</span><span id="PhysioNetLoader.load_data-147"><a href="#PhysioNetLoader.load_data-147"><span class="linenos">147</span></a><span class="sd">        </span>
</span><span id="PhysioNetLoader.load_data-148"><a href="#PhysioNetLoader.load_data-148"><span class="linenos">148</span></a><span class="sd">        Args:</span>
</span><span id="PhysioNetLoader.load_data-149"><a href="#PhysioNetLoader.load_data-149"><span class="linenos">149</span></a><span class="sd">            data_dir: Directory to store/find the dataset</span>
</span><span id="PhysioNetLoader.load_data-150"><a href="#PhysioNetLoader.load_data-150"><span class="linenos">150</span></a><span class="sd">            **kwargs: Additional arguments (unused for PhysioNet)</span>
</span><span id="PhysioNetLoader.load_data-151"><a href="#PhysioNetLoader.load_data-151"><span class="linenos">151</span></a><span class="sd">            </span>
</span><span id="PhysioNetLoader.load_data-152"><a href="#PhysioNetLoader.load_data-152"><span class="linenos">152</span></a><span class="sd">        Returns:</span>
</span><span id="PhysioNetLoader.load_data-153"><a href="#PhysioNetLoader.load_data-153"><span class="linenos">153</span></a><span class="sd">            Tuple of (data_list, names_list)</span>
</span><span id="PhysioNetLoader.load_data-154"><a href="#PhysioNetLoader.load_data-154"><span class="linenos">154</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader.load_data-155"><a href="#PhysioNetLoader.load_data-155"><span class="linenos">155</span></a>        <span class="c1"># Download dataset if needed</span>
</span><span id="PhysioNetLoader.load_data-156"><a href="#PhysioNetLoader.load_data-156"><span class="linenos">156</span></a>        <span class="n">dataset_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_download_physionet_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</span><span id="PhysioNetLoader.load_data-157"><a href="#PhysioNetLoader.load_data-157"><span class="linenos">157</span></a>        
</span><span id="PhysioNetLoader.load_data-158"><a href="#PhysioNetLoader.load_data-158"><span class="linenos">158</span></a>        <span class="n">physionet_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PhysioNetLoader.load_data-159"><a href="#PhysioNetLoader.load_data-159"><span class="linenos">159</span></a>        <span class="n">physionet_names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PhysioNetLoader.load_data-160"><a href="#PhysioNetLoader.load_data-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PhysioNetLoader.load_data-161"><a href="#PhysioNetLoader.load_data-161"><span class="linenos">161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subject_types</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PhysioNetLoader.load_data-162"><a href="#PhysioNetLoader.load_data-162"><span class="linenos">162</span></a>        
</span><span id="PhysioNetLoader.load_data-163"><a href="#PhysioNetLoader.load_data-163"><span class="linenos">163</span></a>        <span class="c1"># Load all available files</span>
</span><span id="PhysioNetLoader.load_data-164"><a href="#PhysioNetLoader.load_data-164"><span class="linenos">164</span></a>        <span class="k">for</span> <span class="n">filepath</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dataset_path</span><span class="p">,</span> <span class="s2">&quot;Ga*.txt&quot;</span><span class="p">))):</span>
</span><span id="PhysioNetLoader.load_data-165"><a href="#PhysioNetLoader.load_data-165"><span class="linenos">165</span></a>            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
</span><span id="PhysioNetLoader.load_data-166"><a href="#PhysioNetLoader.load_data-166"><span class="linenos">166</span></a>            
</span><span id="PhysioNetLoader.load_data-167"><a href="#PhysioNetLoader.load_data-167"><span class="linenos">167</span></a>            <span class="c1"># Extract subject type from filename</span>
</span><span id="PhysioNetLoader.load_data-168"><a href="#PhysioNetLoader.load_data-168"><span class="linenos">168</span></a>            <span class="k">if</span> <span class="s1">&#39;Co&#39;</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">:</span>
</span><span id="PhysioNetLoader.load_data-169"><a href="#PhysioNetLoader.load_data-169"><span class="linenos">169</span></a>                <span class="n">subject_type</span> <span class="o">=</span> <span class="s1">&#39;Control&#39;</span>
</span><span id="PhysioNetLoader.load_data-170"><a href="#PhysioNetLoader.load_data-170"><span class="linenos">170</span></a>                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Co&#39;</span>
</span><span id="PhysioNetLoader.load_data-171"><a href="#PhysioNetLoader.load_data-171"><span class="linenos">171</span></a>            <span class="k">elif</span> <span class="s1">&#39;Pt&#39;</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">:</span>
</span><span id="PhysioNetLoader.load_data-172"><a href="#PhysioNetLoader.load_data-172"><span class="linenos">172</span></a>                <span class="n">subject_type</span> <span class="o">=</span> <span class="s1">&#39;Patient&#39;</span>
</span><span id="PhysioNetLoader.load_data-173"><a href="#PhysioNetLoader.load_data-173"><span class="linenos">173</span></a>                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Pt&#39;</span>
</span><span id="PhysioNetLoader.load_data-174"><a href="#PhysioNetLoader.load_data-174"><span class="linenos">174</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PhysioNetLoader.load_data-175"><a href="#PhysioNetLoader.load_data-175"><span class="linenos">175</span></a>                <span class="k">continue</span>  <span class="c1"># Skip files that don&#39;t match expected pattern</span>
</span><span id="PhysioNetLoader.load_data-176"><a href="#PhysioNetLoader.load_data-176"><span class="linenos">176</span></a>            
</span><span id="PhysioNetLoader.load_data-177"><a href="#PhysioNetLoader.load_data-177"><span class="linenos">177</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PhysioNetLoader.load_data-178"><a href="#PhysioNetLoader.load_data-178"><span class="linenos">178</span></a>                <span class="c1"># Read the file - PhysioNet files are tab-delimited with variable columns</span>
</span><span id="PhysioNetLoader.load_data-179"><a href="#PhysioNetLoader.load_data-179"><span class="linenos">179</span></a>                <span class="c1"># Column 0: time, Columns 1-16: VGRF sensors, additional columns may exist</span>
</span><span id="PhysioNetLoader.load_data-180"><a href="#PhysioNetLoader.load_data-180"><span class="linenos">180</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="PhysioNetLoader.load_data-181"><a href="#PhysioNetLoader.load_data-181"><span class="linenos">181</span></a>                
</span><span id="PhysioNetLoader.load_data-182"><a href="#PhysioNetLoader.load_data-182"><span class="linenos">182</span></a>                <span class="c1"># Handle variable number of columns</span>
</span><span id="PhysioNetLoader.load_data-183"><a href="#PhysioNetLoader.load_data-183"><span class="linenos">183</span></a>                <span class="n">n_cols</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">19</span><span class="p">)</span>  <span class="c1"># Limit to 19 columns max</span>
</span><span id="PhysioNetLoader.load_data-184"><a href="#PhysioNetLoader.load_data-184"><span class="linenos">184</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="n">n_cols</span><span class="p">]</span>
</span><span id="PhysioNetLoader.load_data-185"><a href="#PhysioNetLoader.load_data-185"><span class="linenos">185</span></a>                
</span><span id="PhysioNetLoader.load_data-186"><a href="#PhysioNetLoader.load_data-186"><span class="linenos">186</span></a>                <span class="c1"># Create column names</span>
</span><span id="PhysioNetLoader.load_data-187"><a href="#PhysioNetLoader.load_data-187"><span class="linenos">187</span></a>                <span class="n">col_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>
</span><span id="PhysioNetLoader.load_data-188"><a href="#PhysioNetLoader.load_data-188"><span class="linenos">188</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">):</span>
</span><span id="PhysioNetLoader.load_data-189"><a href="#PhysioNetLoader.load_data-189"><span class="linenos">189</span></a>                    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="PhysioNetLoader.load_data-190"><a href="#PhysioNetLoader.load_data-190"><span class="linenos">190</span></a>                        <span class="n">col_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;VGRF_L</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="PhysioNetLoader.load_data-191"><a href="#PhysioNetLoader.load_data-191"><span class="linenos">191</span></a>                    <span class="k">elif</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">16</span><span class="p">:</span>
</span><span id="PhysioNetLoader.load_data-192"><a href="#PhysioNetLoader.load_data-192"><span class="linenos">192</span></a>                        <span class="n">col_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;VGRF_R</span><span class="si">{</span><span class="n">i</span><span class="o">-</span><span class="mi">8</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="PhysioNetLoader.load_data-193"><a href="#PhysioNetLoader.load_data-193"><span class="linenos">193</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="PhysioNetLoader.load_data-194"><a href="#PhysioNetLoader.load_data-194"><span class="linenos">194</span></a>                        <span class="n">col_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;sensor_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="PhysioNetLoader.load_data-195"><a href="#PhysioNetLoader.load_data-195"><span class="linenos">195</span></a>                
</span><span id="PhysioNetLoader.load_data-196"><a href="#PhysioNetLoader.load_data-196"><span class="linenos">196</span></a>                <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">col_names</span>
</span><span id="PhysioNetLoader.load_data-197"><a href="#PhysioNetLoader.load_data-197"><span class="linenos">197</span></a>                
</span><span id="PhysioNetLoader.load_data-198"><a href="#PhysioNetLoader.load_data-198"><span class="linenos">198</span></a>                <span class="c1"># Set time as index</span>
</span><span id="PhysioNetLoader.load_data-199"><a href="#PhysioNetLoader.load_data-199"><span class="linenos">199</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</span><span id="PhysioNetLoader.load_data-200"><a href="#PhysioNetLoader.load_data-200"><span class="linenos">200</span></a>                
</span><span id="PhysioNetLoader.load_data-201"><a href="#PhysioNetLoader.load_data-201"><span class="linenos">201</span></a>                <span class="c1"># Add subject metadata</span>
</span><span id="PhysioNetLoader.load_data-202"><a href="#PhysioNetLoader.load_data-202"><span class="linenos">202</span></a>                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;subject_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subject_type</span>
</span><span id="PhysioNetLoader.load_data-203"><a href="#PhysioNetLoader.load_data-203"><span class="linenos">203</span></a>                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
</span><span id="PhysioNetLoader.load_data-204"><a href="#PhysioNetLoader.load_data-204"><span class="linenos">204</span></a>                
</span><span id="PhysioNetLoader.load_data-205"><a href="#PhysioNetLoader.load_data-205"><span class="linenos">205</span></a>                <span class="n">physionet_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="PhysioNetLoader.load_data-206"><a href="#PhysioNetLoader.load_data-206"><span class="linenos">206</span></a>                <span class="n">physionet_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="PhysioNetLoader.load_data-207"><a href="#PhysioNetLoader.load_data-207"><span class="linenos">207</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
</span><span id="PhysioNetLoader.load_data-208"><a href="#PhysioNetLoader.load_data-208"><span class="linenos">208</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">subject_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subject_type</span><span class="p">)</span>
</span><span id="PhysioNetLoader.load_data-209"><a href="#PhysioNetLoader.load_data-209"><span class="linenos">209</span></a>                
</span><span id="PhysioNetLoader.load_data-210"><a href="#PhysioNetLoader.load_data-210"><span class="linenos">210</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PhysioNetLoader.load_data-211"><a href="#PhysioNetLoader.load_data-211"><span class="linenos">211</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error loading </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader.load_data-212"><a href="#PhysioNetLoader.load_data-212"><span class="linenos">212</span></a>                <span class="k">continue</span>
</span><span id="PhysioNetLoader.load_data-213"><a href="#PhysioNetLoader.load_data-213"><span class="linenos">213</span></a>        
</span><span id="PhysioNetLoader.load_data-214"><a href="#PhysioNetLoader.load_data-214"><span class="linenos">214</span></a>        <span class="c1"># Store loaded data</span>
</span><span id="PhysioNetLoader.load_data-215"><a href="#PhysioNetLoader.load_data-215"><span class="linenos">215</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">physionet_data</span>
</span><span id="PhysioNetLoader.load_data-216"><a href="#PhysioNetLoader.load_data-216"><span class="linenos">216</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">physionet_names</span>
</span><span id="PhysioNetLoader.load_data-217"><a href="#PhysioNetLoader.load_data-217"><span class="linenos">217</span></a>        
</span><span id="PhysioNetLoader.load_data-218"><a href="#PhysioNetLoader.load_data-218"><span class="linenos">218</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">physionet_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> PhysioNet files&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader.load_data-219"><a href="#PhysioNetLoader.load_data-219"><span class="linenos">219</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Subject distribution: </span><span class="si">{</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subject_types</span><span class="p">,</span><span class="w"> </span><span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader.load_data-220"><a href="#PhysioNetLoader.load_data-220"><span class="linenos">220</span></a>        
</span><span id="PhysioNetLoader.load_data-221"><a href="#PhysioNetLoader.load_data-221"><span class="linenos">221</span></a>        <span class="k">return</span> <span class="n">physionet_data</span><span class="p">,</span> <span class="n">physionet_names</span>
</span></pre></div>


            <div class="docstring"><p>Load PhysioNet VGRF dataset from the specified directory.</p>

<p>Args:
    data_dir: Directory to store/find the dataset
    **kwargs: Additional arguments (unused for PhysioNet)</p>

<p>Returns:
    Tuple of (data_list, names_list)</p>
</div>


                            </div>
                            <div id="PhysioNetLoader.create_sliding_windows" class="classattr">
                                        <input id="PhysioNetLoader.create_sliding_windows-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_sliding_windows</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>,</span><span class="param">	<span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">600</span>,</span><span class="param">	<span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PhysioNetLoader.create_sliding_windows-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PhysioNetLoader.create_sliding_windows"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PhysioNetLoader.create_sliding_windows-223"><a href="#PhysioNetLoader.create_sliding_windows-223"><span class="linenos">223</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_sliding_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> 
</span><span id="PhysioNetLoader.create_sliding_windows-224"><a href="#PhysioNetLoader.create_sliding_windows-224"><span class="linenos">224</span></a>                             <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">600</span><span class="p">,</span> <span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="PhysioNetLoader.create_sliding_windows-225"><a href="#PhysioNetLoader.create_sliding_windows-225"><span class="linenos">225</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader.create_sliding_windows-226"><a href="#PhysioNetLoader.create_sliding_windows-226"><span class="linenos">226</span></a><span class="sd">        Create sliding windows from the PhysioNet dataset.</span>
</span><span id="PhysioNetLoader.create_sliding_windows-227"><a href="#PhysioNetLoader.create_sliding_windows-227"><span class="linenos">227</span></a><span class="sd">        </span>
</span><span id="PhysioNetLoader.create_sliding_windows-228"><a href="#PhysioNetLoader.create_sliding_windows-228"><span class="linenos">228</span></a><span class="sd">        Args:</span>
</span><span id="PhysioNetLoader.create_sliding_windows-229"><a href="#PhysioNetLoader.create_sliding_windows-229"><span class="linenos">229</span></a><span class="sd">            data: List of DataFrames containing PhysioNet data</span>
</span><span id="PhysioNetLoader.create_sliding_windows-230"><a href="#PhysioNetLoader.create_sliding_windows-230"><span class="linenos">230</span></a><span class="sd">            names: List of names corresponding to the data</span>
</span><span id="PhysioNetLoader.create_sliding_windows-231"><a href="#PhysioNetLoader.create_sliding_windows-231"><span class="linenos">231</span></a><span class="sd">            window_size: Size of the sliding window (default: 600 for 6 seconds at 100Hz)</span>
</span><span id="PhysioNetLoader.create_sliding_windows-232"><a href="#PhysioNetLoader.create_sliding_windows-232"><span class="linenos">232</span></a><span class="sd">            step_size: Step size for the sliding window (default: 100)</span>
</span><span id="PhysioNetLoader.create_sliding_windows-233"><a href="#PhysioNetLoader.create_sliding_windows-233"><span class="linenos">233</span></a><span class="sd">            </span>
</span><span id="PhysioNetLoader.create_sliding_windows-234"><a href="#PhysioNetLoader.create_sliding_windows-234"><span class="linenos">234</span></a><span class="sd">        Returns:</span>
</span><span id="PhysioNetLoader.create_sliding_windows-235"><a href="#PhysioNetLoader.create_sliding_windows-235"><span class="linenos">235</span></a><span class="sd">            List of dictionaries containing sliding windows for each DataFrame</span>
</span><span id="PhysioNetLoader.create_sliding_windows-236"><a href="#PhysioNetLoader.create_sliding_windows-236"><span class="linenos">236</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader.create_sliding_windows-237"><a href="#PhysioNetLoader.create_sliding_windows-237"><span class="linenos">237</span></a>        <span class="n">windows_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PhysioNetLoader.create_sliding_windows-238"><a href="#PhysioNetLoader.create_sliding_windows-238"><span class="linenos">238</span></a>        
</span><span id="PhysioNetLoader.create_sliding_windows-239"><a href="#PhysioNetLoader.create_sliding_windows-239"><span class="linenos">239</span></a>        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span><span id="PhysioNetLoader.create_sliding_windows-240"><a href="#PhysioNetLoader.create_sliding_windows-240"><span class="linenos">240</span></a>            <span class="c1"># Remove metadata columns for windowing</span>
</span><span id="PhysioNetLoader.create_sliding_windows-241"><a href="#PhysioNetLoader.create_sliding_windows-241"><span class="linenos">241</span></a>            <span class="n">sensor_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;VGRF_&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;sensor_&#39;</span><span class="p">)]</span>
</span><span id="PhysioNetLoader.create_sliding_windows-242"><a href="#PhysioNetLoader.create_sliding_windows-242"><span class="linenos">242</span></a>            <span class="n">df_sensors</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">sensor_columns</span><span class="p">]</span>
</span><span id="PhysioNetLoader.create_sliding_windows-243"><a href="#PhysioNetLoader.create_sliding_windows-243"><span class="linenos">243</span></a>            
</span><span id="PhysioNetLoader.create_sliding_windows-244"><a href="#PhysioNetLoader.create_sliding_windows-244"><span class="linenos">244</span></a>            <span class="k">if</span> <span class="n">df_sensors</span><span class="o">.</span><span class="n">empty</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_sensors</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">window_size</span><span class="p">:</span>
</span><span id="PhysioNetLoader.create_sliding_windows-245"><a href="#PhysioNetLoader.create_sliding_windows-245"><span class="linenos">245</span></a>                <span class="k">continue</span>
</span><span id="PhysioNetLoader.create_sliding_windows-246"><a href="#PhysioNetLoader.create_sliding_windows-246"><span class="linenos">246</span></a>                
</span><span id="PhysioNetLoader.create_sliding_windows-247"><a href="#PhysioNetLoader.create_sliding_windows-247"><span class="linenos">247</span></a>            <span class="n">windows</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PhysioNetLoader.create_sliding_windows-248"><a href="#PhysioNetLoader.create_sliding_windows-248"><span class="linenos">248</span></a>            
</span><span id="PhysioNetLoader.create_sliding_windows-249"><a href="#PhysioNetLoader.create_sliding_windows-249"><span class="linenos">249</span></a>            <span class="c1"># Create windows for each sensor</span>
</span><span id="PhysioNetLoader.create_sliding_windows-250"><a href="#PhysioNetLoader.create_sliding_windows-250"><span class="linenos">250</span></a>            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">sensor_columns</span><span class="p">:</span>
</span><span id="PhysioNetLoader.create_sliding_windows-251"><a href="#PhysioNetLoader.create_sliding_windows-251"><span class="linenos">251</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="PhysioNetLoader.create_sliding_windows-252"><a href="#PhysioNetLoader.create_sliding_windows-252"><span class="linenos">252</span></a>                    <span class="n">window_data</span> <span class="o">=</span> <span class="n">sliding_window</span><span class="p">(</span><span class="n">df_sensors</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span><span id="PhysioNetLoader.create_sliding_windows-253"><a href="#PhysioNetLoader.create_sliding_windows-253"><span class="linenos">253</span></a>                    <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">col</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">window_data</span><span class="p">})</span>
</span><span id="PhysioNetLoader.create_sliding_windows-254"><a href="#PhysioNetLoader.create_sliding_windows-254"><span class="linenos">254</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PhysioNetLoader.create_sliding_windows-255"><a href="#PhysioNetLoader.create_sliding_windows-255"><span class="linenos">255</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error creating windows for </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">names</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader.create_sliding_windows-256"><a href="#PhysioNetLoader.create_sliding_windows-256"><span class="linenos">256</span></a>                    <span class="k">continue</span>
</span><span id="PhysioNetLoader.create_sliding_windows-257"><a href="#PhysioNetLoader.create_sliding_windows-257"><span class="linenos">257</span></a>            
</span><span id="PhysioNetLoader.create_sliding_windows-258"><a href="#PhysioNetLoader.create_sliding_windows-258"><span class="linenos">258</span></a>            <span class="k">if</span> <span class="n">windows</span><span class="p">:</span>
</span><span id="PhysioNetLoader.create_sliding_windows-259"><a href="#PhysioNetLoader.create_sliding_windows-259"><span class="linenos">259</span></a>                <span class="n">windows_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="PhysioNetLoader.create_sliding_windows-260"><a href="#PhysioNetLoader.create_sliding_windows-260"><span class="linenos">260</span></a>                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="PhysioNetLoader.create_sliding_windows-261"><a href="#PhysioNetLoader.create_sliding_windows-261"><span class="linenos">261</span></a>                    <span class="s2">&quot;windows&quot;</span><span class="p">:</span> <span class="n">windows</span><span class="p">,</span>
</span><span id="PhysioNetLoader.create_sliding_windows-262"><a href="#PhysioNetLoader.create_sliding_windows-262"><span class="linenos">262</span></a>                    <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="PhysioNetLoader.create_sliding_windows-263"><a href="#PhysioNetLoader.create_sliding_windows-263"><span class="linenos">263</span></a>                        <span class="s2">&quot;subject_type&quot;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;subject_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;subject_type&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">else</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">,</span>
</span><span id="PhysioNetLoader.create_sliding_windows-264"><a href="#PhysioNetLoader.create_sliding_windows-264"><span class="linenos">264</span></a>                        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;label&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">else</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">,</span>
</span><span id="PhysioNetLoader.create_sliding_windows-265"><a href="#PhysioNetLoader.create_sliding_windows-265"><span class="linenos">265</span></a>                        <span class="s2">&quot;window_size&quot;</span><span class="p">:</span> <span class="n">window_size</span><span class="p">,</span>
</span><span id="PhysioNetLoader.create_sliding_windows-266"><a href="#PhysioNetLoader.create_sliding_windows-266"><span class="linenos">266</span></a>                        <span class="s2">&quot;step_size&quot;</span><span class="p">:</span> <span class="n">step_size</span><span class="p">,</span>
</span><span id="PhysioNetLoader.create_sliding_windows-267"><a href="#PhysioNetLoader.create_sliding_windows-267"><span class="linenos">267</span></a>                        <span class="s2">&quot;num_windows&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">windows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;data&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="n">windows</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="PhysioNetLoader.create_sliding_windows-268"><a href="#PhysioNetLoader.create_sliding_windows-268"><span class="linenos">268</span></a>                    <span class="p">}</span>
</span><span id="PhysioNetLoader.create_sliding_windows-269"><a href="#PhysioNetLoader.create_sliding_windows-269"><span class="linenos">269</span></a>                <span class="p">})</span>
</span><span id="PhysioNetLoader.create_sliding_windows-270"><a href="#PhysioNetLoader.create_sliding_windows-270"><span class="linenos">270</span></a>        
</span><span id="PhysioNetLoader.create_sliding_windows-271"><a href="#PhysioNetLoader.create_sliding_windows-271"><span class="linenos">271</span></a>        <span class="k">return</span> <span class="n">windows_data</span>
</span></pre></div>


            <div class="docstring"><p>Create sliding windows from the PhysioNet dataset.</p>

<p>Args:
    data: List of DataFrames containing PhysioNet data
    names: List of names corresponding to the data
    window_size: Size of the sliding window (default: 600 for 6 seconds at 100Hz)
    step_size: Step size for the sliding window (default: 100)</p>

<p>Returns:
    List of dictionaries containing sliding windows for each DataFrame</p>
</div>


                            </div>
                            <div id="PhysioNetLoader.get_supported_formats" class="classattr">
                                        <input id="PhysioNetLoader.get_supported_formats-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_supported_formats</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PhysioNetLoader.get_supported_formats-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PhysioNetLoader.get_supported_formats"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PhysioNetLoader.get_supported_formats-273"><a href="#PhysioNetLoader.get_supported_formats-273"><span class="linenos">273</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_supported_formats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PhysioNetLoader.get_supported_formats-274"><a href="#PhysioNetLoader.get_supported_formats-274"><span class="linenos">274</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader.get_supported_formats-275"><a href="#PhysioNetLoader.get_supported_formats-275"><span class="linenos">275</span></a><span class="sd">        Get list of supported file formats for PhysioNet dataset.</span>
</span><span id="PhysioNetLoader.get_supported_formats-276"><a href="#PhysioNetLoader.get_supported_formats-276"><span class="linenos">276</span></a><span class="sd">        </span>
</span><span id="PhysioNetLoader.get_supported_formats-277"><a href="#PhysioNetLoader.get_supported_formats-277"><span class="linenos">277</span></a><span class="sd">        Returns:</span>
</span><span id="PhysioNetLoader.get_supported_formats-278"><a href="#PhysioNetLoader.get_supported_formats-278"><span class="linenos">278</span></a><span class="sd">            List of supported file extensions</span>
</span><span id="PhysioNetLoader.get_supported_formats-279"><a href="#PhysioNetLoader.get_supported_formats-279"><span class="linenos">279</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader.get_supported_formats-280"><a href="#PhysioNetLoader.get_supported_formats-280"><span class="linenos">280</span></a>        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;.txt&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get list of supported file formats for PhysioNet dataset.</p>

<p>Returns:
    List of supported file extensions</p>
</div>


                            </div>
                            <div id="PhysioNetLoader.get_sensor_info" class="classattr">
                                        <input id="PhysioNetLoader.get_sensor_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_sensor_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="PhysioNetLoader.get_sensor_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PhysioNetLoader.get_sensor_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PhysioNetLoader.get_sensor_info-282"><a href="#PhysioNetLoader.get_sensor_info-282"><span class="linenos">282</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sensor_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="PhysioNetLoader.get_sensor_info-283"><a href="#PhysioNetLoader.get_sensor_info-283"><span class="linenos">283</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader.get_sensor_info-284"><a href="#PhysioNetLoader.get_sensor_info-284"><span class="linenos">284</span></a><span class="sd">        Get information about sensors in the dataset.</span>
</span><span id="PhysioNetLoader.get_sensor_info-285"><a href="#PhysioNetLoader.get_sensor_info-285"><span class="linenos">285</span></a><span class="sd">        </span>
</span><span id="PhysioNetLoader.get_sensor_info-286"><a href="#PhysioNetLoader.get_sensor_info-286"><span class="linenos">286</span></a><span class="sd">        Returns:</span>
</span><span id="PhysioNetLoader.get_sensor_info-287"><a href="#PhysioNetLoader.get_sensor_info-287"><span class="linenos">287</span></a><span class="sd">            Dictionary containing sensor information</span>
</span><span id="PhysioNetLoader.get_sensor_info-288"><a href="#PhysioNetLoader.get_sensor_info-288"><span class="linenos">288</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader.get_sensor_info-289"><a href="#PhysioNetLoader.get_sensor_info-289"><span class="linenos">289</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="PhysioNetLoader.get_sensor_info-290"><a href="#PhysioNetLoader.get_sensor_info-290"><span class="linenos">290</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sensors&#39;</span><span class="p">],</span>
</span><span id="PhysioNetLoader.get_sensor_info-291"><a href="#PhysioNetLoader.get_sensor_info-291"><span class="linenos">291</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sampling_frequency&#39;</span><span class="p">],</span>
</span><span id="PhysioNetLoader.get_sensor_info-292"><a href="#PhysioNetLoader.get_sensor_info-292"><span class="linenos">292</span></a>            <span class="s1">&#39;window_size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;window_size&#39;</span><span class="p">]</span>
</span><span id="PhysioNetLoader.get_sensor_info-293"><a href="#PhysioNetLoader.get_sensor_info-293"><span class="linenos">293</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Get information about sensors in the dataset.</p>

<p>Returns:
    Dictionary containing sensor information</p>
</div>


                            </div>
                            <div id="PhysioNetLoader.get_subject_info" class="classattr">
                                        <input id="PhysioNetLoader.get_subject_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_subject_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PhysioNetLoader.get_subject_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PhysioNetLoader.get_subject_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PhysioNetLoader.get_subject_info-295"><a href="#PhysioNetLoader.get_subject_info-295"><span class="linenos">295</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_subject_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="PhysioNetLoader.get_subject_info-296"><a href="#PhysioNetLoader.get_subject_info-296"><span class="linenos">296</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader.get_subject_info-297"><a href="#PhysioNetLoader.get_subject_info-297"><span class="linenos">297</span></a><span class="sd">        Get information about subjects in the dataset.</span>
</span><span id="PhysioNetLoader.get_subject_info-298"><a href="#PhysioNetLoader.get_subject_info-298"><span class="linenos">298</span></a><span class="sd">        </span>
</span><span id="PhysioNetLoader.get_subject_info-299"><a href="#PhysioNetLoader.get_subject_info-299"><span class="linenos">299</span></a><span class="sd">        Returns:</span>
</span><span id="PhysioNetLoader.get_subject_info-300"><a href="#PhysioNetLoader.get_subject_info-300"><span class="linenos">300</span></a><span class="sd">            Dictionary containing subject information</span>
</span><span id="PhysioNetLoader.get_subject_info-301"><a href="#PhysioNetLoader.get_subject_info-301"><span class="linenos">301</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader.get_subject_info-302"><a href="#PhysioNetLoader.get_subject_info-302"><span class="linenos">302</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;subjects&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get information about subjects in the dataset.</p>

<p>Returns:
    Dictionary containing subject information</p>
</div>


                            </div>
                            <div id="PhysioNetLoader.get_labels" class="classattr">
                                        <input id="PhysioNetLoader.get_labels-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_labels</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PhysioNetLoader.get_labels-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PhysioNetLoader.get_labels"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PhysioNetLoader.get_labels-304"><a href="#PhysioNetLoader.get_labels-304"><span class="linenos">304</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PhysioNetLoader.get_labels-305"><a href="#PhysioNetLoader.get_labels-305"><span class="linenos">305</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader.get_labels-306"><a href="#PhysioNetLoader.get_labels-306"><span class="linenos">306</span></a><span class="sd">        Get labels for loaded data.</span>
</span><span id="PhysioNetLoader.get_labels-307"><a href="#PhysioNetLoader.get_labels-307"><span class="linenos">307</span></a><span class="sd">        </span>
</span><span id="PhysioNetLoader.get_labels-308"><a href="#PhysioNetLoader.get_labels-308"><span class="linenos">308</span></a><span class="sd">        Returns:</span>
</span><span id="PhysioNetLoader.get_labels-309"><a href="#PhysioNetLoader.get_labels-309"><span class="linenos">309</span></a><span class="sd">            List of labels corresponding to loaded data</span>
</span><span id="PhysioNetLoader.get_labels-310"><a href="#PhysioNetLoader.get_labels-310"><span class="linenos">310</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader.get_labels-311"><a href="#PhysioNetLoader.get_labels-311"><span class="linenos">311</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span>
</span></pre></div>


            <div class="docstring"><p>Get labels for loaded data.</p>

<p>Returns:
    List of labels corresponding to loaded data</p>
</div>


                            </div>
                            <div id="PhysioNetLoader.filter_by_subject_type" class="classattr">
                                        <input id="PhysioNetLoader.filter_by_subject_type-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_by_subject_type</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">subject_type</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="PhysioNetLoader.filter_by_subject_type-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PhysioNetLoader.filter_by_subject_type"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PhysioNetLoader.filter_by_subject_type-313"><a href="#PhysioNetLoader.filter_by_subject_type-313"><span class="linenos">313</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">filter_by_subject_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subject_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="PhysioNetLoader.filter_by_subject_type-314"><a href="#PhysioNetLoader.filter_by_subject_type-314"><span class="linenos">314</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader.filter_by_subject_type-315"><a href="#PhysioNetLoader.filter_by_subject_type-315"><span class="linenos">315</span></a><span class="sd">        Filter loaded data by subject type.</span>
</span><span id="PhysioNetLoader.filter_by_subject_type-316"><a href="#PhysioNetLoader.filter_by_subject_type-316"><span class="linenos">316</span></a><span class="sd">        </span>
</span><span id="PhysioNetLoader.filter_by_subject_type-317"><a href="#PhysioNetLoader.filter_by_subject_type-317"><span class="linenos">317</span></a><span class="sd">        Args:</span>
</span><span id="PhysioNetLoader.filter_by_subject_type-318"><a href="#PhysioNetLoader.filter_by_subject_type-318"><span class="linenos">318</span></a><span class="sd">            subject_type: &#39;Control&#39; or &#39;Patient&#39;</span>
</span><span id="PhysioNetLoader.filter_by_subject_type-319"><a href="#PhysioNetLoader.filter_by_subject_type-319"><span class="linenos">319</span></a><span class="sd">            </span>
</span><span id="PhysioNetLoader.filter_by_subject_type-320"><a href="#PhysioNetLoader.filter_by_subject_type-320"><span class="linenos">320</span></a><span class="sd">        Returns:</span>
</span><span id="PhysioNetLoader.filter_by_subject_type-321"><a href="#PhysioNetLoader.filter_by_subject_type-321"><span class="linenos">321</span></a><span class="sd">            Tuple of (filtered_data, filtered_names)</span>
</span><span id="PhysioNetLoader.filter_by_subject_type-322"><a href="#PhysioNetLoader.filter_by_subject_type-322"><span class="linenos">322</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PhysioNetLoader.filter_by_subject_type-323"><a href="#PhysioNetLoader.filter_by_subject_type-323"><span class="linenos">323</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
</span><span id="PhysioNetLoader.filter_by_subject_type-324"><a href="#PhysioNetLoader.filter_by_subject_type-324"><span class="linenos">324</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No data loaded. Call load_data() first.&quot;</span><span class="p">)</span>
</span><span id="PhysioNetLoader.filter_by_subject_type-325"><a href="#PhysioNetLoader.filter_by_subject_type-325"><span class="linenos">325</span></a>        
</span><span id="PhysioNetLoader.filter_by_subject_type-326"><a href="#PhysioNetLoader.filter_by_subject_type-326"><span class="linenos">326</span></a>        <span class="n">filtered_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PhysioNetLoader.filter_by_subject_type-327"><a href="#PhysioNetLoader.filter_by_subject_type-327"><span class="linenos">327</span></a>        <span class="n">filtered_names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PhysioNetLoader.filter_by_subject_type-328"><a href="#PhysioNetLoader.filter_by_subject_type-328"><span class="linenos">328</span></a>        
</span><span id="PhysioNetLoader.filter_by_subject_type-329"><a href="#PhysioNetLoader.filter_by_subject_type-329"><span class="linenos">329</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
</span><span id="PhysioNetLoader.filter_by_subject_type-330"><a href="#PhysioNetLoader.filter_by_subject_type-330"><span class="linenos">330</span></a>            <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;subject_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">subject_type</span><span class="p">:</span>
</span><span id="PhysioNetLoader.filter_by_subject_type-331"><a href="#PhysioNetLoader.filter_by_subject_type-331"><span class="linenos">331</span></a>                <span class="n">filtered_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="PhysioNetLoader.filter_by_subject_type-332"><a href="#PhysioNetLoader.filter_by_subject_type-332"><span class="linenos">332</span></a>                <span class="n">filtered_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="PhysioNetLoader.filter_by_subject_type-333"><a href="#PhysioNetLoader.filter_by_subject_type-333"><span class="linenos">333</span></a>        
</span><span id="PhysioNetLoader.filter_by_subject_type-334"><a href="#PhysioNetLoader.filter_by_subject_type-334"><span class="linenos">334</span></a>        <span class="k">return</span> <span class="n">filtered_data</span><span class="p">,</span> <span class="n">filtered_names</span>
</span></pre></div>


            <div class="docstring"><p>Filter loaded data by subject type.</p>

<p>Args:
    subject_type: 'Control' or 'Patient'</p>

<p>Returns:
    Tuple of (filtered_data, filtered_names)</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="core/base_classes.html#BaseDatasetLoader">gaitsetpy.core.base_classes.BaseDatasetLoader</a></dt>
                                <dd id="PhysioNetLoader.name" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.name">name</a></dd>
                <dd id="PhysioNetLoader.description" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.description">description</a></dd>
                <dd id="PhysioNetLoader.data" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.data">data</a></dd>
                <dd id="PhysioNetLoader.max_workers" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.max_workers">max_workers</a></dd>
                <dd id="PhysioNetLoader.download_files_concurrent" class="function"><a href="core/base_classes.html#BaseDatasetLoader.download_files_concurrent">download_files_concurrent</a></dd>
                <dd id="PhysioNetLoader.set_max_workers" class="function"><a href="core/base_classes.html#BaseDatasetLoader.set_max_workers">set_max_workers</a></dd>
                <dd id="PhysioNetLoader.get_download_stats" class="function"><a href="core/base_classes.html#BaseDatasetLoader.get_download_stats">get_download_stats</a></dd>
                <dd id="PhysioNetLoader.get_info" class="function"><a href="core/base_classes.html#BaseDatasetLoader.get_info">get_info</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="HARUPLoader">
                            <input id="HARUPLoader-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">HARUPLoader</span><wbr>(<span class="base"><a href="core/base_classes.html#BaseDatasetLoader">gaitsetpy.core.base_classes.BaseDatasetLoader</a></span>):

                <label class="view-source-button" for="HARUPLoader-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HARUPLoader"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HARUPLoader-26"><a href="#HARUPLoader-26"><span class="linenos"> 26</span></a><span class="k">class</span><span class="w"> </span><span class="nc">HARUPLoader</span><span class="p">(</span><span class="n">BaseDatasetLoader</span><span class="p">):</span>
</span><span id="HARUPLoader-27"><a href="#HARUPLoader-27"><span class="linenos"> 27</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="HARUPLoader-28"><a href="#HARUPLoader-28"><span class="linenos"> 28</span></a><span class="sd">    HAR-UP dataset loader class.</span>
</span><span id="HARUPLoader-29"><a href="#HARUPLoader-29"><span class="linenos"> 29</span></a><span class="sd">    </span>
</span><span id="HARUPLoader-30"><a href="#HARUPLoader-30"><span class="linenos"> 30</span></a><span class="sd">    This class handles loading and processing of the HAR-UP dataset for human activity recognition</span>
</span><span id="HARUPLoader-31"><a href="#HARUPLoader-31"><span class="linenos"> 31</span></a><span class="sd">    and fall detection analysis.</span>
</span><span id="HARUPLoader-32"><a href="#HARUPLoader-32"><span class="linenos"> 32</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="HARUPLoader-33"><a href="#HARUPLoader-33"><span class="linenos"> 33</span></a>    
</span><span id="HARUPLoader-34"><a href="#HARUPLoader-34"><span class="linenos"> 34</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">):</span>
</span><span id="HARUPLoader-35"><a href="#HARUPLoader-35"><span class="linenos"> 35</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="HARUPLoader-36"><a href="#HARUPLoader-36"><span class="linenos"> 36</span></a><span class="sd">        Initialize HAR-UP loader with concurrent download support.</span>
</span><span id="HARUPLoader-37"><a href="#HARUPLoader-37"><span class="linenos"> 37</span></a><span class="sd">        </span>
</span><span id="HARUPLoader-38"><a href="#HARUPLoader-38"><span class="linenos"> 38</span></a><span class="sd">        Args:</span>
</span><span id="HARUPLoader-39"><a href="#HARUPLoader-39"><span class="linenos"> 39</span></a><span class="sd">            max_workers: Maximum number of concurrent download threads (default: 8)</span>
</span><span id="HARUPLoader-40"><a href="#HARUPLoader-40"><span class="linenos"> 40</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HARUPLoader-41"><a href="#HARUPLoader-41"><span class="linenos"> 41</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="HARUPLoader-42"><a href="#HARUPLoader-42"><span class="linenos"> 42</span></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;harup&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader-43"><a href="#HARUPLoader-43"><span class="linenos"> 43</span></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;HAR-UP Dataset - Multimodal System for Fall Detection and Human Activity Recognition&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader-44"><a href="#HARUPLoader-44"><span class="linenos"> 44</span></a>            <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span>
</span><span id="HARUPLoader-45"><a href="#HARUPLoader-45"><span class="linenos"> 45</span></a>        <span class="p">)</span>
</span><span id="HARUPLoader-46"><a href="#HARUPLoader-46"><span class="linenos"> 46</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="HARUPLoader-47"><a href="#HARUPLoader-47"><span class="linenos"> 47</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="HARUPLoader-48"><a href="#HARUPLoader-48"><span class="linenos"> 48</span></a>                <span class="s1">&#39;AnkleAccelerometer&#39;</span><span class="p">,</span> <span class="s1">&#39;AnkleAngularVelocity&#39;</span><span class="p">,</span> <span class="s1">&#39;AnkleLuminosity&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-49"><a href="#HARUPLoader-49"><span class="linenos"> 49</span></a>                <span class="s1">&#39;RightPocketAccelerometer&#39;</span><span class="p">,</span> <span class="s1">&#39;RightPocketAngularVelocity&#39;</span><span class="p">,</span> <span class="s1">&#39;RightPocketLuminosity&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-50"><a href="#HARUPLoader-50"><span class="linenos"> 50</span></a>                <span class="s1">&#39;BeltAccelerometer&#39;</span><span class="p">,</span> <span class="s1">&#39;BeltAngularVelocity&#39;</span><span class="p">,</span> <span class="s1">&#39;BeltLuminosity&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-51"><a href="#HARUPLoader-51"><span class="linenos"> 51</span></a>                <span class="s1">&#39;NeckAccelerometer&#39;</span><span class="p">,</span> <span class="s1">&#39;NeckAngularVelocity&#39;</span><span class="p">,</span> <span class="s1">&#39;NeckLuminosity&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-52"><a href="#HARUPLoader-52"><span class="linenos"> 52</span></a>                <span class="s1">&#39;WristAccelerometer&#39;</span><span class="p">,</span> <span class="s1">&#39;WristAngularVelocity&#39;</span><span class="p">,</span> <span class="s1">&#39;WristLuminosity&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-53"><a href="#HARUPLoader-53"><span class="linenos"> 53</span></a>                <span class="s1">&#39;BrainSensor&#39;</span><span class="p">,</span> <span class="s1">&#39;Infrared&#39;</span>
</span><span id="HARUPLoader-54"><a href="#HARUPLoader-54"><span class="linenos"> 54</span></a>            <span class="p">],</span>
</span><span id="HARUPLoader-55"><a href="#HARUPLoader-55"><span class="linenos"> 55</span></a>            <span class="s1">&#39;components&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="HARUPLoader-56"><a href="#HARUPLoader-56"><span class="linenos"> 56</span></a>                <span class="s1">&#39;Accelerometer&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span>
</span><span id="HARUPLoader-57"><a href="#HARUPLoader-57"><span class="linenos"> 57</span></a>                <span class="s1">&#39;AngularVelocity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span>
</span><span id="HARUPLoader-58"><a href="#HARUPLoader-58"><span class="linenos"> 58</span></a>                <span class="s1">&#39;Luminosity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;illuminance&#39;</span><span class="p">],</span>
</span><span id="HARUPLoader-59"><a href="#HARUPLoader-59"><span class="linenos"> 59</span></a>                <span class="s1">&#39;BrainSensor&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">],</span>
</span><span id="HARUPLoader-60"><a href="#HARUPLoader-60"><span class="linenos"> 60</span></a>                <span class="s1">&#39;Infrared&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
</span><span id="HARUPLoader-61"><a href="#HARUPLoader-61"><span class="linenos"> 61</span></a>            <span class="p">},</span>
</span><span id="HARUPLoader-62"><a href="#HARUPLoader-62"><span class="linenos"> 62</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>  <span class="c1"># Hz</span>
</span><span id="HARUPLoader-63"><a href="#HARUPLoader-63"><span class="linenos"> 63</span></a>            <span class="s1">&#39;activities&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="HARUPLoader-64"><a href="#HARUPLoader-64"><span class="linenos"> 64</span></a>                <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Walking&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-65"><a href="#HARUPLoader-65"><span class="linenos"> 65</span></a>                <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Walking upstairs&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-66"><a href="#HARUPLoader-66"><span class="linenos"> 66</span></a>                <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;Walking downstairs&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-67"><a href="#HARUPLoader-67"><span class="linenos"> 67</span></a>                <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;Sitting&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-68"><a href="#HARUPLoader-68"><span class="linenos"> 68</span></a>                <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;Standing&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-69"><a href="#HARUPLoader-69"><span class="linenos"> 69</span></a>                <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;Lying&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-70"><a href="#HARUPLoader-70"><span class="linenos"> 70</span></a>                <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;Falling forward using hands&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-71"><a href="#HARUPLoader-71"><span class="linenos"> 71</span></a>                <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;Falling forward using knees&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-72"><a href="#HARUPLoader-72"><span class="linenos"> 72</span></a>                <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;Falling backwards&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-73"><a href="#HARUPLoader-73"><span class="linenos"> 73</span></a>                <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;Falling sideward&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-74"><a href="#HARUPLoader-74"><span class="linenos"> 74</span></a>                <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;Falling sitting in empty chair&#39;</span>
</span><span id="HARUPLoader-75"><a href="#HARUPLoader-75"><span class="linenos"> 75</span></a>            <span class="p">}</span>
</span><span id="HARUPLoader-76"><a href="#HARUPLoader-76"><span class="linenos"> 76</span></a>        <span class="p">}</span>
</span><span id="HARUPLoader-77"><a href="#HARUPLoader-77"><span class="linenos"> 77</span></a>        
</span><span id="HARUPLoader-78"><a href="#HARUPLoader-78"><span class="linenos"> 78</span></a>        <span class="c1"># Features used in HAR-UP</span>
</span><span id="HARUPLoader-79"><a href="#HARUPLoader-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="HARUPLoader-80"><a href="#HARUPLoader-80"><span class="linenos"> 80</span></a>            <span class="s1">&#39;Mean&#39;</span><span class="p">,</span> <span class="s1">&#39;StandardDeviation&#39;</span><span class="p">,</span> <span class="s1">&#39;RootMeanSquare&#39;</span><span class="p">,</span> <span class="s1">&#39;MaximalAmplitude&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-81"><a href="#HARUPLoader-81"><span class="linenos"> 81</span></a>            <span class="s1">&#39;MinimalAmplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Median&#39;</span><span class="p">,</span> <span class="s1">&#39;Number of zero-crossing&#39;</span><span class="p">,</span> <span class="s1">&#39;Skewness&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-82"><a href="#HARUPLoader-82"><span class="linenos"> 82</span></a>            <span class="s1">&#39;Kurtosis&#39;</span><span class="p">,</span> <span class="s1">&#39;First Quartile&#39;</span><span class="p">,</span> <span class="s1">&#39;Third Quartile&#39;</span><span class="p">,</span> <span class="s1">&#39;Autocorrelation&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-83"><a href="#HARUPLoader-83"><span class="linenos"> 83</span></a>            <span class="s1">&#39;Energy&#39;</span>
</span><span id="HARUPLoader-84"><a href="#HARUPLoader-84"><span class="linenos"> 84</span></a>        <span class="p">]</span>
</span><span id="HARUPLoader-85"><a href="#HARUPLoader-85"><span class="linenos"> 85</span></a>    
</span><span id="HARUPLoader-86"><a href="#HARUPLoader-86"><span class="linenos"> 86</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">download_harup_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="HARUPLoader-87"><a href="#HARUPLoader-87"><span class="linenos"> 87</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="HARUPLoader-88"><a href="#HARUPLoader-88"><span class="linenos"> 88</span></a><span class="sd">        Download HAR-UP dataset if not already present.</span>
</span><span id="HARUPLoader-89"><a href="#HARUPLoader-89"><span class="linenos"> 89</span></a><span class="sd">        </span>
</span><span id="HARUPLoader-90"><a href="#HARUPLoader-90"><span class="linenos"> 90</span></a><span class="sd">        Args:</span>
</span><span id="HARUPLoader-91"><a href="#HARUPLoader-91"><span class="linenos"> 91</span></a><span class="sd">            data_dir: Directory to store the dataset</span>
</span><span id="HARUPLoader-92"><a href="#HARUPLoader-92"><span class="linenos"> 92</span></a><span class="sd">            </span>
</span><span id="HARUPLoader-93"><a href="#HARUPLoader-93"><span class="linenos"> 93</span></a><span class="sd">        Returns:</span>
</span><span id="HARUPLoader-94"><a href="#HARUPLoader-94"><span class="linenos"> 94</span></a><span class="sd">            Path to the extracted dataset or None if not found</span>
</span><span id="HARUPLoader-95"><a href="#HARUPLoader-95"><span class="linenos"> 95</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HARUPLoader-96"><a href="#HARUPLoader-96"><span class="linenos"> 96</span></a>        <span class="c1"># Use the utility function to download and extract the dataset</span>
</span><span id="HARUPLoader-97"><a href="#HARUPLoader-97"><span class="linenos"> 97</span></a>        <span class="n">download_dataset</span><span class="p">(</span><span class="s2">&quot;harup&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</span><span id="HARUPLoader-98"><a href="#HARUPLoader-98"><span class="linenos"> 98</span></a>        <span class="n">extract_dataset</span><span class="p">(</span><span class="s2">&quot;harup&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</span><span id="HARUPLoader-99"><a href="#HARUPLoader-99"><span class="linenos"> 99</span></a>        
</span><span id="HARUPLoader-100"><a href="#HARUPLoader-100"><span class="linenos">100</span></a>        <span class="c1"># Check if dataset exists after download attempt</span>
</span><span id="HARUPLoader-101"><a href="#HARUPLoader-101"><span class="linenos">101</span></a>        <span class="n">dataset_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;DataSet&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader-102"><a href="#HARUPLoader-102"><span class="linenos">102</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dataset_path</span><span class="p">):</span>
</span><span id="HARUPLoader-103"><a href="#HARUPLoader-103"><span class="linenos">103</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;HAR-UP dataset not found after download attempt.&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader-104"><a href="#HARUPLoader-104"><span class="linenos">104</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please ensure the dataset is organized in the following structure:&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader-105"><a href="#HARUPLoader-105"><span class="linenos">105</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DataSet/Subject</span><span class="si">{i}</span><span class="s2">/Activity</span><span class="si">{j}</span><span class="s2">/Trial</span><span class="si">{k}</span><span class="s2">/Subject</span><span class="si">{i}</span><span class="s2">Activity</span><span class="si">{j}</span><span class="s2">Trial</span><span class="si">{k}</span><span class="s2">.csv&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader-106"><a href="#HARUPLoader-106"><span class="linenos">106</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="HARUPLoader-107"><a href="#HARUPLoader-107"><span class="linenos">107</span></a>        
</span><span id="HARUPLoader-108"><a href="#HARUPLoader-108"><span class="linenos">108</span></a>        <span class="k">return</span> <span class="n">dataset_path</span>
</span><span id="HARUPLoader-109"><a href="#HARUPLoader-109"><span class="linenos">109</span></a>    
</span><span id="HARUPLoader-110"><a href="#HARUPLoader-110"><span class="linenos">110</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subjects</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
</span><span id="HARUPLoader-111"><a href="#HARUPLoader-111"><span class="linenos">111</span></a>                <span class="n">activities</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">trials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="HARUPLoader-112"><a href="#HARUPLoader-112"><span class="linenos">112</span></a>                <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="HARUPLoader-113"><a href="#HARUPLoader-113"><span class="linenos">113</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="HARUPLoader-114"><a href="#HARUPLoader-114"><span class="linenos">114</span></a><span class="sd">        Load HAR-UP dataset from the specified directory.</span>
</span><span id="HARUPLoader-115"><a href="#HARUPLoader-115"><span class="linenos">115</span></a><span class="sd">        Args:</span>
</span><span id="HARUPLoader-116"><a href="#HARUPLoader-116"><span class="linenos">116</span></a><span class="sd">            data_dir: Directory containing the dataset</span>
</span><span id="HARUPLoader-117"><a href="#HARUPLoader-117"><span class="linenos">117</span></a><span class="sd">            subjects: List of subject IDs to load (default: all subjects)</span>
</span><span id="HARUPLoader-118"><a href="#HARUPLoader-118"><span class="linenos">118</span></a><span class="sd">            activities: List of activity IDs to load (default: all activities)</span>
</span><span id="HARUPLoader-119"><a href="#HARUPLoader-119"><span class="linenos">119</span></a><span class="sd">            trials: List of trial IDs to load (default: all trials)</span>
</span><span id="HARUPLoader-120"><a href="#HARUPLoader-120"><span class="linenos">120</span></a><span class="sd">            **kwargs: Additional arguments</span>
</span><span id="HARUPLoader-121"><a href="#HARUPLoader-121"><span class="linenos">121</span></a><span class="sd">        Returns:</span>
</span><span id="HARUPLoader-122"><a href="#HARUPLoader-122"><span class="linenos">122</span></a><span class="sd">            Tuple of (data_list, names_list)</span>
</span><span id="HARUPLoader-123"><a href="#HARUPLoader-123"><span class="linenos">123</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HARUPLoader-124"><a href="#HARUPLoader-124"><span class="linenos">124</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
</span><span id="HARUPLoader-125"><a href="#HARUPLoader-125"><span class="linenos">125</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="HARUPLoader-126"><a href="#HARUPLoader-126"><span class="linenos">126</span></a>        <span class="c1"># Set default values if not provided (HAR-UP: 4 subjects, 11 activities, 3 trials)</span>
</span><span id="HARUPLoader-127"><a href="#HARUPLoader-127"><span class="linenos">127</span></a>        <span class="k">if</span> <span class="n">subjects</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="HARUPLoader-128"><a href="#HARUPLoader-128"><span class="linenos">128</span></a>            <span class="n">subjects</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>  <span class="c1"># 4 subjects</span>
</span><span id="HARUPLoader-129"><a href="#HARUPLoader-129"><span class="linenos">129</span></a>        <span class="k">if</span> <span class="n">activities</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="HARUPLoader-130"><a href="#HARUPLoader-130"><span class="linenos">130</span></a>            <span class="n">activities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>  <span class="c1"># 11 activities</span>
</span><span id="HARUPLoader-131"><a href="#HARUPLoader-131"><span class="linenos">131</span></a>        <span class="k">if</span> <span class="n">trials</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="HARUPLoader-132"><a href="#HARUPLoader-132"><span class="linenos">132</span></a>            <span class="n">trials</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>  <span class="c1"># 3 trials</span>
</span><span id="HARUPLoader-133"><a href="#HARUPLoader-133"><span class="linenos">133</span></a>
</span><span id="HARUPLoader-134"><a href="#HARUPLoader-134"><span class="linenos">134</span></a>        <span class="c1"># Column names as per official HAR-UP documentation</span>
</span><span id="HARUPLoader-135"><a href="#HARUPLoader-135"><span class="linenos">135</span></a>        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="HARUPLoader-136"><a href="#HARUPLoader-136"><span class="linenos">136</span></a>            <span class="s2">&quot;Timestamp&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader-137"><a href="#HARUPLoader-137"><span class="linenos">137</span></a>            <span class="s2">&quot;EEG_NeuroSky&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader-138"><a href="#HARUPLoader-138"><span class="linenos">138</span></a>            <span class="s2">&quot;Belt_Acc_X&quot;</span><span class="p">,</span> <span class="s2">&quot;Belt_Acc_Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Belt_Acc_Z&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader-139"><a href="#HARUPLoader-139"><span class="linenos">139</span></a>            <span class="s2">&quot;Belt_Gyro_X&quot;</span><span class="p">,</span> <span class="s2">&quot;Belt_Gyro_Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Belt_Gyro_Z&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader-140"><a href="#HARUPLoader-140"><span class="linenos">140</span></a>            <span class="s2">&quot;Belt_Luminosity&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader-141"><a href="#HARUPLoader-141"><span class="linenos">141</span></a>            <span class="s2">&quot;Neck_Acc_X&quot;</span><span class="p">,</span> <span class="s2">&quot;Neck_Acc_Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Neck_Acc_Z&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader-142"><a href="#HARUPLoader-142"><span class="linenos">142</span></a>            <span class="s2">&quot;Neck_Gyro_X&quot;</span><span class="p">,</span> <span class="s2">&quot;Neck_Gyro_Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Neck_Gyro_Z&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader-143"><a href="#HARUPLoader-143"><span class="linenos">143</span></a>            <span class="s2">&quot;Neck_Luminosity&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader-144"><a href="#HARUPLoader-144"><span class="linenos">144</span></a>            <span class="s2">&quot;Pocket_Acc_X&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket_Acc_Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket_Acc_Z&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader-145"><a href="#HARUPLoader-145"><span class="linenos">145</span></a>            <span class="s2">&quot;Pocket_Gyro_X&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket_Gyro_Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket_Gyro_Z&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader-146"><a href="#HARUPLoader-146"><span class="linenos">146</span></a>            <span class="s2">&quot;Pocket_Luminosity&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader-147"><a href="#HARUPLoader-147"><span class="linenos">147</span></a>            <span class="s2">&quot;Wrist_Acc_X&quot;</span><span class="p">,</span> <span class="s2">&quot;Wrist_Acc_Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Wrist_Acc_Z&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader-148"><a href="#HARUPLoader-148"><span class="linenos">148</span></a>            <span class="s2">&quot;Wrist_Gyro_X&quot;</span><span class="p">,</span> <span class="s2">&quot;Wrist_Gyro_Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Wrist_Gyro_Z&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader-149"><a href="#HARUPLoader-149"><span class="linenos">149</span></a>            <span class="s2">&quot;Wrist_Luminosity&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader-150"><a href="#HARUPLoader-150"><span class="linenos">150</span></a>            <span class="s2">&quot;Infrared_1&quot;</span><span class="p">,</span> <span class="s2">&quot;Infrared_2&quot;</span><span class="p">,</span> <span class="s2">&quot;Infrared_3&quot;</span><span class="p">,</span> <span class="s2">&quot;Infrared_4&quot;</span>
</span><span id="HARUPLoader-151"><a href="#HARUPLoader-151"><span class="linenos">151</span></a>        <span class="p">]</span>
</span><span id="HARUPLoader-152"><a href="#HARUPLoader-152"><span class="linenos">152</span></a>
</span><span id="HARUPLoader-153"><a href="#HARUPLoader-153"><span class="linenos">153</span></a>        <span class="c1"># If data_dir does not exist, trigger interactive download</span>
</span><span id="HARUPLoader-154"><a href="#HARUPLoader-154"><span class="linenos">154</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">data_dir</span><span class="p">):</span>
</span><span id="HARUPLoader-155"><a href="#HARUPLoader-155"><span class="linenos">155</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Directory </span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2"> does not exist. Attempting to download HAR-UP dataset...&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader-156"><a href="#HARUPLoader-156"><span class="linenos">156</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">download_harup_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</span><span id="HARUPLoader-157"><a href="#HARUPLoader-157"><span class="linenos">157</span></a>        <span class="c1"># If still doesn&#39;t exist, error out</span>
</span><span id="HARUPLoader-158"><a href="#HARUPLoader-158"><span class="linenos">158</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">data_dir</span><span class="p">):</span>
</span><span id="HARUPLoader-159"><a href="#HARUPLoader-159"><span class="linenos">159</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to create or download dataset directory: </span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader-160"><a href="#HARUPLoader-160"><span class="linenos">160</span></a>            <span class="k">return</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="HARUPLoader-161"><a href="#HARUPLoader-161"><span class="linenos">161</span></a>
</span><span id="HARUPLoader-162"><a href="#HARUPLoader-162"><span class="linenos">162</span></a>        <span class="c1"># Find the UP_Fall_Detection_Dataset directory</span>
</span><span id="HARUPLoader-163"><a href="#HARUPLoader-163"><span class="linenos">163</span></a>        <span class="n">dataset_path</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="HARUPLoader-164"><a href="#HARUPLoader-164"><span class="linenos">164</span></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">data_dir</span><span class="p">):</span>
</span><span id="HARUPLoader-165"><a href="#HARUPLoader-165"><span class="linenos">165</span></a>            <span class="n">entry_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span>
</span><span id="HARUPLoader-166"><a href="#HARUPLoader-166"><span class="linenos">166</span></a>            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">entry_path</span><span class="p">)</span> <span class="ow">and</span> <span class="n">entry</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;UP_Fall_Detection_Dataset&quot;</span><span class="p">):</span>
</span><span id="HARUPLoader-167"><a href="#HARUPLoader-167"><span class="linenos">167</span></a>                <span class="n">dataset_path</span> <span class="o">=</span> <span class="n">entry_path</span>
</span><span id="HARUPLoader-168"><a href="#HARUPLoader-168"><span class="linenos">168</span></a>                <span class="k">break</span>
</span><span id="HARUPLoader-169"><a href="#HARUPLoader-169"><span class="linenos">169</span></a>        <span class="k">if</span> <span class="n">dataset_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="HARUPLoader-170"><a href="#HARUPLoader-170"><span class="linenos">170</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;UP_Fall_Detection_Dataset directory not found in&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</span><span id="HARUPLoader-171"><a href="#HARUPLoader-171"><span class="linenos">171</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No data loaded. Please make sure you&#39;ve downloaded the HAR-UP dataset.&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader-172"><a href="#HARUPLoader-172"><span class="linenos">172</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Visit https://sites.google.com/up.edu.mx/har-up/ to download the dataset.&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader-173"><a href="#HARUPLoader-173"><span class="linenos">173</span></a>            <span class="k">return</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="HARUPLoader-174"><a href="#HARUPLoader-174"><span class="linenos">174</span></a>
</span><span id="HARUPLoader-175"><a href="#HARUPLoader-175"><span class="linenos">175</span></a>        <span class="n">harup_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="HARUPLoader-176"><a href="#HARUPLoader-176"><span class="linenos">176</span></a>        <span class="n">harup_names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="HARUPLoader-177"><a href="#HARUPLoader-177"><span class="linenos">177</span></a>
</span><span id="HARUPLoader-178"><a href="#HARUPLoader-178"><span class="linenos">178</span></a>        <span class="c1"># Iterate over subjects</span>
</span><span id="HARUPLoader-179"><a href="#HARUPLoader-179"><span class="linenos">179</span></a>        <span class="k">for</span> <span class="n">subject_id</span> <span class="ow">in</span> <span class="n">subjects</span><span class="p">:</span>
</span><span id="HARUPLoader-180"><a href="#HARUPLoader-180"><span class="linenos">180</span></a>            <span class="n">subject_folder</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Subject_</span><span class="si">{</span><span class="n">subject_id</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="HARUPLoader-181"><a href="#HARUPLoader-181"><span class="linenos">181</span></a>            <span class="n">subject_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dataset_path</span><span class="p">,</span> <span class="n">subject_folder</span><span class="p">)</span>
</span><span id="HARUPLoader-182"><a href="#HARUPLoader-182"><span class="linenos">182</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">subject_path</span><span class="p">):</span>
</span><span id="HARUPLoader-183"><a href="#HARUPLoader-183"><span class="linenos">183</span></a>                <span class="k">continue</span>
</span><span id="HARUPLoader-184"><a href="#HARUPLoader-184"><span class="linenos">184</span></a>            
</span><span id="HARUPLoader-185"><a href="#HARUPLoader-185"><span class="linenos">185</span></a>            <span class="c1"># Initialize empty DataFrame for this subject</span>
</span><span id="HARUPLoader-186"><a href="#HARUPLoader-186"><span class="linenos">186</span></a>            <span class="n">subject_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="HARUPLoader-187"><a href="#HARUPLoader-187"><span class="linenos">187</span></a>            
</span><span id="HARUPLoader-188"><a href="#HARUPLoader-188"><span class="linenos">188</span></a>            <span class="c1"># Iterate over activities in order</span>
</span><span id="HARUPLoader-189"><a href="#HARUPLoader-189"><span class="linenos">189</span></a>            <span class="k">for</span> <span class="n">activity_id</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">activities</span><span class="p">):</span>
</span><span id="HARUPLoader-190"><a href="#HARUPLoader-190"><span class="linenos">190</span></a>                <span class="n">activity_folder</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;A</span><span class="si">{</span><span class="n">activity_id</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="HARUPLoader-191"><a href="#HARUPLoader-191"><span class="linenos">191</span></a>                <span class="n">activity_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subject_path</span><span class="p">,</span> <span class="n">activity_folder</span><span class="p">)</span>
</span><span id="HARUPLoader-192"><a href="#HARUPLoader-192"><span class="linenos">192</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">activity_path</span><span class="p">):</span>
</span><span id="HARUPLoader-193"><a href="#HARUPLoader-193"><span class="linenos">193</span></a>                    <span class="k">continue</span>
</span><span id="HARUPLoader-194"><a href="#HARUPLoader-194"><span class="linenos">194</span></a>                
</span><span id="HARUPLoader-195"><a href="#HARUPLoader-195"><span class="linenos">195</span></a>                <span class="c1"># Iterate over trials in order</span>
</span><span id="HARUPLoader-196"><a href="#HARUPLoader-196"><span class="linenos">196</span></a>                <span class="k">for</span> <span class="n">trial_id</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">trials</span><span class="p">):</span>
</span><span id="HARUPLoader-197"><a href="#HARUPLoader-197"><span class="linenos">197</span></a>                    <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;S</span><span class="si">{</span><span class="n">subject_id</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">_A</span><span class="si">{</span><span class="n">activity_id</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">_T</span><span class="si">{</span><span class="n">trial_id</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">.csv&quot;</span>
</span><span id="HARUPLoader-198"><a href="#HARUPLoader-198"><span class="linenos">198</span></a>                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">activity_path</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
</span><span id="HARUPLoader-199"><a href="#HARUPLoader-199"><span class="linenos">199</span></a>                    <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">subject_folder</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">activity_folder</span><span class="si">}</span><span class="s2">_T</span><span class="si">{</span><span class="n">trial_id</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="HARUPLoader-200"><a href="#HARUPLoader-200"><span class="linenos">200</span></a>                    
</span><span id="HARUPLoader-201"><a href="#HARUPLoader-201"><span class="linenos">201</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="HARUPLoader-202"><a href="#HARUPLoader-202"><span class="linenos">202</span></a>                        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="HARUPLoader-203"><a href="#HARUPLoader-203"><span class="linenos">203</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[HARUP] Loaded columns for </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader-204"><a href="#HARUPLoader-204"><span class="linenos">204</span></a>                        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;subject_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subject_id</span>
</span><span id="HARUPLoader-205"><a href="#HARUPLoader-205"><span class="linenos">205</span></a>                        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;activity_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">activity_id</span> 
</span><span id="HARUPLoader-206"><a href="#HARUPLoader-206"><span class="linenos">206</span></a>                        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;trial_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trial_id</span>
</span><span id="HARUPLoader-207"><a href="#HARUPLoader-207"><span class="linenos">207</span></a>                        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;activity_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;activities&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">activity_id</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;A</span><span class="si">{</span><span class="n">activity_id</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader-208"><a href="#HARUPLoader-208"><span class="linenos">208</span></a>                        
</span><span id="HARUPLoader-209"><a href="#HARUPLoader-209"><span class="linenos">209</span></a>                        <span class="c1"># Concatenate to subject&#39;s DataFrame</span>
</span><span id="HARUPLoader-210"><a href="#HARUPLoader-210"><span class="linenos">210</span></a>                        <span class="n">subject_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">subject_df</span><span class="p">,</span> <span class="n">df</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="HARUPLoader-211"><a href="#HARUPLoader-211"><span class="linenos">211</span></a>                        <span class="n">harup_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="HARUPLoader-212"><a href="#HARUPLoader-212"><span class="linenos">212</span></a>                        
</span><span id="HARUPLoader-213"><a href="#HARUPLoader-213"><span class="linenos">213</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="HARUPLoader-214"><a href="#HARUPLoader-214"><span class="linenos">214</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error loading </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader-215"><a href="#HARUPLoader-215"><span class="linenos">215</span></a>            
</span><span id="HARUPLoader-216"><a href="#HARUPLoader-216"><span class="linenos">216</span></a>            <span class="c1"># Add complete subject DataFrame to data list</span>
</span><span id="HARUPLoader-217"><a href="#HARUPLoader-217"><span class="linenos">217</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">subject_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="HARUPLoader-218"><a href="#HARUPLoader-218"><span class="linenos">218</span></a>                <span class="n">harup_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subject_df</span><span class="p">)</span>
</span><span id="HARUPLoader-219"><a href="#HARUPLoader-219"><span class="linenos">219</span></a>                
</span><span id="HARUPLoader-220"><a href="#HARUPLoader-220"><span class="linenos">220</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">harup_data</span>
</span><span id="HARUPLoader-221"><a href="#HARUPLoader-221"><span class="linenos">221</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">harup_names</span>
</span><span id="HARUPLoader-222"><a href="#HARUPLoader-222"><span class="linenos">222</span></a>
</span><span id="HARUPLoader-223"><a href="#HARUPLoader-223"><span class="linenos">223</span></a>        <span class="k">return</span> <span class="n">harup_data</span><span class="p">,</span> <span class="n">harup_names</span>
</span><span id="HARUPLoader-224"><a href="#HARUPLoader-224"><span class="linenos">224</span></a>    
</span><span id="HARUPLoader-225"><a href="#HARUPLoader-225"><span class="linenos">225</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_sliding_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> 
</span><span id="HARUPLoader-226"><a href="#HARUPLoader-226"><span class="linenos">226</span></a>                             <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="HARUPLoader-227"><a href="#HARUPLoader-227"><span class="linenos">227</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="HARUPLoader-228"><a href="#HARUPLoader-228"><span class="linenos">228</span></a><span class="sd">        Create sliding windows from the HAR-UP dataset.</span>
</span><span id="HARUPLoader-229"><a href="#HARUPLoader-229"><span class="linenos">229</span></a><span class="sd">        </span>
</span><span id="HARUPLoader-230"><a href="#HARUPLoader-230"><span class="linenos">230</span></a><span class="sd">        Args:</span>
</span><span id="HARUPLoader-231"><a href="#HARUPLoader-231"><span class="linenos">231</span></a><span class="sd">            data: List of DataFrames containing HAR-UP data</span>
</span><span id="HARUPLoader-232"><a href="#HARUPLoader-232"><span class="linenos">232</span></a><span class="sd">            names: List of names corresponding to the data</span>
</span><span id="HARUPLoader-233"><a href="#HARUPLoader-233"><span class="linenos">233</span></a><span class="sd">            window_size: Size of the sliding window (default: 100 = 1 second at 100Hz)</span>
</span><span id="HARUPLoader-234"><a href="#HARUPLoader-234"><span class="linenos">234</span></a><span class="sd">            step_size: Step size for the sliding window (default: 50 = 0.5 seconds at 100Hz)</span>
</span><span id="HARUPLoader-235"><a href="#HARUPLoader-235"><span class="linenos">235</span></a><span class="sd">            </span>
</span><span id="HARUPLoader-236"><a href="#HARUPLoader-236"><span class="linenos">236</span></a><span class="sd">        Returns:</span>
</span><span id="HARUPLoader-237"><a href="#HARUPLoader-237"><span class="linenos">237</span></a><span class="sd">            List of dictionaries containing sliding windows for each DataFrame</span>
</span><span id="HARUPLoader-238"><a href="#HARUPLoader-238"><span class="linenos">238</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HARUPLoader-239"><a href="#HARUPLoader-239"><span class="linenos">239</span></a>        <span class="n">windows_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="HARUPLoader-240"><a href="#HARUPLoader-240"><span class="linenos">240</span></a>        
</span><span id="HARUPLoader-241"><a href="#HARUPLoader-241"><span class="linenos">241</span></a>        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span><span id="HARUPLoader-242"><a href="#HARUPLoader-242"><span class="linenos">242</span></a>            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="HARUPLoader-243"><a href="#HARUPLoader-243"><span class="linenos">243</span></a>                <span class="k">continue</span>
</span><span id="HARUPLoader-244"><a href="#HARUPLoader-244"><span class="linenos">244</span></a>                
</span><span id="HARUPLoader-245"><a href="#HARUPLoader-245"><span class="linenos">245</span></a>            <span class="n">windows</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="HARUPLoader-246"><a href="#HARUPLoader-246"><span class="linenos">246</span></a>            <span class="n">processed_columns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="HARUPLoader-247"><a href="#HARUPLoader-247"><span class="linenos">247</span></a>            
</span><span id="HARUPLoader-248"><a href="#HARUPLoader-248"><span class="linenos">248</span></a>            <span class="c1"># Only use numeric columns (skip TIME and any non-numeric)</span>
</span><span id="HARUPLoader-249"><a href="#HARUPLoader-249"><span class="linenos">249</span></a>            <span class="n">sensor_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> 
</span><span id="HARUPLoader-250"><a href="#HARUPLoader-250"><span class="linenos">250</span></a>                             <span class="p">[</span><span class="s1">&#39;subject_id&#39;</span><span class="p">,</span> <span class="s1">&#39;activity_id&#39;</span><span class="p">,</span> <span class="s1">&#39;trial_id&#39;</span><span class="p">,</span> <span class="s1">&#39;activity_label&#39;</span><span class="p">,</span> <span class="s1">&#39;TIME&#39;</span><span class="p">]</span>
</span><span id="HARUPLoader-251"><a href="#HARUPLoader-251"><span class="linenos">251</span></a>                             <span class="ow">and</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])]</span>
</span><span id="HARUPLoader-252"><a href="#HARUPLoader-252"><span class="linenos">252</span></a>            
</span><span id="HARUPLoader-253"><a href="#HARUPLoader-253"><span class="linenos">253</span></a>
</span><span id="HARUPLoader-254"><a href="#HARUPLoader-254"><span class="linenos">254</span></a>            <span class="c1"># Process each sensor column</span>
</span><span id="HARUPLoader-255"><a href="#HARUPLoader-255"><span class="linenos">255</span></a>            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">sensor_columns</span><span class="p">:</span>
</span><span id="HARUPLoader-256"><a href="#HARUPLoader-256"><span class="linenos">256</span></a>                <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">processed_columns</span><span class="p">:</span>
</span><span id="HARUPLoader-257"><a href="#HARUPLoader-257"><span class="linenos">257</span></a>                    
</span><span id="HARUPLoader-258"><a href="#HARUPLoader-258"><span class="linenos">258</span></a>                    <span class="n">window_data</span> <span class="o">=</span> <span class="n">sliding_window</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span><span id="HARUPLoader-259"><a href="#HARUPLoader-259"><span class="linenos">259</span></a>                    <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">col</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">window_data</span><span class="p">})</span>
</span><span id="HARUPLoader-260"><a href="#HARUPLoader-260"><span class="linenos">260</span></a>                    <span class="n">processed_columns</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</span><span id="HARUPLoader-261"><a href="#HARUPLoader-261"><span class="linenos">261</span></a>            
</span><span id="HARUPLoader-262"><a href="#HARUPLoader-262"><span class="linenos">262</span></a>            <span class="c1"># Include activity ID for each window</span>
</span><span id="HARUPLoader-263"><a href="#HARUPLoader-263"><span class="linenos">263</span></a>            <span class="n">activity_windows</span> <span class="o">=</span> <span class="n">sliding_window</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;activity_id&quot;</span><span class="p">],</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span><span id="HARUPLoader-264"><a href="#HARUPLoader-264"><span class="linenos">264</span></a>            <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;activity_id&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">activity_windows</span><span class="p">})</span>
</span><span id="HARUPLoader-265"><a href="#HARUPLoader-265"><span class="linenos">265</span></a>            
</span><span id="HARUPLoader-266"><a href="#HARUPLoader-266"><span class="linenos">266</span></a>            <span class="c1"># For each window, take the most common activity ID as the label</span>
</span><span id="HARUPLoader-267"><a href="#HARUPLoader-267"><span class="linenos">267</span></a>            <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="HARUPLoader-268"><a href="#HARUPLoader-268"><span class="linenos">268</span></a>            <span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">activity_windows</span><span class="p">:</span>
</span><span id="HARUPLoader-269"><a href="#HARUPLoader-269"><span class="linenos">269</span></a>                <span class="c1"># Get most common activity in this window</span>
</span><span id="HARUPLoader-270"><a href="#HARUPLoader-270"><span class="linenos">270</span></a>                <span class="n">unique_vals</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="HARUPLoader-271"><a href="#HARUPLoader-271"><span class="linenos">271</span></a>                <span class="n">most_common_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
</span><span id="HARUPLoader-272"><a href="#HARUPLoader-272"><span class="linenos">272</span></a>                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unique_vals</span><span class="p">[</span><span class="n">most_common_idx</span><span class="p">])</span>
</span><span id="HARUPLoader-273"><a href="#HARUPLoader-273"><span class="linenos">273</span></a>            
</span><span id="HARUPLoader-274"><a href="#HARUPLoader-274"><span class="linenos">274</span></a>            <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">)})</span>
</span><span id="HARUPLoader-275"><a href="#HARUPLoader-275"><span class="linenos">275</span></a>            
</span><span id="HARUPLoader-276"><a href="#HARUPLoader-276"><span class="linenos">276</span></a>            <span class="n">windows_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="s2">&quot;windows&quot;</span><span class="p">:</span> <span class="n">windows</span><span class="p">})</span>
</span><span id="HARUPLoader-277"><a href="#HARUPLoader-277"><span class="linenos">277</span></a>        
</span><span id="HARUPLoader-278"><a href="#HARUPLoader-278"><span class="linenos">278</span></a>        <span class="k">return</span> <span class="n">windows_data</span>
</span><span id="HARUPLoader-279"><a href="#HARUPLoader-279"><span class="linenos">279</span></a>    
</span><span id="HARUPLoader-280"><a href="#HARUPLoader-280"><span class="linenos">280</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extract_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">windows_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">],</span> <span class="n">time_domain_features</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="HARUPLoader-281"><a href="#HARUPLoader-281"><span class="linenos">281</span></a>                       <span class="n">freq_domain_features</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="HARUPLoader-282"><a href="#HARUPLoader-282"><span class="linenos">282</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="HARUPLoader-283"><a href="#HARUPLoader-283"><span class="linenos">283</span></a><span class="sd">        Extract features from sliding windows using HAR-UP feature extraction methods.</span>
</span><span id="HARUPLoader-284"><a href="#HARUPLoader-284"><span class="linenos">284</span></a><span class="sd">        Args:</span>
</span><span id="HARUPLoader-285"><a href="#HARUPLoader-285"><span class="linenos">285</span></a><span class="sd">            windows_data: List of dictionaries containing sliding windows</span>
</span><span id="HARUPLoader-286"><a href="#HARUPLoader-286"><span class="linenos">286</span></a><span class="sd">            time_domain_features: Whether to extract time domain features</span>
</span><span id="HARUPLoader-287"><a href="#HARUPLoader-287"><span class="linenos">287</span></a><span class="sd">            freq_domain_features: Whether to extract frequency domain features</span>
</span><span id="HARUPLoader-288"><a href="#HARUPLoader-288"><span class="linenos">288</span></a><span class="sd">        Returns:</span>
</span><span id="HARUPLoader-289"><a href="#HARUPLoader-289"><span class="linenos">289</span></a><span class="sd">            List of dictionaries containing extracted features</span>
</span><span id="HARUPLoader-290"><a href="#HARUPLoader-290"><span class="linenos">290</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HARUPLoader-291"><a href="#HARUPLoader-291"><span class="linenos">291</span></a>        <span class="c1"># Mapping from original sensor names to actual CSV column names</span>
</span><span id="HARUPLoader-292"><a href="#HARUPLoader-292"><span class="linenos">292</span></a>        <span class="n">sensor_map</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="HARUPLoader-293"><a href="#HARUPLoader-293"><span class="linenos">293</span></a>            <span class="s1">&#39;BeltAccelerometer: x-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;BELT_ACC_X&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-294"><a href="#HARUPLoader-294"><span class="linenos">294</span></a>            <span class="s1">&#39;BeltAccelerometer: y-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;BELT_ACC_Y&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-295"><a href="#HARUPLoader-295"><span class="linenos">295</span></a>            <span class="s1">&#39;BeltAccelerometer: z-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;BELT_ACC_Z&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-296"><a href="#HARUPLoader-296"><span class="linenos">296</span></a>            <span class="s1">&#39;BeltAngularVelocity: x-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;BELT_ANG_X&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-297"><a href="#HARUPLoader-297"><span class="linenos">297</span></a>            <span class="s1">&#39;BeltAngularVelocity: y-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;BELT_ANG_Y&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-298"><a href="#HARUPLoader-298"><span class="linenos">298</span></a>            <span class="s1">&#39;BeltAngularVelocity: z-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;BELT_ANG_Z&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-299"><a href="#HARUPLoader-299"><span class="linenos">299</span></a>            <span class="s1">&#39;BeltLuminosity: illuminance (lx)&#39;</span><span class="p">:</span> <span class="s1">&#39;BELT_LUMINOSITY&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-300"><a href="#HARUPLoader-300"><span class="linenos">300</span></a>            <span class="s1">&#39;NeckAccelerometer: x-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;NECK_ACC_X&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-301"><a href="#HARUPLoader-301"><span class="linenos">301</span></a>            <span class="s1">&#39;NeckAccelerometer: y-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;NECK_ACC_Y&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-302"><a href="#HARUPLoader-302"><span class="linenos">302</span></a>            <span class="s1">&#39;NeckAccelerometer: z-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;NECK_ACC_Z&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-303"><a href="#HARUPLoader-303"><span class="linenos">303</span></a>            <span class="s1">&#39;NeckAngularVelocity: x-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;NECK_ANG_X&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-304"><a href="#HARUPLoader-304"><span class="linenos">304</span></a>            <span class="s1">&#39;NeckAngularVelocity: y-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;NECK_ANG_Y&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-305"><a href="#HARUPLoader-305"><span class="linenos">305</span></a>            <span class="s1">&#39;NeckAngularVelocity: z-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;NECK_ANG_Z&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-306"><a href="#HARUPLoader-306"><span class="linenos">306</span></a>            <span class="s1">&#39;NeckLuminosity: illuminance (lx)&#39;</span><span class="p">:</span> <span class="s1">&#39;NECK_LUMINOSITY&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-307"><a href="#HARUPLoader-307"><span class="linenos">307</span></a>            <span class="s1">&#39;PocketAccelerometer: x-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;PCKT_ACC_X&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-308"><a href="#HARUPLoader-308"><span class="linenos">308</span></a>            <span class="s1">&#39;PocketAccelerometer: y-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;PCKT_ACC_Y&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-309"><a href="#HARUPLoader-309"><span class="linenos">309</span></a>            <span class="s1">&#39;PocketAccelerometer: z-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;PCKT_ACC_Z&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-310"><a href="#HARUPLoader-310"><span class="linenos">310</span></a>            <span class="s1">&#39;PocketAngularVelocity: x-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;PCKT_ANG_X&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-311"><a href="#HARUPLoader-311"><span class="linenos">311</span></a>            <span class="s1">&#39;PocketAngularVelocity: y-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;PCKT_ANG_Y&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-312"><a href="#HARUPLoader-312"><span class="linenos">312</span></a>            <span class="s1">&#39;PocketAngularVelocity: z-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;PCKT_ANG_Z&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-313"><a href="#HARUPLoader-313"><span class="linenos">313</span></a>            <span class="s1">&#39;PocketLuminosity: illuminance (lx)&#39;</span><span class="p">:</span> <span class="s1">&#39;PCKT_LUMINOSITY&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-314"><a href="#HARUPLoader-314"><span class="linenos">314</span></a>            <span class="s1">&#39;WristAccelerometer: x-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;WRST_ACC_X&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-315"><a href="#HARUPLoader-315"><span class="linenos">315</span></a>            <span class="s1">&#39;WristAccelerometer: y-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;WRST_ACC_Y&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-316"><a href="#HARUPLoader-316"><span class="linenos">316</span></a>            <span class="s1">&#39;WristAccelerometer: z-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;WRST_ACC_Z&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-317"><a href="#HARUPLoader-317"><span class="linenos">317</span></a>            <span class="s1">&#39;WristAngularVelocity: x-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;WRST_ANG_X&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-318"><a href="#HARUPLoader-318"><span class="linenos">318</span></a>            <span class="s1">&#39;WristAngularVelocity: y-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;WRST_ANG_Y&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-319"><a href="#HARUPLoader-319"><span class="linenos">319</span></a>            <span class="s1">&#39;WristAngularVelocity: z-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;WRST_ANG_Z&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-320"><a href="#HARUPLoader-320"><span class="linenos">320</span></a>            <span class="s1">&#39;WristLuminosity: illuminance (lx)&#39;</span><span class="p">:</span> <span class="s1">&#39;WRST_LUMINOSITY&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-321"><a href="#HARUPLoader-321"><span class="linenos">321</span></a>            <span class="s1">&#39;BrainSensor&#39;</span><span class="p">:</span> <span class="s1">&#39;HELMET_RAW&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-322"><a href="#HARUPLoader-322"><span class="linenos">322</span></a>            <span class="s1">&#39;Infrared1&#39;</span><span class="p">:</span> <span class="s1">&#39;IR_1&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-323"><a href="#HARUPLoader-323"><span class="linenos">323</span></a>            <span class="s1">&#39;Infrared2&#39;</span><span class="p">:</span> <span class="s1">&#39;IR_2&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-324"><a href="#HARUPLoader-324"><span class="linenos">324</span></a>            <span class="s1">&#39;Infrared3&#39;</span><span class="p">:</span> <span class="s1">&#39;IR_3&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-325"><a href="#HARUPLoader-325"><span class="linenos">325</span></a>            <span class="s1">&#39;Infrared4&#39;</span><span class="p">:</span> <span class="s1">&#39;IR_4&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader-326"><a href="#HARUPLoader-326"><span class="linenos">326</span></a>        <span class="p">}</span>
</span><span id="HARUPLoader-327"><a href="#HARUPLoader-327"><span class="linenos">327</span></a>        <span class="n">extractor</span> <span class="o">=</span> <span class="n">HARUPFeatureExtractor</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="HARUPLoader-328"><a href="#HARUPLoader-328"><span class="linenos">328</span></a>        <span class="n">extractor</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;time_domain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_domain_features</span>
</span><span id="HARUPLoader-329"><a href="#HARUPLoader-329"><span class="linenos">329</span></a>        <span class="n">extractor</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;frequency_domain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">freq_domain_features</span>
</span><span id="HARUPLoader-330"><a href="#HARUPLoader-330"><span class="linenos">330</span></a>        <span class="n">all_features</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="HARUPLoader-331"><a href="#HARUPLoader-331"><span class="linenos">331</span></a>        <span class="k">for</span> <span class="n">window_dict</span> <span class="ow">in</span> <span class="n">windows_data</span><span class="p">:</span>
</span><span id="HARUPLoader-332"><a href="#HARUPLoader-332"><span class="linenos">332</span></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">window_dict</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</span><span id="HARUPLoader-333"><a href="#HARUPLoader-333"><span class="linenos">333</span></a>            <span class="n">windows</span> <span class="o">=</span> <span class="n">window_dict</span><span class="p">[</span><span class="s2">&quot;windows&quot;</span><span class="p">]</span>
</span><span id="HARUPLoader-334"><a href="#HARUPLoader-334"><span class="linenos">334</span></a>            <span class="n">labels</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="HARUPLoader-335"><a href="#HARUPLoader-335"><span class="linenos">335</span></a>            <span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">windows</span><span class="p">:</span>
</span><span id="HARUPLoader-336"><a href="#HARUPLoader-336"><span class="linenos">336</span></a>                <span class="k">if</span> <span class="n">window</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;labels&quot;</span><span class="p">:</span>
</span><span id="HARUPLoader-337"><a href="#HARUPLoader-337"><span class="linenos">337</span></a>                    <span class="n">labels</span> <span class="o">=</span> <span class="n">window</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span>
</span><span id="HARUPLoader-338"><a href="#HARUPLoader-338"><span class="linenos">338</span></a>                    <span class="k">break</span>
</span><span id="HARUPLoader-339"><a href="#HARUPLoader-339"><span class="linenos">339</span></a>            <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="HARUPLoader-340"><a href="#HARUPLoader-340"><span class="linenos">340</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No labels found for </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">, skipping feature extraction&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader-341"><a href="#HARUPLoader-341"><span class="linenos">341</span></a>                <span class="k">continue</span>
</span><span id="HARUPLoader-342"><a href="#HARUPLoader-342"><span class="linenos">342</span></a>            <span class="n">filtered_windows</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="HARUPLoader-343"><a href="#HARUPLoader-343"><span class="linenos">343</span></a>            <span class="n">missing</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="HARUPLoader-344"><a href="#HARUPLoader-344"><span class="linenos">344</span></a>            <span class="k">for</span> <span class="n">orig_sensor</span><span class="p">,</span> <span class="n">csv_col</span> <span class="ow">in</span> <span class="n">sensor_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="HARUPLoader-345"><a href="#HARUPLoader-345"><span class="linenos">345</span></a>                <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="HARUPLoader-346"><a href="#HARUPLoader-346"><span class="linenos">346</span></a>                <span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">windows</span><span class="p">:</span>
</span><span id="HARUPLoader-347"><a href="#HARUPLoader-347"><span class="linenos">347</span></a>                    <span class="k">if</span> <span class="n">window</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">csv_col</span><span class="p">:</span>
</span><span id="HARUPLoader-348"><a href="#HARUPLoader-348"><span class="linenos">348</span></a>                        <span class="n">filtered_windows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
</span><span id="HARUPLoader-349"><a href="#HARUPLoader-349"><span class="linenos">349</span></a>                        <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="HARUPLoader-350"><a href="#HARUPLoader-350"><span class="linenos">350</span></a>                        <span class="k">break</span>
</span><span id="HARUPLoader-351"><a href="#HARUPLoader-351"><span class="linenos">351</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
</span><span id="HARUPLoader-352"><a href="#HARUPLoader-352"><span class="linenos">352</span></a>                    <span class="n">missing</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">orig_sensor</span><span class="p">,</span> <span class="n">csv_col</span><span class="p">))</span>
</span><span id="HARUPLoader-353"><a href="#HARUPLoader-353"><span class="linenos">353</span></a>            <span class="k">if</span> <span class="n">missing</span><span class="p">:</span>
</span><span id="HARUPLoader-354"><a href="#HARUPLoader-354"><span class="linenos">354</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[HARUP] Missing columns for </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">missing</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader-355"><a href="#HARUPLoader-355"><span class="linenos">355</span></a>            <span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">windows</span><span class="p">:</span>
</span><span id="HARUPLoader-356"><a href="#HARUPLoader-356"><span class="linenos">356</span></a>                <span class="k">if</span> <span class="n">window</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;activity_id&quot;</span> <span class="ow">or</span> <span class="n">window</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;labels&quot;</span><span class="p">:</span>
</span><span id="HARUPLoader-357"><a href="#HARUPLoader-357"><span class="linenos">357</span></a>                    <span class="n">filtered_windows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
</span><span id="HARUPLoader-358"><a href="#HARUPLoader-358"><span class="linenos">358</span></a>            <span class="n">features</span> <span class="o">=</span> <span class="n">extractor</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">filtered_windows</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sampling_frequency&#39;</span><span class="p">])</span>
</span><span id="HARUPLoader-359"><a href="#HARUPLoader-359"><span class="linenos">359</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
</span><span id="HARUPLoader-360"><a href="#HARUPLoader-360"><span class="linenos">360</span></a>                <span class="n">window_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">filtered_windows</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Subtract 2 for labels and activity_id</span>
</span><span id="HARUPLoader-361"><a href="#HARUPLoader-361"><span class="linenos">361</span></a>                <span class="k">if</span> <span class="n">window_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
</span><span id="HARUPLoader-362"><a href="#HARUPLoader-362"><span class="linenos">362</span></a>                    <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">window_idx</span><span class="p">]</span>
</span><span id="HARUPLoader-363"><a href="#HARUPLoader-363"><span class="linenos">363</span></a>            <span class="n">all_features</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="n">features</span><span class="p">})</span>
</span><span id="HARUPLoader-364"><a href="#HARUPLoader-364"><span class="linenos">364</span></a>        <span class="k">return</span> <span class="n">all_features</span>
</span><span id="HARUPLoader-365"><a href="#HARUPLoader-365"><span class="linenos">365</span></a>    
</span><span id="HARUPLoader-366"><a href="#HARUPLoader-366"><span class="linenos">366</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_supported_formats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="HARUPLoader-367"><a href="#HARUPLoader-367"><span class="linenos">367</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="HARUPLoader-368"><a href="#HARUPLoader-368"><span class="linenos">368</span></a><span class="sd">        Get list of supported file formats for HAR-UP dataset.</span>
</span><span id="HARUPLoader-369"><a href="#HARUPLoader-369"><span class="linenos">369</span></a><span class="sd">        </span>
</span><span id="HARUPLoader-370"><a href="#HARUPLoader-370"><span class="linenos">370</span></a><span class="sd">        Returns:</span>
</span><span id="HARUPLoader-371"><a href="#HARUPLoader-371"><span class="linenos">371</span></a><span class="sd">            List of supported file extensions</span>
</span><span id="HARUPLoader-372"><a href="#HARUPLoader-372"><span class="linenos">372</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HARUPLoader-373"><a href="#HARUPLoader-373"><span class="linenos">373</span></a>        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;.csv&#39;</span><span class="p">]</span>
</span><span id="HARUPLoader-374"><a href="#HARUPLoader-374"><span class="linenos">374</span></a>    
</span><span id="HARUPLoader-375"><a href="#HARUPLoader-375"><span class="linenos">375</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sensor_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="HARUPLoader-376"><a href="#HARUPLoader-376"><span class="linenos">376</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="HARUPLoader-377"><a href="#HARUPLoader-377"><span class="linenos">377</span></a><span class="sd">        Get information about sensors in the dataset.</span>
</span><span id="HARUPLoader-378"><a href="#HARUPLoader-378"><span class="linenos">378</span></a><span class="sd">        </span>
</span><span id="HARUPLoader-379"><a href="#HARUPLoader-379"><span class="linenos">379</span></a><span class="sd">        Returns:</span>
</span><span id="HARUPLoader-380"><a href="#HARUPLoader-380"><span class="linenos">380</span></a><span class="sd">            Dictionary containing sensor information</span>
</span><span id="HARUPLoader-381"><a href="#HARUPLoader-381"><span class="linenos">381</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HARUPLoader-382"><a href="#HARUPLoader-382"><span class="linenos">382</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="HARUPLoader-383"><a href="#HARUPLoader-383"><span class="linenos">383</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sensors&#39;</span><span class="p">],</span>
</span><span id="HARUPLoader-384"><a href="#HARUPLoader-384"><span class="linenos">384</span></a>            <span class="s1">&#39;components&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;components&#39;</span><span class="p">],</span>
</span><span id="HARUPLoader-385"><a href="#HARUPLoader-385"><span class="linenos">385</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sampling_frequency&#39;</span><span class="p">]</span>
</span><span id="HARUPLoader-386"><a href="#HARUPLoader-386"><span class="linenos">386</span></a>        <span class="p">}</span>
</span><span id="HARUPLoader-387"><a href="#HARUPLoader-387"><span class="linenos">387</span></a>    
</span><span id="HARUPLoader-388"><a href="#HARUPLoader-388"><span class="linenos">388</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_activity_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="HARUPLoader-389"><a href="#HARUPLoader-389"><span class="linenos">389</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="HARUPLoader-390"><a href="#HARUPLoader-390"><span class="linenos">390</span></a><span class="sd">        Get information about activities in the dataset.</span>
</span><span id="HARUPLoader-391"><a href="#HARUPLoader-391"><span class="linenos">391</span></a><span class="sd">        </span>
</span><span id="HARUPLoader-392"><a href="#HARUPLoader-392"><span class="linenos">392</span></a><span class="sd">        Returns:</span>
</span><span id="HARUPLoader-393"><a href="#HARUPLoader-393"><span class="linenos">393</span></a><span class="sd">            Dictionary mapping activity IDs to descriptions</span>
</span><span id="HARUPLoader-394"><a href="#HARUPLoader-394"><span class="linenos">394</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HARUPLoader-395"><a href="#HARUPLoader-395"><span class="linenos">395</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;activities&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>HAR-UP dataset loader class.</p>

<p>This class handles loading and processing of the HAR-UP dataset for human activity recognition
and fall detection analysis.</p>
</div>


                            <div id="HARUPLoader.__init__" class="classattr">
                                        <input id="HARUPLoader.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">HARUPLoader</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span></span>)</span>

                <label class="view-source-button" for="HARUPLoader.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HARUPLoader.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HARUPLoader.__init__-34"><a href="#HARUPLoader.__init__-34"><span class="linenos">34</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">):</span>
</span><span id="HARUPLoader.__init__-35"><a href="#HARUPLoader.__init__-35"><span class="linenos">35</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="HARUPLoader.__init__-36"><a href="#HARUPLoader.__init__-36"><span class="linenos">36</span></a><span class="sd">        Initialize HAR-UP loader with concurrent download support.</span>
</span><span id="HARUPLoader.__init__-37"><a href="#HARUPLoader.__init__-37"><span class="linenos">37</span></a><span class="sd">        </span>
</span><span id="HARUPLoader.__init__-38"><a href="#HARUPLoader.__init__-38"><span class="linenos">38</span></a><span class="sd">        Args:</span>
</span><span id="HARUPLoader.__init__-39"><a href="#HARUPLoader.__init__-39"><span class="linenos">39</span></a><span class="sd">            max_workers: Maximum number of concurrent download threads (default: 8)</span>
</span><span id="HARUPLoader.__init__-40"><a href="#HARUPLoader.__init__-40"><span class="linenos">40</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HARUPLoader.__init__-41"><a href="#HARUPLoader.__init__-41"><span class="linenos">41</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="HARUPLoader.__init__-42"><a href="#HARUPLoader.__init__-42"><span class="linenos">42</span></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;harup&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-43"><a href="#HARUPLoader.__init__-43"><span class="linenos">43</span></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;HAR-UP Dataset - Multimodal System for Fall Detection and Human Activity Recognition&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-44"><a href="#HARUPLoader.__init__-44"><span class="linenos">44</span></a>            <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span>
</span><span id="HARUPLoader.__init__-45"><a href="#HARUPLoader.__init__-45"><span class="linenos">45</span></a>        <span class="p">)</span>
</span><span id="HARUPLoader.__init__-46"><a href="#HARUPLoader.__init__-46"><span class="linenos">46</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="HARUPLoader.__init__-47"><a href="#HARUPLoader.__init__-47"><span class="linenos">47</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="HARUPLoader.__init__-48"><a href="#HARUPLoader.__init__-48"><span class="linenos">48</span></a>                <span class="s1">&#39;AnkleAccelerometer&#39;</span><span class="p">,</span> <span class="s1">&#39;AnkleAngularVelocity&#39;</span><span class="p">,</span> <span class="s1">&#39;AnkleLuminosity&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-49"><a href="#HARUPLoader.__init__-49"><span class="linenos">49</span></a>                <span class="s1">&#39;RightPocketAccelerometer&#39;</span><span class="p">,</span> <span class="s1">&#39;RightPocketAngularVelocity&#39;</span><span class="p">,</span> <span class="s1">&#39;RightPocketLuminosity&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-50"><a href="#HARUPLoader.__init__-50"><span class="linenos">50</span></a>                <span class="s1">&#39;BeltAccelerometer&#39;</span><span class="p">,</span> <span class="s1">&#39;BeltAngularVelocity&#39;</span><span class="p">,</span> <span class="s1">&#39;BeltLuminosity&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-51"><a href="#HARUPLoader.__init__-51"><span class="linenos">51</span></a>                <span class="s1">&#39;NeckAccelerometer&#39;</span><span class="p">,</span> <span class="s1">&#39;NeckAngularVelocity&#39;</span><span class="p">,</span> <span class="s1">&#39;NeckLuminosity&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-52"><a href="#HARUPLoader.__init__-52"><span class="linenos">52</span></a>                <span class="s1">&#39;WristAccelerometer&#39;</span><span class="p">,</span> <span class="s1">&#39;WristAngularVelocity&#39;</span><span class="p">,</span> <span class="s1">&#39;WristLuminosity&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-53"><a href="#HARUPLoader.__init__-53"><span class="linenos">53</span></a>                <span class="s1">&#39;BrainSensor&#39;</span><span class="p">,</span> <span class="s1">&#39;Infrared&#39;</span>
</span><span id="HARUPLoader.__init__-54"><a href="#HARUPLoader.__init__-54"><span class="linenos">54</span></a>            <span class="p">],</span>
</span><span id="HARUPLoader.__init__-55"><a href="#HARUPLoader.__init__-55"><span class="linenos">55</span></a>            <span class="s1">&#39;components&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="HARUPLoader.__init__-56"><a href="#HARUPLoader.__init__-56"><span class="linenos">56</span></a>                <span class="s1">&#39;Accelerometer&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span>
</span><span id="HARUPLoader.__init__-57"><a href="#HARUPLoader.__init__-57"><span class="linenos">57</span></a>                <span class="s1">&#39;AngularVelocity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span>
</span><span id="HARUPLoader.__init__-58"><a href="#HARUPLoader.__init__-58"><span class="linenos">58</span></a>                <span class="s1">&#39;Luminosity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;illuminance&#39;</span><span class="p">],</span>
</span><span id="HARUPLoader.__init__-59"><a href="#HARUPLoader.__init__-59"><span class="linenos">59</span></a>                <span class="s1">&#39;BrainSensor&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">],</span>
</span><span id="HARUPLoader.__init__-60"><a href="#HARUPLoader.__init__-60"><span class="linenos">60</span></a>                <span class="s1">&#39;Infrared&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
</span><span id="HARUPLoader.__init__-61"><a href="#HARUPLoader.__init__-61"><span class="linenos">61</span></a>            <span class="p">},</span>
</span><span id="HARUPLoader.__init__-62"><a href="#HARUPLoader.__init__-62"><span class="linenos">62</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>  <span class="c1"># Hz</span>
</span><span id="HARUPLoader.__init__-63"><a href="#HARUPLoader.__init__-63"><span class="linenos">63</span></a>            <span class="s1">&#39;activities&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="HARUPLoader.__init__-64"><a href="#HARUPLoader.__init__-64"><span class="linenos">64</span></a>                <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Walking&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-65"><a href="#HARUPLoader.__init__-65"><span class="linenos">65</span></a>                <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Walking upstairs&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-66"><a href="#HARUPLoader.__init__-66"><span class="linenos">66</span></a>                <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;Walking downstairs&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-67"><a href="#HARUPLoader.__init__-67"><span class="linenos">67</span></a>                <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;Sitting&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-68"><a href="#HARUPLoader.__init__-68"><span class="linenos">68</span></a>                <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;Standing&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-69"><a href="#HARUPLoader.__init__-69"><span class="linenos">69</span></a>                <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;Lying&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-70"><a href="#HARUPLoader.__init__-70"><span class="linenos">70</span></a>                <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;Falling forward using hands&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-71"><a href="#HARUPLoader.__init__-71"><span class="linenos">71</span></a>                <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;Falling forward using knees&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-72"><a href="#HARUPLoader.__init__-72"><span class="linenos">72</span></a>                <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;Falling backwards&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-73"><a href="#HARUPLoader.__init__-73"><span class="linenos">73</span></a>                <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;Falling sideward&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-74"><a href="#HARUPLoader.__init__-74"><span class="linenos">74</span></a>                <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;Falling sitting in empty chair&#39;</span>
</span><span id="HARUPLoader.__init__-75"><a href="#HARUPLoader.__init__-75"><span class="linenos">75</span></a>            <span class="p">}</span>
</span><span id="HARUPLoader.__init__-76"><a href="#HARUPLoader.__init__-76"><span class="linenos">76</span></a>        <span class="p">}</span>
</span><span id="HARUPLoader.__init__-77"><a href="#HARUPLoader.__init__-77"><span class="linenos">77</span></a>        
</span><span id="HARUPLoader.__init__-78"><a href="#HARUPLoader.__init__-78"><span class="linenos">78</span></a>        <span class="c1"># Features used in HAR-UP</span>
</span><span id="HARUPLoader.__init__-79"><a href="#HARUPLoader.__init__-79"><span class="linenos">79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="HARUPLoader.__init__-80"><a href="#HARUPLoader.__init__-80"><span class="linenos">80</span></a>            <span class="s1">&#39;Mean&#39;</span><span class="p">,</span> <span class="s1">&#39;StandardDeviation&#39;</span><span class="p">,</span> <span class="s1">&#39;RootMeanSquare&#39;</span><span class="p">,</span> <span class="s1">&#39;MaximalAmplitude&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-81"><a href="#HARUPLoader.__init__-81"><span class="linenos">81</span></a>            <span class="s1">&#39;MinimalAmplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Median&#39;</span><span class="p">,</span> <span class="s1">&#39;Number of zero-crossing&#39;</span><span class="p">,</span> <span class="s1">&#39;Skewness&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-82"><a href="#HARUPLoader.__init__-82"><span class="linenos">82</span></a>            <span class="s1">&#39;Kurtosis&#39;</span><span class="p">,</span> <span class="s1">&#39;First Quartile&#39;</span><span class="p">,</span> <span class="s1">&#39;Third Quartile&#39;</span><span class="p">,</span> <span class="s1">&#39;Autocorrelation&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.__init__-83"><a href="#HARUPLoader.__init__-83"><span class="linenos">83</span></a>            <span class="s1">&#39;Energy&#39;</span>
</span><span id="HARUPLoader.__init__-84"><a href="#HARUPLoader.__init__-84"><span class="linenos">84</span></a>        <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Initialize HAR-UP loader with concurrent download support.</p>

<p>Args:
    max_workers: Maximum number of concurrent download threads (default: 8)</p>
</div>


                            </div>
                            <div id="HARUPLoader.metadata" class="classattr">
                                <div class="attr variable">
            <span class="name">metadata</span>

        
    </div>
    <a class="headerlink" href="#HARUPLoader.metadata"></a>
    
    

                            </div>
                            <div id="HARUPLoader.features" class="classattr">
                                <div class="attr variable">
            <span class="name">features</span>

        
    </div>
    <a class="headerlink" href="#HARUPLoader.features"></a>
    
    

                            </div>
                            <div id="HARUPLoader.download_harup_data" class="classattr">
                                        <input id="HARUPLoader.download_harup_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">download_harup_data</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="HARUPLoader.download_harup_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HARUPLoader.download_harup_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HARUPLoader.download_harup_data-86"><a href="#HARUPLoader.download_harup_data-86"><span class="linenos"> 86</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">download_harup_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="HARUPLoader.download_harup_data-87"><a href="#HARUPLoader.download_harup_data-87"><span class="linenos"> 87</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="HARUPLoader.download_harup_data-88"><a href="#HARUPLoader.download_harup_data-88"><span class="linenos"> 88</span></a><span class="sd">        Download HAR-UP dataset if not already present.</span>
</span><span id="HARUPLoader.download_harup_data-89"><a href="#HARUPLoader.download_harup_data-89"><span class="linenos"> 89</span></a><span class="sd">        </span>
</span><span id="HARUPLoader.download_harup_data-90"><a href="#HARUPLoader.download_harup_data-90"><span class="linenos"> 90</span></a><span class="sd">        Args:</span>
</span><span id="HARUPLoader.download_harup_data-91"><a href="#HARUPLoader.download_harup_data-91"><span class="linenos"> 91</span></a><span class="sd">            data_dir: Directory to store the dataset</span>
</span><span id="HARUPLoader.download_harup_data-92"><a href="#HARUPLoader.download_harup_data-92"><span class="linenos"> 92</span></a><span class="sd">            </span>
</span><span id="HARUPLoader.download_harup_data-93"><a href="#HARUPLoader.download_harup_data-93"><span class="linenos"> 93</span></a><span class="sd">        Returns:</span>
</span><span id="HARUPLoader.download_harup_data-94"><a href="#HARUPLoader.download_harup_data-94"><span class="linenos"> 94</span></a><span class="sd">            Path to the extracted dataset or None if not found</span>
</span><span id="HARUPLoader.download_harup_data-95"><a href="#HARUPLoader.download_harup_data-95"><span class="linenos"> 95</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HARUPLoader.download_harup_data-96"><a href="#HARUPLoader.download_harup_data-96"><span class="linenos"> 96</span></a>        <span class="c1"># Use the utility function to download and extract the dataset</span>
</span><span id="HARUPLoader.download_harup_data-97"><a href="#HARUPLoader.download_harup_data-97"><span class="linenos"> 97</span></a>        <span class="n">download_dataset</span><span class="p">(</span><span class="s2">&quot;harup&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</span><span id="HARUPLoader.download_harup_data-98"><a href="#HARUPLoader.download_harup_data-98"><span class="linenos"> 98</span></a>        <span class="n">extract_dataset</span><span class="p">(</span><span class="s2">&quot;harup&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</span><span id="HARUPLoader.download_harup_data-99"><a href="#HARUPLoader.download_harup_data-99"><span class="linenos"> 99</span></a>        
</span><span id="HARUPLoader.download_harup_data-100"><a href="#HARUPLoader.download_harup_data-100"><span class="linenos">100</span></a>        <span class="c1"># Check if dataset exists after download attempt</span>
</span><span id="HARUPLoader.download_harup_data-101"><a href="#HARUPLoader.download_harup_data-101"><span class="linenos">101</span></a>        <span class="n">dataset_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;DataSet&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader.download_harup_data-102"><a href="#HARUPLoader.download_harup_data-102"><span class="linenos">102</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dataset_path</span><span class="p">):</span>
</span><span id="HARUPLoader.download_harup_data-103"><a href="#HARUPLoader.download_harup_data-103"><span class="linenos">103</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;HAR-UP dataset not found after download attempt.&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader.download_harup_data-104"><a href="#HARUPLoader.download_harup_data-104"><span class="linenos">104</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please ensure the dataset is organized in the following structure:&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader.download_harup_data-105"><a href="#HARUPLoader.download_harup_data-105"><span class="linenos">105</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DataSet/Subject</span><span class="si">{i}</span><span class="s2">/Activity</span><span class="si">{j}</span><span class="s2">/Trial</span><span class="si">{k}</span><span class="s2">/Subject</span><span class="si">{i}</span><span class="s2">Activity</span><span class="si">{j}</span><span class="s2">Trial</span><span class="si">{k}</span><span class="s2">.csv&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader.download_harup_data-106"><a href="#HARUPLoader.download_harup_data-106"><span class="linenos">106</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="HARUPLoader.download_harup_data-107"><a href="#HARUPLoader.download_harup_data-107"><span class="linenos">107</span></a>        
</span><span id="HARUPLoader.download_harup_data-108"><a href="#HARUPLoader.download_harup_data-108"><span class="linenos">108</span></a>        <span class="k">return</span> <span class="n">dataset_path</span>
</span></pre></div>


            <div class="docstring"><p>Download HAR-UP dataset if not already present.</p>

<p>Args:
    data_dir: Directory to store the dataset</p>

<p>Returns:
    Path to the extracted dataset or None if not found</p>
</div>


                            </div>
                            <div id="HARUPLoader.load_data" class="classattr">
                                        <input id="HARUPLoader.load_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_data</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">subjects</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">activities</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">trials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="HARUPLoader.load_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HARUPLoader.load_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HARUPLoader.load_data-110"><a href="#HARUPLoader.load_data-110"><span class="linenos">110</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subjects</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
</span><span id="HARUPLoader.load_data-111"><a href="#HARUPLoader.load_data-111"><span class="linenos">111</span></a>                <span class="n">activities</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">trials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="HARUPLoader.load_data-112"><a href="#HARUPLoader.load_data-112"><span class="linenos">112</span></a>                <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="HARUPLoader.load_data-113"><a href="#HARUPLoader.load_data-113"><span class="linenos">113</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="HARUPLoader.load_data-114"><a href="#HARUPLoader.load_data-114"><span class="linenos">114</span></a><span class="sd">        Load HAR-UP dataset from the specified directory.</span>
</span><span id="HARUPLoader.load_data-115"><a href="#HARUPLoader.load_data-115"><span class="linenos">115</span></a><span class="sd">        Args:</span>
</span><span id="HARUPLoader.load_data-116"><a href="#HARUPLoader.load_data-116"><span class="linenos">116</span></a><span class="sd">            data_dir: Directory containing the dataset</span>
</span><span id="HARUPLoader.load_data-117"><a href="#HARUPLoader.load_data-117"><span class="linenos">117</span></a><span class="sd">            subjects: List of subject IDs to load (default: all subjects)</span>
</span><span id="HARUPLoader.load_data-118"><a href="#HARUPLoader.load_data-118"><span class="linenos">118</span></a><span class="sd">            activities: List of activity IDs to load (default: all activities)</span>
</span><span id="HARUPLoader.load_data-119"><a href="#HARUPLoader.load_data-119"><span class="linenos">119</span></a><span class="sd">            trials: List of trial IDs to load (default: all trials)</span>
</span><span id="HARUPLoader.load_data-120"><a href="#HARUPLoader.load_data-120"><span class="linenos">120</span></a><span class="sd">            **kwargs: Additional arguments</span>
</span><span id="HARUPLoader.load_data-121"><a href="#HARUPLoader.load_data-121"><span class="linenos">121</span></a><span class="sd">        Returns:</span>
</span><span id="HARUPLoader.load_data-122"><a href="#HARUPLoader.load_data-122"><span class="linenos">122</span></a><span class="sd">            Tuple of (data_list, names_list)</span>
</span><span id="HARUPLoader.load_data-123"><a href="#HARUPLoader.load_data-123"><span class="linenos">123</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HARUPLoader.load_data-124"><a href="#HARUPLoader.load_data-124"><span class="linenos">124</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
</span><span id="HARUPLoader.load_data-125"><a href="#HARUPLoader.load_data-125"><span class="linenos">125</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="HARUPLoader.load_data-126"><a href="#HARUPLoader.load_data-126"><span class="linenos">126</span></a>        <span class="c1"># Set default values if not provided (HAR-UP: 4 subjects, 11 activities, 3 trials)</span>
</span><span id="HARUPLoader.load_data-127"><a href="#HARUPLoader.load_data-127"><span class="linenos">127</span></a>        <span class="k">if</span> <span class="n">subjects</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="HARUPLoader.load_data-128"><a href="#HARUPLoader.load_data-128"><span class="linenos">128</span></a>            <span class="n">subjects</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>  <span class="c1"># 4 subjects</span>
</span><span id="HARUPLoader.load_data-129"><a href="#HARUPLoader.load_data-129"><span class="linenos">129</span></a>        <span class="k">if</span> <span class="n">activities</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="HARUPLoader.load_data-130"><a href="#HARUPLoader.load_data-130"><span class="linenos">130</span></a>            <span class="n">activities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>  <span class="c1"># 11 activities</span>
</span><span id="HARUPLoader.load_data-131"><a href="#HARUPLoader.load_data-131"><span class="linenos">131</span></a>        <span class="k">if</span> <span class="n">trials</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="HARUPLoader.load_data-132"><a href="#HARUPLoader.load_data-132"><span class="linenos">132</span></a>            <span class="n">trials</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>  <span class="c1"># 3 trials</span>
</span><span id="HARUPLoader.load_data-133"><a href="#HARUPLoader.load_data-133"><span class="linenos">133</span></a>
</span><span id="HARUPLoader.load_data-134"><a href="#HARUPLoader.load_data-134"><span class="linenos">134</span></a>        <span class="c1"># Column names as per official HAR-UP documentation</span>
</span><span id="HARUPLoader.load_data-135"><a href="#HARUPLoader.load_data-135"><span class="linenos">135</span></a>        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="HARUPLoader.load_data-136"><a href="#HARUPLoader.load_data-136"><span class="linenos">136</span></a>            <span class="s2">&quot;Timestamp&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader.load_data-137"><a href="#HARUPLoader.load_data-137"><span class="linenos">137</span></a>            <span class="s2">&quot;EEG_NeuroSky&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader.load_data-138"><a href="#HARUPLoader.load_data-138"><span class="linenos">138</span></a>            <span class="s2">&quot;Belt_Acc_X&quot;</span><span class="p">,</span> <span class="s2">&quot;Belt_Acc_Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Belt_Acc_Z&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader.load_data-139"><a href="#HARUPLoader.load_data-139"><span class="linenos">139</span></a>            <span class="s2">&quot;Belt_Gyro_X&quot;</span><span class="p">,</span> <span class="s2">&quot;Belt_Gyro_Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Belt_Gyro_Z&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader.load_data-140"><a href="#HARUPLoader.load_data-140"><span class="linenos">140</span></a>            <span class="s2">&quot;Belt_Luminosity&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader.load_data-141"><a href="#HARUPLoader.load_data-141"><span class="linenos">141</span></a>            <span class="s2">&quot;Neck_Acc_X&quot;</span><span class="p">,</span> <span class="s2">&quot;Neck_Acc_Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Neck_Acc_Z&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader.load_data-142"><a href="#HARUPLoader.load_data-142"><span class="linenos">142</span></a>            <span class="s2">&quot;Neck_Gyro_X&quot;</span><span class="p">,</span> <span class="s2">&quot;Neck_Gyro_Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Neck_Gyro_Z&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader.load_data-143"><a href="#HARUPLoader.load_data-143"><span class="linenos">143</span></a>            <span class="s2">&quot;Neck_Luminosity&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader.load_data-144"><a href="#HARUPLoader.load_data-144"><span class="linenos">144</span></a>            <span class="s2">&quot;Pocket_Acc_X&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket_Acc_Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket_Acc_Z&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader.load_data-145"><a href="#HARUPLoader.load_data-145"><span class="linenos">145</span></a>            <span class="s2">&quot;Pocket_Gyro_X&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket_Gyro_Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket_Gyro_Z&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader.load_data-146"><a href="#HARUPLoader.load_data-146"><span class="linenos">146</span></a>            <span class="s2">&quot;Pocket_Luminosity&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader.load_data-147"><a href="#HARUPLoader.load_data-147"><span class="linenos">147</span></a>            <span class="s2">&quot;Wrist_Acc_X&quot;</span><span class="p">,</span> <span class="s2">&quot;Wrist_Acc_Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Wrist_Acc_Z&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader.load_data-148"><a href="#HARUPLoader.load_data-148"><span class="linenos">148</span></a>            <span class="s2">&quot;Wrist_Gyro_X&quot;</span><span class="p">,</span> <span class="s2">&quot;Wrist_Gyro_Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Wrist_Gyro_Z&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader.load_data-149"><a href="#HARUPLoader.load_data-149"><span class="linenos">149</span></a>            <span class="s2">&quot;Wrist_Luminosity&quot;</span><span class="p">,</span>
</span><span id="HARUPLoader.load_data-150"><a href="#HARUPLoader.load_data-150"><span class="linenos">150</span></a>            <span class="s2">&quot;Infrared_1&quot;</span><span class="p">,</span> <span class="s2">&quot;Infrared_2&quot;</span><span class="p">,</span> <span class="s2">&quot;Infrared_3&quot;</span><span class="p">,</span> <span class="s2">&quot;Infrared_4&quot;</span>
</span><span id="HARUPLoader.load_data-151"><a href="#HARUPLoader.load_data-151"><span class="linenos">151</span></a>        <span class="p">]</span>
</span><span id="HARUPLoader.load_data-152"><a href="#HARUPLoader.load_data-152"><span class="linenos">152</span></a>
</span><span id="HARUPLoader.load_data-153"><a href="#HARUPLoader.load_data-153"><span class="linenos">153</span></a>        <span class="c1"># If data_dir does not exist, trigger interactive download</span>
</span><span id="HARUPLoader.load_data-154"><a href="#HARUPLoader.load_data-154"><span class="linenos">154</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">data_dir</span><span class="p">):</span>
</span><span id="HARUPLoader.load_data-155"><a href="#HARUPLoader.load_data-155"><span class="linenos">155</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Directory </span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2"> does not exist. Attempting to download HAR-UP dataset...&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader.load_data-156"><a href="#HARUPLoader.load_data-156"><span class="linenos">156</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">download_harup_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</span><span id="HARUPLoader.load_data-157"><a href="#HARUPLoader.load_data-157"><span class="linenos">157</span></a>        <span class="c1"># If still doesn&#39;t exist, error out</span>
</span><span id="HARUPLoader.load_data-158"><a href="#HARUPLoader.load_data-158"><span class="linenos">158</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">data_dir</span><span class="p">):</span>
</span><span id="HARUPLoader.load_data-159"><a href="#HARUPLoader.load_data-159"><span class="linenos">159</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to create or download dataset directory: </span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader.load_data-160"><a href="#HARUPLoader.load_data-160"><span class="linenos">160</span></a>            <span class="k">return</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="HARUPLoader.load_data-161"><a href="#HARUPLoader.load_data-161"><span class="linenos">161</span></a>
</span><span id="HARUPLoader.load_data-162"><a href="#HARUPLoader.load_data-162"><span class="linenos">162</span></a>        <span class="c1"># Find the UP_Fall_Detection_Dataset directory</span>
</span><span id="HARUPLoader.load_data-163"><a href="#HARUPLoader.load_data-163"><span class="linenos">163</span></a>        <span class="n">dataset_path</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="HARUPLoader.load_data-164"><a href="#HARUPLoader.load_data-164"><span class="linenos">164</span></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">data_dir</span><span class="p">):</span>
</span><span id="HARUPLoader.load_data-165"><a href="#HARUPLoader.load_data-165"><span class="linenos">165</span></a>            <span class="n">entry_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span>
</span><span id="HARUPLoader.load_data-166"><a href="#HARUPLoader.load_data-166"><span class="linenos">166</span></a>            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">entry_path</span><span class="p">)</span> <span class="ow">and</span> <span class="n">entry</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;UP_Fall_Detection_Dataset&quot;</span><span class="p">):</span>
</span><span id="HARUPLoader.load_data-167"><a href="#HARUPLoader.load_data-167"><span class="linenos">167</span></a>                <span class="n">dataset_path</span> <span class="o">=</span> <span class="n">entry_path</span>
</span><span id="HARUPLoader.load_data-168"><a href="#HARUPLoader.load_data-168"><span class="linenos">168</span></a>                <span class="k">break</span>
</span><span id="HARUPLoader.load_data-169"><a href="#HARUPLoader.load_data-169"><span class="linenos">169</span></a>        <span class="k">if</span> <span class="n">dataset_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="HARUPLoader.load_data-170"><a href="#HARUPLoader.load_data-170"><span class="linenos">170</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;UP_Fall_Detection_Dataset directory not found in&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</span><span id="HARUPLoader.load_data-171"><a href="#HARUPLoader.load_data-171"><span class="linenos">171</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No data loaded. Please make sure you&#39;ve downloaded the HAR-UP dataset.&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader.load_data-172"><a href="#HARUPLoader.load_data-172"><span class="linenos">172</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Visit https://sites.google.com/up.edu.mx/har-up/ to download the dataset.&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader.load_data-173"><a href="#HARUPLoader.load_data-173"><span class="linenos">173</span></a>            <span class="k">return</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="HARUPLoader.load_data-174"><a href="#HARUPLoader.load_data-174"><span class="linenos">174</span></a>
</span><span id="HARUPLoader.load_data-175"><a href="#HARUPLoader.load_data-175"><span class="linenos">175</span></a>        <span class="n">harup_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="HARUPLoader.load_data-176"><a href="#HARUPLoader.load_data-176"><span class="linenos">176</span></a>        <span class="n">harup_names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="HARUPLoader.load_data-177"><a href="#HARUPLoader.load_data-177"><span class="linenos">177</span></a>
</span><span id="HARUPLoader.load_data-178"><a href="#HARUPLoader.load_data-178"><span class="linenos">178</span></a>        <span class="c1"># Iterate over subjects</span>
</span><span id="HARUPLoader.load_data-179"><a href="#HARUPLoader.load_data-179"><span class="linenos">179</span></a>        <span class="k">for</span> <span class="n">subject_id</span> <span class="ow">in</span> <span class="n">subjects</span><span class="p">:</span>
</span><span id="HARUPLoader.load_data-180"><a href="#HARUPLoader.load_data-180"><span class="linenos">180</span></a>            <span class="n">subject_folder</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Subject_</span><span class="si">{</span><span class="n">subject_id</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="HARUPLoader.load_data-181"><a href="#HARUPLoader.load_data-181"><span class="linenos">181</span></a>            <span class="n">subject_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dataset_path</span><span class="p">,</span> <span class="n">subject_folder</span><span class="p">)</span>
</span><span id="HARUPLoader.load_data-182"><a href="#HARUPLoader.load_data-182"><span class="linenos">182</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">subject_path</span><span class="p">):</span>
</span><span id="HARUPLoader.load_data-183"><a href="#HARUPLoader.load_data-183"><span class="linenos">183</span></a>                <span class="k">continue</span>
</span><span id="HARUPLoader.load_data-184"><a href="#HARUPLoader.load_data-184"><span class="linenos">184</span></a>            
</span><span id="HARUPLoader.load_data-185"><a href="#HARUPLoader.load_data-185"><span class="linenos">185</span></a>            <span class="c1"># Initialize empty DataFrame for this subject</span>
</span><span id="HARUPLoader.load_data-186"><a href="#HARUPLoader.load_data-186"><span class="linenos">186</span></a>            <span class="n">subject_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="HARUPLoader.load_data-187"><a href="#HARUPLoader.load_data-187"><span class="linenos">187</span></a>            
</span><span id="HARUPLoader.load_data-188"><a href="#HARUPLoader.load_data-188"><span class="linenos">188</span></a>            <span class="c1"># Iterate over activities in order</span>
</span><span id="HARUPLoader.load_data-189"><a href="#HARUPLoader.load_data-189"><span class="linenos">189</span></a>            <span class="k">for</span> <span class="n">activity_id</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">activities</span><span class="p">):</span>
</span><span id="HARUPLoader.load_data-190"><a href="#HARUPLoader.load_data-190"><span class="linenos">190</span></a>                <span class="n">activity_folder</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;A</span><span class="si">{</span><span class="n">activity_id</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="HARUPLoader.load_data-191"><a href="#HARUPLoader.load_data-191"><span class="linenos">191</span></a>                <span class="n">activity_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subject_path</span><span class="p">,</span> <span class="n">activity_folder</span><span class="p">)</span>
</span><span id="HARUPLoader.load_data-192"><a href="#HARUPLoader.load_data-192"><span class="linenos">192</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">activity_path</span><span class="p">):</span>
</span><span id="HARUPLoader.load_data-193"><a href="#HARUPLoader.load_data-193"><span class="linenos">193</span></a>                    <span class="k">continue</span>
</span><span id="HARUPLoader.load_data-194"><a href="#HARUPLoader.load_data-194"><span class="linenos">194</span></a>                
</span><span id="HARUPLoader.load_data-195"><a href="#HARUPLoader.load_data-195"><span class="linenos">195</span></a>                <span class="c1"># Iterate over trials in order</span>
</span><span id="HARUPLoader.load_data-196"><a href="#HARUPLoader.load_data-196"><span class="linenos">196</span></a>                <span class="k">for</span> <span class="n">trial_id</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">trials</span><span class="p">):</span>
</span><span id="HARUPLoader.load_data-197"><a href="#HARUPLoader.load_data-197"><span class="linenos">197</span></a>                    <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;S</span><span class="si">{</span><span class="n">subject_id</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">_A</span><span class="si">{</span><span class="n">activity_id</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">_T</span><span class="si">{</span><span class="n">trial_id</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">.csv&quot;</span>
</span><span id="HARUPLoader.load_data-198"><a href="#HARUPLoader.load_data-198"><span class="linenos">198</span></a>                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">activity_path</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
</span><span id="HARUPLoader.load_data-199"><a href="#HARUPLoader.load_data-199"><span class="linenos">199</span></a>                    <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">subject_folder</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">activity_folder</span><span class="si">}</span><span class="s2">_T</span><span class="si">{</span><span class="n">trial_id</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="HARUPLoader.load_data-200"><a href="#HARUPLoader.load_data-200"><span class="linenos">200</span></a>                    
</span><span id="HARUPLoader.load_data-201"><a href="#HARUPLoader.load_data-201"><span class="linenos">201</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="HARUPLoader.load_data-202"><a href="#HARUPLoader.load_data-202"><span class="linenos">202</span></a>                        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="HARUPLoader.load_data-203"><a href="#HARUPLoader.load_data-203"><span class="linenos">203</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[HARUP] Loaded columns for </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader.load_data-204"><a href="#HARUPLoader.load_data-204"><span class="linenos">204</span></a>                        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;subject_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subject_id</span>
</span><span id="HARUPLoader.load_data-205"><a href="#HARUPLoader.load_data-205"><span class="linenos">205</span></a>                        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;activity_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">activity_id</span> 
</span><span id="HARUPLoader.load_data-206"><a href="#HARUPLoader.load_data-206"><span class="linenos">206</span></a>                        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;trial_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trial_id</span>
</span><span id="HARUPLoader.load_data-207"><a href="#HARUPLoader.load_data-207"><span class="linenos">207</span></a>                        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;activity_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;activities&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">activity_id</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;A</span><span class="si">{</span><span class="n">activity_id</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader.load_data-208"><a href="#HARUPLoader.load_data-208"><span class="linenos">208</span></a>                        
</span><span id="HARUPLoader.load_data-209"><a href="#HARUPLoader.load_data-209"><span class="linenos">209</span></a>                        <span class="c1"># Concatenate to subject&#39;s DataFrame</span>
</span><span id="HARUPLoader.load_data-210"><a href="#HARUPLoader.load_data-210"><span class="linenos">210</span></a>                        <span class="n">subject_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">subject_df</span><span class="p">,</span> <span class="n">df</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="HARUPLoader.load_data-211"><a href="#HARUPLoader.load_data-211"><span class="linenos">211</span></a>                        <span class="n">harup_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="HARUPLoader.load_data-212"><a href="#HARUPLoader.load_data-212"><span class="linenos">212</span></a>                        
</span><span id="HARUPLoader.load_data-213"><a href="#HARUPLoader.load_data-213"><span class="linenos">213</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="HARUPLoader.load_data-214"><a href="#HARUPLoader.load_data-214"><span class="linenos">214</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error loading </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader.load_data-215"><a href="#HARUPLoader.load_data-215"><span class="linenos">215</span></a>            
</span><span id="HARUPLoader.load_data-216"><a href="#HARUPLoader.load_data-216"><span class="linenos">216</span></a>            <span class="c1"># Add complete subject DataFrame to data list</span>
</span><span id="HARUPLoader.load_data-217"><a href="#HARUPLoader.load_data-217"><span class="linenos">217</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">subject_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="HARUPLoader.load_data-218"><a href="#HARUPLoader.load_data-218"><span class="linenos">218</span></a>                <span class="n">harup_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subject_df</span><span class="p">)</span>
</span><span id="HARUPLoader.load_data-219"><a href="#HARUPLoader.load_data-219"><span class="linenos">219</span></a>                
</span><span id="HARUPLoader.load_data-220"><a href="#HARUPLoader.load_data-220"><span class="linenos">220</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">harup_data</span>
</span><span id="HARUPLoader.load_data-221"><a href="#HARUPLoader.load_data-221"><span class="linenos">221</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">harup_names</span>
</span><span id="HARUPLoader.load_data-222"><a href="#HARUPLoader.load_data-222"><span class="linenos">222</span></a>
</span><span id="HARUPLoader.load_data-223"><a href="#HARUPLoader.load_data-223"><span class="linenos">223</span></a>        <span class="k">return</span> <span class="n">harup_data</span><span class="p">,</span> <span class="n">harup_names</span>
</span></pre></div>


            <div class="docstring"><p>Load HAR-UP dataset from the specified directory.
Args:
    data_dir: Directory containing the dataset
    subjects: List of subject IDs to load (default: all subjects)
    activities: List of activity IDs to load (default: all activities)
    trials: List of trial IDs to load (default: all trials)
    **kwargs: Additional arguments
Returns:
    Tuple of (data_list, names_list)</p>
</div>


                            </div>
                            <div id="HARUPLoader.create_sliding_windows" class="classattr">
                                        <input id="HARUPLoader.create_sliding_windows-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_sliding_windows</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>,</span><span class="param">	<span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span>,</span><span class="param">	<span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="HARUPLoader.create_sliding_windows-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HARUPLoader.create_sliding_windows"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HARUPLoader.create_sliding_windows-225"><a href="#HARUPLoader.create_sliding_windows-225"><span class="linenos">225</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_sliding_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> 
</span><span id="HARUPLoader.create_sliding_windows-226"><a href="#HARUPLoader.create_sliding_windows-226"><span class="linenos">226</span></a>                             <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="HARUPLoader.create_sliding_windows-227"><a href="#HARUPLoader.create_sliding_windows-227"><span class="linenos">227</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="HARUPLoader.create_sliding_windows-228"><a href="#HARUPLoader.create_sliding_windows-228"><span class="linenos">228</span></a><span class="sd">        Create sliding windows from the HAR-UP dataset.</span>
</span><span id="HARUPLoader.create_sliding_windows-229"><a href="#HARUPLoader.create_sliding_windows-229"><span class="linenos">229</span></a><span class="sd">        </span>
</span><span id="HARUPLoader.create_sliding_windows-230"><a href="#HARUPLoader.create_sliding_windows-230"><span class="linenos">230</span></a><span class="sd">        Args:</span>
</span><span id="HARUPLoader.create_sliding_windows-231"><a href="#HARUPLoader.create_sliding_windows-231"><span class="linenos">231</span></a><span class="sd">            data: List of DataFrames containing HAR-UP data</span>
</span><span id="HARUPLoader.create_sliding_windows-232"><a href="#HARUPLoader.create_sliding_windows-232"><span class="linenos">232</span></a><span class="sd">            names: List of names corresponding to the data</span>
</span><span id="HARUPLoader.create_sliding_windows-233"><a href="#HARUPLoader.create_sliding_windows-233"><span class="linenos">233</span></a><span class="sd">            window_size: Size of the sliding window (default: 100 = 1 second at 100Hz)</span>
</span><span id="HARUPLoader.create_sliding_windows-234"><a href="#HARUPLoader.create_sliding_windows-234"><span class="linenos">234</span></a><span class="sd">            step_size: Step size for the sliding window (default: 50 = 0.5 seconds at 100Hz)</span>
</span><span id="HARUPLoader.create_sliding_windows-235"><a href="#HARUPLoader.create_sliding_windows-235"><span class="linenos">235</span></a><span class="sd">            </span>
</span><span id="HARUPLoader.create_sliding_windows-236"><a href="#HARUPLoader.create_sliding_windows-236"><span class="linenos">236</span></a><span class="sd">        Returns:</span>
</span><span id="HARUPLoader.create_sliding_windows-237"><a href="#HARUPLoader.create_sliding_windows-237"><span class="linenos">237</span></a><span class="sd">            List of dictionaries containing sliding windows for each DataFrame</span>
</span><span id="HARUPLoader.create_sliding_windows-238"><a href="#HARUPLoader.create_sliding_windows-238"><span class="linenos">238</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HARUPLoader.create_sliding_windows-239"><a href="#HARUPLoader.create_sliding_windows-239"><span class="linenos">239</span></a>        <span class="n">windows_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="HARUPLoader.create_sliding_windows-240"><a href="#HARUPLoader.create_sliding_windows-240"><span class="linenos">240</span></a>        
</span><span id="HARUPLoader.create_sliding_windows-241"><a href="#HARUPLoader.create_sliding_windows-241"><span class="linenos">241</span></a>        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span><span id="HARUPLoader.create_sliding_windows-242"><a href="#HARUPLoader.create_sliding_windows-242"><span class="linenos">242</span></a>            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="HARUPLoader.create_sliding_windows-243"><a href="#HARUPLoader.create_sliding_windows-243"><span class="linenos">243</span></a>                <span class="k">continue</span>
</span><span id="HARUPLoader.create_sliding_windows-244"><a href="#HARUPLoader.create_sliding_windows-244"><span class="linenos">244</span></a>                
</span><span id="HARUPLoader.create_sliding_windows-245"><a href="#HARUPLoader.create_sliding_windows-245"><span class="linenos">245</span></a>            <span class="n">windows</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="HARUPLoader.create_sliding_windows-246"><a href="#HARUPLoader.create_sliding_windows-246"><span class="linenos">246</span></a>            <span class="n">processed_columns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="HARUPLoader.create_sliding_windows-247"><a href="#HARUPLoader.create_sliding_windows-247"><span class="linenos">247</span></a>            
</span><span id="HARUPLoader.create_sliding_windows-248"><a href="#HARUPLoader.create_sliding_windows-248"><span class="linenos">248</span></a>            <span class="c1"># Only use numeric columns (skip TIME and any non-numeric)</span>
</span><span id="HARUPLoader.create_sliding_windows-249"><a href="#HARUPLoader.create_sliding_windows-249"><span class="linenos">249</span></a>            <span class="n">sensor_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> 
</span><span id="HARUPLoader.create_sliding_windows-250"><a href="#HARUPLoader.create_sliding_windows-250"><span class="linenos">250</span></a>                             <span class="p">[</span><span class="s1">&#39;subject_id&#39;</span><span class="p">,</span> <span class="s1">&#39;activity_id&#39;</span><span class="p">,</span> <span class="s1">&#39;trial_id&#39;</span><span class="p">,</span> <span class="s1">&#39;activity_label&#39;</span><span class="p">,</span> <span class="s1">&#39;TIME&#39;</span><span class="p">]</span>
</span><span id="HARUPLoader.create_sliding_windows-251"><a href="#HARUPLoader.create_sliding_windows-251"><span class="linenos">251</span></a>                             <span class="ow">and</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])]</span>
</span><span id="HARUPLoader.create_sliding_windows-252"><a href="#HARUPLoader.create_sliding_windows-252"><span class="linenos">252</span></a>            
</span><span id="HARUPLoader.create_sliding_windows-253"><a href="#HARUPLoader.create_sliding_windows-253"><span class="linenos">253</span></a>
</span><span id="HARUPLoader.create_sliding_windows-254"><a href="#HARUPLoader.create_sliding_windows-254"><span class="linenos">254</span></a>            <span class="c1"># Process each sensor column</span>
</span><span id="HARUPLoader.create_sliding_windows-255"><a href="#HARUPLoader.create_sliding_windows-255"><span class="linenos">255</span></a>            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">sensor_columns</span><span class="p">:</span>
</span><span id="HARUPLoader.create_sliding_windows-256"><a href="#HARUPLoader.create_sliding_windows-256"><span class="linenos">256</span></a>                <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">processed_columns</span><span class="p">:</span>
</span><span id="HARUPLoader.create_sliding_windows-257"><a href="#HARUPLoader.create_sliding_windows-257"><span class="linenos">257</span></a>                    
</span><span id="HARUPLoader.create_sliding_windows-258"><a href="#HARUPLoader.create_sliding_windows-258"><span class="linenos">258</span></a>                    <span class="n">window_data</span> <span class="o">=</span> <span class="n">sliding_window</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span><span id="HARUPLoader.create_sliding_windows-259"><a href="#HARUPLoader.create_sliding_windows-259"><span class="linenos">259</span></a>                    <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">col</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">window_data</span><span class="p">})</span>
</span><span id="HARUPLoader.create_sliding_windows-260"><a href="#HARUPLoader.create_sliding_windows-260"><span class="linenos">260</span></a>                    <span class="n">processed_columns</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</span><span id="HARUPLoader.create_sliding_windows-261"><a href="#HARUPLoader.create_sliding_windows-261"><span class="linenos">261</span></a>            
</span><span id="HARUPLoader.create_sliding_windows-262"><a href="#HARUPLoader.create_sliding_windows-262"><span class="linenos">262</span></a>            <span class="c1"># Include activity ID for each window</span>
</span><span id="HARUPLoader.create_sliding_windows-263"><a href="#HARUPLoader.create_sliding_windows-263"><span class="linenos">263</span></a>            <span class="n">activity_windows</span> <span class="o">=</span> <span class="n">sliding_window</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;activity_id&quot;</span><span class="p">],</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span><span id="HARUPLoader.create_sliding_windows-264"><a href="#HARUPLoader.create_sliding_windows-264"><span class="linenos">264</span></a>            <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;activity_id&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">activity_windows</span><span class="p">})</span>
</span><span id="HARUPLoader.create_sliding_windows-265"><a href="#HARUPLoader.create_sliding_windows-265"><span class="linenos">265</span></a>            
</span><span id="HARUPLoader.create_sliding_windows-266"><a href="#HARUPLoader.create_sliding_windows-266"><span class="linenos">266</span></a>            <span class="c1"># For each window, take the most common activity ID as the label</span>
</span><span id="HARUPLoader.create_sliding_windows-267"><a href="#HARUPLoader.create_sliding_windows-267"><span class="linenos">267</span></a>            <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="HARUPLoader.create_sliding_windows-268"><a href="#HARUPLoader.create_sliding_windows-268"><span class="linenos">268</span></a>            <span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">activity_windows</span><span class="p">:</span>
</span><span id="HARUPLoader.create_sliding_windows-269"><a href="#HARUPLoader.create_sliding_windows-269"><span class="linenos">269</span></a>                <span class="c1"># Get most common activity in this window</span>
</span><span id="HARUPLoader.create_sliding_windows-270"><a href="#HARUPLoader.create_sliding_windows-270"><span class="linenos">270</span></a>                <span class="n">unique_vals</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="HARUPLoader.create_sliding_windows-271"><a href="#HARUPLoader.create_sliding_windows-271"><span class="linenos">271</span></a>                <span class="n">most_common_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
</span><span id="HARUPLoader.create_sliding_windows-272"><a href="#HARUPLoader.create_sliding_windows-272"><span class="linenos">272</span></a>                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unique_vals</span><span class="p">[</span><span class="n">most_common_idx</span><span class="p">])</span>
</span><span id="HARUPLoader.create_sliding_windows-273"><a href="#HARUPLoader.create_sliding_windows-273"><span class="linenos">273</span></a>            
</span><span id="HARUPLoader.create_sliding_windows-274"><a href="#HARUPLoader.create_sliding_windows-274"><span class="linenos">274</span></a>            <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">)})</span>
</span><span id="HARUPLoader.create_sliding_windows-275"><a href="#HARUPLoader.create_sliding_windows-275"><span class="linenos">275</span></a>            
</span><span id="HARUPLoader.create_sliding_windows-276"><a href="#HARUPLoader.create_sliding_windows-276"><span class="linenos">276</span></a>            <span class="n">windows_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="s2">&quot;windows&quot;</span><span class="p">:</span> <span class="n">windows</span><span class="p">})</span>
</span><span id="HARUPLoader.create_sliding_windows-277"><a href="#HARUPLoader.create_sliding_windows-277"><span class="linenos">277</span></a>        
</span><span id="HARUPLoader.create_sliding_windows-278"><a href="#HARUPLoader.create_sliding_windows-278"><span class="linenos">278</span></a>        <span class="k">return</span> <span class="n">windows_data</span>
</span></pre></div>


            <div class="docstring"><p>Create sliding windows from the HAR-UP dataset.</p>

<p>Args:
    data: List of DataFrames containing HAR-UP data
    names: List of names corresponding to the data
    window_size: Size of the sliding window (default: 100 = 1 second at 100Hz)
    step_size: Step size for the sliding window (default: 50 = 0.5 seconds at 100Hz)</p>

<p>Returns:
    List of dictionaries containing sliding windows for each DataFrame</p>
</div>


                            </div>
                            <div id="HARUPLoader.extract_features" class="classattr">
                                        <input id="HARUPLoader.extract_features-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">extract_features</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">windows_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span>,</span><span class="param">	<span class="n">time_domain_features</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">freq_domain_features</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="HARUPLoader.extract_features-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HARUPLoader.extract_features"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HARUPLoader.extract_features-280"><a href="#HARUPLoader.extract_features-280"><span class="linenos">280</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extract_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">windows_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">],</span> <span class="n">time_domain_features</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-281"><a href="#HARUPLoader.extract_features-281"><span class="linenos">281</span></a>                       <span class="n">freq_domain_features</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="HARUPLoader.extract_features-282"><a href="#HARUPLoader.extract_features-282"><span class="linenos">282</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="HARUPLoader.extract_features-283"><a href="#HARUPLoader.extract_features-283"><span class="linenos">283</span></a><span class="sd">        Extract features from sliding windows using HAR-UP feature extraction methods.</span>
</span><span id="HARUPLoader.extract_features-284"><a href="#HARUPLoader.extract_features-284"><span class="linenos">284</span></a><span class="sd">        Args:</span>
</span><span id="HARUPLoader.extract_features-285"><a href="#HARUPLoader.extract_features-285"><span class="linenos">285</span></a><span class="sd">            windows_data: List of dictionaries containing sliding windows</span>
</span><span id="HARUPLoader.extract_features-286"><a href="#HARUPLoader.extract_features-286"><span class="linenos">286</span></a><span class="sd">            time_domain_features: Whether to extract time domain features</span>
</span><span id="HARUPLoader.extract_features-287"><a href="#HARUPLoader.extract_features-287"><span class="linenos">287</span></a><span class="sd">            freq_domain_features: Whether to extract frequency domain features</span>
</span><span id="HARUPLoader.extract_features-288"><a href="#HARUPLoader.extract_features-288"><span class="linenos">288</span></a><span class="sd">        Returns:</span>
</span><span id="HARUPLoader.extract_features-289"><a href="#HARUPLoader.extract_features-289"><span class="linenos">289</span></a><span class="sd">            List of dictionaries containing extracted features</span>
</span><span id="HARUPLoader.extract_features-290"><a href="#HARUPLoader.extract_features-290"><span class="linenos">290</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HARUPLoader.extract_features-291"><a href="#HARUPLoader.extract_features-291"><span class="linenos">291</span></a>        <span class="c1"># Mapping from original sensor names to actual CSV column names</span>
</span><span id="HARUPLoader.extract_features-292"><a href="#HARUPLoader.extract_features-292"><span class="linenos">292</span></a>        <span class="n">sensor_map</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="HARUPLoader.extract_features-293"><a href="#HARUPLoader.extract_features-293"><span class="linenos">293</span></a>            <span class="s1">&#39;BeltAccelerometer: x-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;BELT_ACC_X&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-294"><a href="#HARUPLoader.extract_features-294"><span class="linenos">294</span></a>            <span class="s1">&#39;BeltAccelerometer: y-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;BELT_ACC_Y&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-295"><a href="#HARUPLoader.extract_features-295"><span class="linenos">295</span></a>            <span class="s1">&#39;BeltAccelerometer: z-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;BELT_ACC_Z&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-296"><a href="#HARUPLoader.extract_features-296"><span class="linenos">296</span></a>            <span class="s1">&#39;BeltAngularVelocity: x-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;BELT_ANG_X&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-297"><a href="#HARUPLoader.extract_features-297"><span class="linenos">297</span></a>            <span class="s1">&#39;BeltAngularVelocity: y-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;BELT_ANG_Y&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-298"><a href="#HARUPLoader.extract_features-298"><span class="linenos">298</span></a>            <span class="s1">&#39;BeltAngularVelocity: z-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;BELT_ANG_Z&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-299"><a href="#HARUPLoader.extract_features-299"><span class="linenos">299</span></a>            <span class="s1">&#39;BeltLuminosity: illuminance (lx)&#39;</span><span class="p">:</span> <span class="s1">&#39;BELT_LUMINOSITY&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-300"><a href="#HARUPLoader.extract_features-300"><span class="linenos">300</span></a>            <span class="s1">&#39;NeckAccelerometer: x-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;NECK_ACC_X&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-301"><a href="#HARUPLoader.extract_features-301"><span class="linenos">301</span></a>            <span class="s1">&#39;NeckAccelerometer: y-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;NECK_ACC_Y&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-302"><a href="#HARUPLoader.extract_features-302"><span class="linenos">302</span></a>            <span class="s1">&#39;NeckAccelerometer: z-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;NECK_ACC_Z&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-303"><a href="#HARUPLoader.extract_features-303"><span class="linenos">303</span></a>            <span class="s1">&#39;NeckAngularVelocity: x-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;NECK_ANG_X&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-304"><a href="#HARUPLoader.extract_features-304"><span class="linenos">304</span></a>            <span class="s1">&#39;NeckAngularVelocity: y-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;NECK_ANG_Y&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-305"><a href="#HARUPLoader.extract_features-305"><span class="linenos">305</span></a>            <span class="s1">&#39;NeckAngularVelocity: z-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;NECK_ANG_Z&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-306"><a href="#HARUPLoader.extract_features-306"><span class="linenos">306</span></a>            <span class="s1">&#39;NeckLuminosity: illuminance (lx)&#39;</span><span class="p">:</span> <span class="s1">&#39;NECK_LUMINOSITY&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-307"><a href="#HARUPLoader.extract_features-307"><span class="linenos">307</span></a>            <span class="s1">&#39;PocketAccelerometer: x-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;PCKT_ACC_X&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-308"><a href="#HARUPLoader.extract_features-308"><span class="linenos">308</span></a>            <span class="s1">&#39;PocketAccelerometer: y-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;PCKT_ACC_Y&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-309"><a href="#HARUPLoader.extract_features-309"><span class="linenos">309</span></a>            <span class="s1">&#39;PocketAccelerometer: z-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;PCKT_ACC_Z&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-310"><a href="#HARUPLoader.extract_features-310"><span class="linenos">310</span></a>            <span class="s1">&#39;PocketAngularVelocity: x-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;PCKT_ANG_X&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-311"><a href="#HARUPLoader.extract_features-311"><span class="linenos">311</span></a>            <span class="s1">&#39;PocketAngularVelocity: y-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;PCKT_ANG_Y&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-312"><a href="#HARUPLoader.extract_features-312"><span class="linenos">312</span></a>            <span class="s1">&#39;PocketAngularVelocity: z-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;PCKT_ANG_Z&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-313"><a href="#HARUPLoader.extract_features-313"><span class="linenos">313</span></a>            <span class="s1">&#39;PocketLuminosity: illuminance (lx)&#39;</span><span class="p">:</span> <span class="s1">&#39;PCKT_LUMINOSITY&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-314"><a href="#HARUPLoader.extract_features-314"><span class="linenos">314</span></a>            <span class="s1">&#39;WristAccelerometer: x-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;WRST_ACC_X&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-315"><a href="#HARUPLoader.extract_features-315"><span class="linenos">315</span></a>            <span class="s1">&#39;WristAccelerometer: y-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;WRST_ACC_Y&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-316"><a href="#HARUPLoader.extract_features-316"><span class="linenos">316</span></a>            <span class="s1">&#39;WristAccelerometer: z-axis (g)&#39;</span><span class="p">:</span> <span class="s1">&#39;WRST_ACC_Z&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-317"><a href="#HARUPLoader.extract_features-317"><span class="linenos">317</span></a>            <span class="s1">&#39;WristAngularVelocity: x-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;WRST_ANG_X&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-318"><a href="#HARUPLoader.extract_features-318"><span class="linenos">318</span></a>            <span class="s1">&#39;WristAngularVelocity: y-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;WRST_ANG_Y&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-319"><a href="#HARUPLoader.extract_features-319"><span class="linenos">319</span></a>            <span class="s1">&#39;WristAngularVelocity: z-axis (deg/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;WRST_ANG_Z&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-320"><a href="#HARUPLoader.extract_features-320"><span class="linenos">320</span></a>            <span class="s1">&#39;WristLuminosity: illuminance (lx)&#39;</span><span class="p">:</span> <span class="s1">&#39;WRST_LUMINOSITY&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-321"><a href="#HARUPLoader.extract_features-321"><span class="linenos">321</span></a>            <span class="s1">&#39;BrainSensor&#39;</span><span class="p">:</span> <span class="s1">&#39;HELMET_RAW&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-322"><a href="#HARUPLoader.extract_features-322"><span class="linenos">322</span></a>            <span class="s1">&#39;Infrared1&#39;</span><span class="p">:</span> <span class="s1">&#39;IR_1&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-323"><a href="#HARUPLoader.extract_features-323"><span class="linenos">323</span></a>            <span class="s1">&#39;Infrared2&#39;</span><span class="p">:</span> <span class="s1">&#39;IR_2&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-324"><a href="#HARUPLoader.extract_features-324"><span class="linenos">324</span></a>            <span class="s1">&#39;Infrared3&#39;</span><span class="p">:</span> <span class="s1">&#39;IR_3&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-325"><a href="#HARUPLoader.extract_features-325"><span class="linenos">325</span></a>            <span class="s1">&#39;Infrared4&#39;</span><span class="p">:</span> <span class="s1">&#39;IR_4&#39;</span><span class="p">,</span>
</span><span id="HARUPLoader.extract_features-326"><a href="#HARUPLoader.extract_features-326"><span class="linenos">326</span></a>        <span class="p">}</span>
</span><span id="HARUPLoader.extract_features-327"><a href="#HARUPLoader.extract_features-327"><span class="linenos">327</span></a>        <span class="n">extractor</span> <span class="o">=</span> <span class="n">HARUPFeatureExtractor</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="HARUPLoader.extract_features-328"><a href="#HARUPLoader.extract_features-328"><span class="linenos">328</span></a>        <span class="n">extractor</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;time_domain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_domain_features</span>
</span><span id="HARUPLoader.extract_features-329"><a href="#HARUPLoader.extract_features-329"><span class="linenos">329</span></a>        <span class="n">extractor</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;frequency_domain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">freq_domain_features</span>
</span><span id="HARUPLoader.extract_features-330"><a href="#HARUPLoader.extract_features-330"><span class="linenos">330</span></a>        <span class="n">all_features</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="HARUPLoader.extract_features-331"><a href="#HARUPLoader.extract_features-331"><span class="linenos">331</span></a>        <span class="k">for</span> <span class="n">window_dict</span> <span class="ow">in</span> <span class="n">windows_data</span><span class="p">:</span>
</span><span id="HARUPLoader.extract_features-332"><a href="#HARUPLoader.extract_features-332"><span class="linenos">332</span></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">window_dict</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</span><span id="HARUPLoader.extract_features-333"><a href="#HARUPLoader.extract_features-333"><span class="linenos">333</span></a>            <span class="n">windows</span> <span class="o">=</span> <span class="n">window_dict</span><span class="p">[</span><span class="s2">&quot;windows&quot;</span><span class="p">]</span>
</span><span id="HARUPLoader.extract_features-334"><a href="#HARUPLoader.extract_features-334"><span class="linenos">334</span></a>            <span class="n">labels</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="HARUPLoader.extract_features-335"><a href="#HARUPLoader.extract_features-335"><span class="linenos">335</span></a>            <span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">windows</span><span class="p">:</span>
</span><span id="HARUPLoader.extract_features-336"><a href="#HARUPLoader.extract_features-336"><span class="linenos">336</span></a>                <span class="k">if</span> <span class="n">window</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;labels&quot;</span><span class="p">:</span>
</span><span id="HARUPLoader.extract_features-337"><a href="#HARUPLoader.extract_features-337"><span class="linenos">337</span></a>                    <span class="n">labels</span> <span class="o">=</span> <span class="n">window</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span>
</span><span id="HARUPLoader.extract_features-338"><a href="#HARUPLoader.extract_features-338"><span class="linenos">338</span></a>                    <span class="k">break</span>
</span><span id="HARUPLoader.extract_features-339"><a href="#HARUPLoader.extract_features-339"><span class="linenos">339</span></a>            <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="HARUPLoader.extract_features-340"><a href="#HARUPLoader.extract_features-340"><span class="linenos">340</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No labels found for </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">, skipping feature extraction&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader.extract_features-341"><a href="#HARUPLoader.extract_features-341"><span class="linenos">341</span></a>                <span class="k">continue</span>
</span><span id="HARUPLoader.extract_features-342"><a href="#HARUPLoader.extract_features-342"><span class="linenos">342</span></a>            <span class="n">filtered_windows</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="HARUPLoader.extract_features-343"><a href="#HARUPLoader.extract_features-343"><span class="linenos">343</span></a>            <span class="n">missing</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="HARUPLoader.extract_features-344"><a href="#HARUPLoader.extract_features-344"><span class="linenos">344</span></a>            <span class="k">for</span> <span class="n">orig_sensor</span><span class="p">,</span> <span class="n">csv_col</span> <span class="ow">in</span> <span class="n">sensor_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="HARUPLoader.extract_features-345"><a href="#HARUPLoader.extract_features-345"><span class="linenos">345</span></a>                <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="HARUPLoader.extract_features-346"><a href="#HARUPLoader.extract_features-346"><span class="linenos">346</span></a>                <span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">windows</span><span class="p">:</span>
</span><span id="HARUPLoader.extract_features-347"><a href="#HARUPLoader.extract_features-347"><span class="linenos">347</span></a>                    <span class="k">if</span> <span class="n">window</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">csv_col</span><span class="p">:</span>
</span><span id="HARUPLoader.extract_features-348"><a href="#HARUPLoader.extract_features-348"><span class="linenos">348</span></a>                        <span class="n">filtered_windows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
</span><span id="HARUPLoader.extract_features-349"><a href="#HARUPLoader.extract_features-349"><span class="linenos">349</span></a>                        <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="HARUPLoader.extract_features-350"><a href="#HARUPLoader.extract_features-350"><span class="linenos">350</span></a>                        <span class="k">break</span>
</span><span id="HARUPLoader.extract_features-351"><a href="#HARUPLoader.extract_features-351"><span class="linenos">351</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
</span><span id="HARUPLoader.extract_features-352"><a href="#HARUPLoader.extract_features-352"><span class="linenos">352</span></a>                    <span class="n">missing</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">orig_sensor</span><span class="p">,</span> <span class="n">csv_col</span><span class="p">))</span>
</span><span id="HARUPLoader.extract_features-353"><a href="#HARUPLoader.extract_features-353"><span class="linenos">353</span></a>            <span class="k">if</span> <span class="n">missing</span><span class="p">:</span>
</span><span id="HARUPLoader.extract_features-354"><a href="#HARUPLoader.extract_features-354"><span class="linenos">354</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[HARUP] Missing columns for </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">missing</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="HARUPLoader.extract_features-355"><a href="#HARUPLoader.extract_features-355"><span class="linenos">355</span></a>            <span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">windows</span><span class="p">:</span>
</span><span id="HARUPLoader.extract_features-356"><a href="#HARUPLoader.extract_features-356"><span class="linenos">356</span></a>                <span class="k">if</span> <span class="n">window</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;activity_id&quot;</span> <span class="ow">or</span> <span class="n">window</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;labels&quot;</span><span class="p">:</span>
</span><span id="HARUPLoader.extract_features-357"><a href="#HARUPLoader.extract_features-357"><span class="linenos">357</span></a>                    <span class="n">filtered_windows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
</span><span id="HARUPLoader.extract_features-358"><a href="#HARUPLoader.extract_features-358"><span class="linenos">358</span></a>            <span class="n">features</span> <span class="o">=</span> <span class="n">extractor</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">filtered_windows</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sampling_frequency&#39;</span><span class="p">])</span>
</span><span id="HARUPLoader.extract_features-359"><a href="#HARUPLoader.extract_features-359"><span class="linenos">359</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
</span><span id="HARUPLoader.extract_features-360"><a href="#HARUPLoader.extract_features-360"><span class="linenos">360</span></a>                <span class="n">window_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">filtered_windows</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Subtract 2 for labels and activity_id</span>
</span><span id="HARUPLoader.extract_features-361"><a href="#HARUPLoader.extract_features-361"><span class="linenos">361</span></a>                <span class="k">if</span> <span class="n">window_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
</span><span id="HARUPLoader.extract_features-362"><a href="#HARUPLoader.extract_features-362"><span class="linenos">362</span></a>                    <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">window_idx</span><span class="p">]</span>
</span><span id="HARUPLoader.extract_features-363"><a href="#HARUPLoader.extract_features-363"><span class="linenos">363</span></a>            <span class="n">all_features</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="n">features</span><span class="p">})</span>
</span><span id="HARUPLoader.extract_features-364"><a href="#HARUPLoader.extract_features-364"><span class="linenos">364</span></a>        <span class="k">return</span> <span class="n">all_features</span>
</span></pre></div>


            <div class="docstring"><p>Extract features from sliding windows using HAR-UP feature extraction methods.
Args:
    windows_data: List of dictionaries containing sliding windows
    time_domain_features: Whether to extract time domain features
    freq_domain_features: Whether to extract frequency domain features
Returns:
    List of dictionaries containing extracted features</p>
</div>


                            </div>
                            <div id="HARUPLoader.get_supported_formats" class="classattr">
                                        <input id="HARUPLoader.get_supported_formats-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_supported_formats</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="HARUPLoader.get_supported_formats-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HARUPLoader.get_supported_formats"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HARUPLoader.get_supported_formats-366"><a href="#HARUPLoader.get_supported_formats-366"><span class="linenos">366</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_supported_formats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="HARUPLoader.get_supported_formats-367"><a href="#HARUPLoader.get_supported_formats-367"><span class="linenos">367</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="HARUPLoader.get_supported_formats-368"><a href="#HARUPLoader.get_supported_formats-368"><span class="linenos">368</span></a><span class="sd">        Get list of supported file formats for HAR-UP dataset.</span>
</span><span id="HARUPLoader.get_supported_formats-369"><a href="#HARUPLoader.get_supported_formats-369"><span class="linenos">369</span></a><span class="sd">        </span>
</span><span id="HARUPLoader.get_supported_formats-370"><a href="#HARUPLoader.get_supported_formats-370"><span class="linenos">370</span></a><span class="sd">        Returns:</span>
</span><span id="HARUPLoader.get_supported_formats-371"><a href="#HARUPLoader.get_supported_formats-371"><span class="linenos">371</span></a><span class="sd">            List of supported file extensions</span>
</span><span id="HARUPLoader.get_supported_formats-372"><a href="#HARUPLoader.get_supported_formats-372"><span class="linenos">372</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HARUPLoader.get_supported_formats-373"><a href="#HARUPLoader.get_supported_formats-373"><span class="linenos">373</span></a>        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;.csv&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get list of supported file formats for HAR-UP dataset.</p>

<p>Returns:
    List of supported file extensions</p>
</div>


                            </div>
                            <div id="HARUPLoader.get_sensor_info" class="classattr">
                                        <input id="HARUPLoader.get_sensor_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_sensor_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="HARUPLoader.get_sensor_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HARUPLoader.get_sensor_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HARUPLoader.get_sensor_info-375"><a href="#HARUPLoader.get_sensor_info-375"><span class="linenos">375</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sensor_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="HARUPLoader.get_sensor_info-376"><a href="#HARUPLoader.get_sensor_info-376"><span class="linenos">376</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="HARUPLoader.get_sensor_info-377"><a href="#HARUPLoader.get_sensor_info-377"><span class="linenos">377</span></a><span class="sd">        Get information about sensors in the dataset.</span>
</span><span id="HARUPLoader.get_sensor_info-378"><a href="#HARUPLoader.get_sensor_info-378"><span class="linenos">378</span></a><span class="sd">        </span>
</span><span id="HARUPLoader.get_sensor_info-379"><a href="#HARUPLoader.get_sensor_info-379"><span class="linenos">379</span></a><span class="sd">        Returns:</span>
</span><span id="HARUPLoader.get_sensor_info-380"><a href="#HARUPLoader.get_sensor_info-380"><span class="linenos">380</span></a><span class="sd">            Dictionary containing sensor information</span>
</span><span id="HARUPLoader.get_sensor_info-381"><a href="#HARUPLoader.get_sensor_info-381"><span class="linenos">381</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HARUPLoader.get_sensor_info-382"><a href="#HARUPLoader.get_sensor_info-382"><span class="linenos">382</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="HARUPLoader.get_sensor_info-383"><a href="#HARUPLoader.get_sensor_info-383"><span class="linenos">383</span></a>            <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sensors&#39;</span><span class="p">],</span>
</span><span id="HARUPLoader.get_sensor_info-384"><a href="#HARUPLoader.get_sensor_info-384"><span class="linenos">384</span></a>            <span class="s1">&#39;components&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;components&#39;</span><span class="p">],</span>
</span><span id="HARUPLoader.get_sensor_info-385"><a href="#HARUPLoader.get_sensor_info-385"><span class="linenos">385</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sampling_frequency&#39;</span><span class="p">]</span>
</span><span id="HARUPLoader.get_sensor_info-386"><a href="#HARUPLoader.get_sensor_info-386"><span class="linenos">386</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Get information about sensors in the dataset.</p>

<p>Returns:
    Dictionary containing sensor information</p>
</div>


                            </div>
                            <div id="HARUPLoader.get_activity_info" class="classattr">
                                        <input id="HARUPLoader.get_activity_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_activity_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="HARUPLoader.get_activity_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HARUPLoader.get_activity_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HARUPLoader.get_activity_info-388"><a href="#HARUPLoader.get_activity_info-388"><span class="linenos">388</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_activity_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="HARUPLoader.get_activity_info-389"><a href="#HARUPLoader.get_activity_info-389"><span class="linenos">389</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="HARUPLoader.get_activity_info-390"><a href="#HARUPLoader.get_activity_info-390"><span class="linenos">390</span></a><span class="sd">        Get information about activities in the dataset.</span>
</span><span id="HARUPLoader.get_activity_info-391"><a href="#HARUPLoader.get_activity_info-391"><span class="linenos">391</span></a><span class="sd">        </span>
</span><span id="HARUPLoader.get_activity_info-392"><a href="#HARUPLoader.get_activity_info-392"><span class="linenos">392</span></a><span class="sd">        Returns:</span>
</span><span id="HARUPLoader.get_activity_info-393"><a href="#HARUPLoader.get_activity_info-393"><span class="linenos">393</span></a><span class="sd">            Dictionary mapping activity IDs to descriptions</span>
</span><span id="HARUPLoader.get_activity_info-394"><a href="#HARUPLoader.get_activity_info-394"><span class="linenos">394</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HARUPLoader.get_activity_info-395"><a href="#HARUPLoader.get_activity_info-395"><span class="linenos">395</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;activities&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get information about activities in the dataset.</p>

<p>Returns:
    Dictionary mapping activity IDs to descriptions</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="core/base_classes.html#BaseDatasetLoader">gaitsetpy.core.base_classes.BaseDatasetLoader</a></dt>
                                <dd id="HARUPLoader.name" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.name">name</a></dd>
                <dd id="HARUPLoader.description" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.description">description</a></dd>
                <dd id="HARUPLoader.data" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.data">data</a></dd>
                <dd id="HARUPLoader.max_workers" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.max_workers">max_workers</a></dd>
                <dd id="HARUPLoader.download_files_concurrent" class="function"><a href="core/base_classes.html#BaseDatasetLoader.download_files_concurrent">download_files_concurrent</a></dd>
                <dd id="HARUPLoader.set_max_workers" class="function"><a href="core/base_classes.html#BaseDatasetLoader.set_max_workers">set_max_workers</a></dd>
                <dd id="HARUPLoader.get_download_stats" class="function"><a href="core/base_classes.html#BaseDatasetLoader.get_download_stats">get_download_stats</a></dd>
                <dd id="HARUPLoader.get_info" class="function"><a href="core/base_classes.html#BaseDatasetLoader.get_info">get_info</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="UrFallLoader">
                            <input id="UrFallLoader-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">UrFallLoader</span><wbr>(<span class="base"><a href="core/base_classes.html#BaseDatasetLoader">gaitsetpy.core.base_classes.BaseDatasetLoader</a></span>):

                <label class="view-source-button" for="UrFallLoader-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#UrFallLoader"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="UrFallLoader-24"><a href="#UrFallLoader-24"><span class="linenos"> 24</span></a><span class="k">class</span><span class="w"> </span><span class="nc">UrFallLoader</span><span class="p">(</span><span class="n">BaseDatasetLoader</span><span class="p">):</span>
</span><span id="UrFallLoader-25"><a href="#UrFallLoader-25"><span class="linenos"> 25</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader-26"><a href="#UrFallLoader-26"><span class="linenos"> 26</span></a><span class="sd">    UrFall dataset loader class.</span>
</span><span id="UrFallLoader-27"><a href="#UrFallLoader-27"><span class="linenos"> 27</span></a><span class="sd">    </span>
</span><span id="UrFallLoader-28"><a href="#UrFallLoader-28"><span class="linenos"> 28</span></a><span class="sd">    This class handles loading and processing of the UrFall dataset for fall detection.</span>
</span><span id="UrFallLoader-29"><a href="#UrFallLoader-29"><span class="linenos"> 29</span></a><span class="sd">    Supports multiple data types: Depth, RGB, Accelerometer, Synchronization, Video,</span>
</span><span id="UrFallLoader-30"><a href="#UrFallLoader-30"><span class="linenos"> 30</span></a><span class="sd">    and pre-extracted features from depth maps.</span>
</span><span id="UrFallLoader-31"><a href="#UrFallLoader-31"><span class="linenos"> 31</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="UrFallLoader-32"><a href="#UrFallLoader-32"><span class="linenos"> 32</span></a>    
</span><span id="UrFallLoader-33"><a href="#UrFallLoader-33"><span class="linenos"> 33</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">):</span>
</span><span id="UrFallLoader-34"><a href="#UrFallLoader-34"><span class="linenos"> 34</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader-35"><a href="#UrFallLoader-35"><span class="linenos"> 35</span></a><span class="sd">        Initialize UrFall loader with concurrent download support.</span>
</span><span id="UrFallLoader-36"><a href="#UrFallLoader-36"><span class="linenos"> 36</span></a><span class="sd">        </span>
</span><span id="UrFallLoader-37"><a href="#UrFallLoader-37"><span class="linenos"> 37</span></a><span class="sd">        Args:</span>
</span><span id="UrFallLoader-38"><a href="#UrFallLoader-38"><span class="linenos"> 38</span></a><span class="sd">            max_workers: Maximum number of concurrent download threads (default: 8)</span>
</span><span id="UrFallLoader-39"><a href="#UrFallLoader-39"><span class="linenos"> 39</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UrFallLoader-40"><a href="#UrFallLoader-40"><span class="linenos"> 40</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="UrFallLoader-41"><a href="#UrFallLoader-41"><span class="linenos"> 41</span></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;urfall&quot;</span><span class="p">,</span>
</span><span id="UrFallLoader-42"><a href="#UrFallLoader-42"><span class="linenos"> 42</span></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;UrFall Dataset - University of Rzeszow Fall Detection Dataset with multimodal data&quot;</span><span class="p">,</span>
</span><span id="UrFallLoader-43"><a href="#UrFallLoader-43"><span class="linenos"> 43</span></a>            <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span>
</span><span id="UrFallLoader-44"><a href="#UrFallLoader-44"><span class="linenos"> 44</span></a>        <span class="p">)</span>
</span><span id="UrFallLoader-45"><a href="#UrFallLoader-45"><span class="linenos"> 45</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="UrFallLoader-46"><a href="#UrFallLoader-46"><span class="linenos"> 46</span></a>            <span class="s1">&#39;data_types&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">,</span> <span class="s1">&#39;rgb&#39;</span><span class="p">,</span> <span class="s1">&#39;accelerometer&#39;</span><span class="p">,</span> <span class="s1">&#39;synchronization&#39;</span><span class="p">,</span> <span class="s1">&#39;video&#39;</span><span class="p">,</span> <span class="s1">&#39;features&#39;</span><span class="p">],</span>
</span><span id="UrFallLoader-47"><a href="#UrFallLoader-47"><span class="linenos"> 47</span></a>            <span class="s1">&#39;camera&#39;</span><span class="p">:</span> <span class="s1">&#39;cam0&#39;</span><span class="p">,</span>  <span class="c1"># Front camera</span>
</span><span id="UrFallLoader-48"><a href="#UrFallLoader-48"><span class="linenos"> 48</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>  <span class="c1"># Depth/RGB camera fps</span>
</span><span id="UrFallLoader-49"><a href="#UrFallLoader-49"><span class="linenos"> 49</span></a>            <span class="s1">&#39;accelerometer_frequency&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>  <span class="c1"># Accelerometer sampling frequency (typical)</span>
</span><span id="UrFallLoader-50"><a href="#UrFallLoader-50"><span class="linenos"> 50</span></a>            <span class="s1">&#39;activities&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="UrFallLoader-51"><a href="#UrFallLoader-51"><span class="linenos"> 51</span></a>                <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Not lying (standing/walking)&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-52"><a href="#UrFallLoader-52"><span class="linenos"> 52</span></a>                <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Falling (transient)&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-53"><a href="#UrFallLoader-53"><span class="linenos"> 53</span></a>                <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Lying on ground&#39;</span>
</span><span id="UrFallLoader-54"><a href="#UrFallLoader-54"><span class="linenos"> 54</span></a>            <span class="p">},</span>
</span><span id="UrFallLoader-55"><a href="#UrFallLoader-55"><span class="linenos"> 55</span></a>            <span class="s1">&#39;fall_sequences&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">31</span><span class="p">)),</span>  <span class="c1"># fall-01 to fall-30</span>
</span><span id="UrFallLoader-56"><a href="#UrFallLoader-56"><span class="linenos"> 56</span></a>            <span class="s1">&#39;adl_sequences&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)),</span>  <span class="c1"># adl-01 to adl-20</span>
</span><span id="UrFallLoader-57"><a href="#UrFallLoader-57"><span class="linenos"> 57</span></a>            <span class="s1">&#39;feature_columns&#39;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="UrFallLoader-58"><a href="#UrFallLoader-58"><span class="linenos"> 58</span></a>                <span class="s1">&#39;sequence_name&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-59"><a href="#UrFallLoader-59"><span class="linenos"> 59</span></a>                <span class="s1">&#39;frame_number&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-60"><a href="#UrFallLoader-60"><span class="linenos"> 60</span></a>                <span class="s1">&#39;label&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-61"><a href="#UrFallLoader-61"><span class="linenos"> 61</span></a>                <span class="s1">&#39;HeightWidthRatio&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-62"><a href="#UrFallLoader-62"><span class="linenos"> 62</span></a>                <span class="s1">&#39;MajorMinorRatio&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-63"><a href="#UrFallLoader-63"><span class="linenos"> 63</span></a>                <span class="s1">&#39;BoundingBoxOccupancy&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-64"><a href="#UrFallLoader-64"><span class="linenos"> 64</span></a>                <span class="s1">&#39;MaxStdXZ&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-65"><a href="#UrFallLoader-65"><span class="linenos"> 65</span></a>                <span class="s1">&#39;HHmaxRatio&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-66"><a href="#UrFallLoader-66"><span class="linenos"> 66</span></a>                <span class="s1">&#39;H&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-67"><a href="#UrFallLoader-67"><span class="linenos"> 67</span></a>                <span class="s1">&#39;D&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-68"><a href="#UrFallLoader-68"><span class="linenos"> 68</span></a>                <span class="s1">&#39;P40&#39;</span>
</span><span id="UrFallLoader-69"><a href="#UrFallLoader-69"><span class="linenos"> 69</span></a>            <span class="p">],</span>
</span><span id="UrFallLoader-70"><a href="#UrFallLoader-70"><span class="linenos"> 70</span></a>            <span class="s1">&#39;feature_descriptions&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="UrFallLoader-71"><a href="#UrFallLoader-71"><span class="linenos"> 71</span></a>                <span class="s1">&#39;HeightWidthRatio&#39;</span><span class="p">:</span> <span class="s1">&#39;Bounding box height to width ratio&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-72"><a href="#UrFallLoader-72"><span class="linenos"> 72</span></a>                <span class="s1">&#39;MajorMinorRatio&#39;</span><span class="p">:</span> <span class="s1">&#39;Major to minor axis ratio from BLOB segmentation&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-73"><a href="#UrFallLoader-73"><span class="linenos"> 73</span></a>                <span class="s1">&#39;BoundingBoxOccupancy&#39;</span><span class="p">:</span> <span class="s1">&#39;Ratio of bounding box occupied by person pixels&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-74"><a href="#UrFallLoader-74"><span class="linenos"> 74</span></a>                <span class="s1">&#39;MaxStdXZ&#39;</span><span class="p">:</span> <span class="s1">&#39;Standard deviation of pixels from centroid (X and Z axis)&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-75"><a href="#UrFallLoader-75"><span class="linenos"> 75</span></a>                <span class="s1">&#39;HHmaxRatio&#39;</span><span class="p">:</span> <span class="s1">&#39;Human height in frame to standing height ratio&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-76"><a href="#UrFallLoader-76"><span class="linenos"> 76</span></a>                <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="s1">&#39;Actual height in mm&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-77"><a href="#UrFallLoader-77"><span class="linenos"> 77</span></a>                <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="s1">&#39;Distance of person center to floor in mm&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-78"><a href="#UrFallLoader-78"><span class="linenos"> 78</span></a>                <span class="s1">&#39;P40&#39;</span><span class="p">:</span> <span class="s1">&#39;Ratio of point clouds in 40cm cuboid to full height cuboid&#39;</span>
</span><span id="UrFallLoader-79"><a href="#UrFallLoader-79"><span class="linenos"> 79</span></a>            <span class="p">}</span>
</span><span id="UrFallLoader-80"><a href="#UrFallLoader-80"><span class="linenos"> 80</span></a>        <span class="p">}</span>
</span><span id="UrFallLoader-81"><a href="#UrFallLoader-81"><span class="linenos"> 81</span></a>    
</span><span id="UrFallLoader-82"><a href="#UrFallLoader-82"><span class="linenos"> 82</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
</span><span id="UrFallLoader-83"><a href="#UrFallLoader-83"><span class="linenos"> 83</span></a>                  <span class="n">data_types</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="UrFallLoader-84"><a href="#UrFallLoader-84"><span class="linenos"> 84</span></a>                  <span class="n">sequences</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="UrFallLoader-85"><a href="#UrFallLoader-85"><span class="linenos"> 85</span></a>                  <span class="n">use_falls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="UrFallLoader-86"><a href="#UrFallLoader-86"><span class="linenos"> 86</span></a>                  <span class="n">use_adls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="UrFallLoader-87"><a href="#UrFallLoader-87"><span class="linenos"> 87</span></a>                  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="UrFallLoader-88"><a href="#UrFallLoader-88"><span class="linenos"> 88</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader-89"><a href="#UrFallLoader-89"><span class="linenos"> 89</span></a><span class="sd">        Load UrFall dataset from the specified directory.</span>
</span><span id="UrFallLoader-90"><a href="#UrFallLoader-90"><span class="linenos"> 90</span></a><span class="sd">        </span>
</span><span id="UrFallLoader-91"><a href="#UrFallLoader-91"><span class="linenos"> 91</span></a><span class="sd">        Args:</span>
</span><span id="UrFallLoader-92"><a href="#UrFallLoader-92"><span class="linenos"> 92</span></a><span class="sd">            data_dir: Directory containing the dataset</span>
</span><span id="UrFallLoader-93"><a href="#UrFallLoader-93"><span class="linenos"> 93</span></a><span class="sd">            data_types: List of data types to load. Options: &#39;depth&#39;, &#39;rgb&#39;, &#39;accelerometer&#39;,</span>
</span><span id="UrFallLoader-94"><a href="#UrFallLoader-94"><span class="linenos"> 94</span></a><span class="sd">                       &#39;synchronization&#39;, &#39;video&#39;, &#39;features&#39; (default: [&#39;features&#39;])</span>
</span><span id="UrFallLoader-95"><a href="#UrFallLoader-95"><span class="linenos"> 95</span></a><span class="sd">            sequences: List of specific sequences to load (e.g., [&#39;fall-01&#39;, &#39;adl-01&#39;])</span>
</span><span id="UrFallLoader-96"><a href="#UrFallLoader-96"><span class="linenos"> 96</span></a><span class="sd">                      If None, loads all based on use_falls and use_adls</span>
</span><span id="UrFallLoader-97"><a href="#UrFallLoader-97"><span class="linenos"> 97</span></a><span class="sd">            use_falls: Whether to load fall sequences (default: True)</span>
</span><span id="UrFallLoader-98"><a href="#UrFallLoader-98"><span class="linenos"> 98</span></a><span class="sd">            use_adls: Whether to load ADL (Activities of Daily Living) sequences (default: True)</span>
</span><span id="UrFallLoader-99"><a href="#UrFallLoader-99"><span class="linenos"> 99</span></a><span class="sd">            **kwargs: Additional arguments</span>
</span><span id="UrFallLoader-100"><a href="#UrFallLoader-100"><span class="linenos">100</span></a><span class="sd">            </span>
</span><span id="UrFallLoader-101"><a href="#UrFallLoader-101"><span class="linenos">101</span></a><span class="sd">        Returns:</span>
</span><span id="UrFallLoader-102"><a href="#UrFallLoader-102"><span class="linenos">102</span></a><span class="sd">            Tuple of (data_list, names_list)</span>
</span><span id="UrFallLoader-103"><a href="#UrFallLoader-103"><span class="linenos">103</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UrFallLoader-104"><a href="#UrFallLoader-104"><span class="linenos">104</span></a>        <span class="c1"># Default to loading pre-extracted features if not specified</span>
</span><span id="UrFallLoader-105"><a href="#UrFallLoader-105"><span class="linenos">105</span></a>        <span class="k">if</span> <span class="n">data_types</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="UrFallLoader-106"><a href="#UrFallLoader-106"><span class="linenos">106</span></a>            <span class="n">data_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">]</span>
</span><span id="UrFallLoader-107"><a href="#UrFallLoader-107"><span class="linenos">107</span></a>        
</span><span id="UrFallLoader-108"><a href="#UrFallLoader-108"><span class="linenos">108</span></a>        <span class="c1"># Validate data types</span>
</span><span id="UrFallLoader-109"><a href="#UrFallLoader-109"><span class="linenos">109</span></a>        <span class="n">valid_types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;data_types&#39;</span><span class="p">])</span>
</span><span id="UrFallLoader-110"><a href="#UrFallLoader-110"><span class="linenos">110</span></a>        <span class="n">requested_types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">data_types</span><span class="p">)</span>
</span><span id="UrFallLoader-111"><a href="#UrFallLoader-111"><span class="linenos">111</span></a>        <span class="n">invalid_types</span> <span class="o">=</span> <span class="n">requested_types</span> <span class="o">-</span> <span class="n">valid_types</span>
</span><span id="UrFallLoader-112"><a href="#UrFallLoader-112"><span class="linenos">112</span></a>        <span class="k">if</span> <span class="n">invalid_types</span><span class="p">:</span>
</span><span id="UrFallLoader-113"><a href="#UrFallLoader-113"><span class="linenos">113</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid data types: </span><span class="si">{</span><span class="n">invalid_types</span><span class="si">}</span><span class="s2">. Valid types: </span><span class="si">{</span><span class="n">valid_types</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader-114"><a href="#UrFallLoader-114"><span class="linenos">114</span></a>        
</span><span id="UrFallLoader-115"><a href="#UrFallLoader-115"><span class="linenos">115</span></a>        <span class="c1"># Create directory if it doesn&#39;t exist</span>
</span><span id="UrFallLoader-116"><a href="#UrFallLoader-116"><span class="linenos">116</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="UrFallLoader-117"><a href="#UrFallLoader-117"><span class="linenos">117</span></a>        
</span><span id="UrFallLoader-118"><a href="#UrFallLoader-118"><span class="linenos">118</span></a>        <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader-119"><a href="#UrFallLoader-119"><span class="linenos">119</span></a>        <span class="n">names_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader-120"><a href="#UrFallLoader-120"><span class="linenos">120</span></a>        
</span><span id="UrFallLoader-121"><a href="#UrFallLoader-121"><span class="linenos">121</span></a>        <span class="c1"># Load pre-extracted features (CSV files)</span>
</span><span id="UrFallLoader-122"><a href="#UrFallLoader-122"><span class="linenos">122</span></a>        <span class="k">if</span> <span class="s1">&#39;features&#39;</span> <span class="ow">in</span> <span class="n">data_types</span><span class="p">:</span>
</span><span id="UrFallLoader-123"><a href="#UrFallLoader-123"><span class="linenos">123</span></a>            <span class="n">features_data</span><span class="p">,</span> <span class="n">features_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_features</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">sequences</span><span class="p">,</span> <span class="n">use_falls</span><span class="p">,</span> <span class="n">use_adls</span><span class="p">)</span>
</span><span id="UrFallLoader-124"><a href="#UrFallLoader-124"><span class="linenos">124</span></a>            <span class="n">data_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">features_data</span><span class="p">)</span>
</span><span id="UrFallLoader-125"><a href="#UrFallLoader-125"><span class="linenos">125</span></a>            <span class="n">names_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">features_names</span><span class="p">)</span>
</span><span id="UrFallLoader-126"><a href="#UrFallLoader-126"><span class="linenos">126</span></a>        
</span><span id="UrFallLoader-127"><a href="#UrFallLoader-127"><span class="linenos">127</span></a>        <span class="c1"># Load raw accelerometer data</span>
</span><span id="UrFallLoader-128"><a href="#UrFallLoader-128"><span class="linenos">128</span></a>        <span class="k">if</span> <span class="s1">&#39;accelerometer&#39;</span> <span class="ow">in</span> <span class="n">data_types</span><span class="p">:</span>
</span><span id="UrFallLoader-129"><a href="#UrFallLoader-129"><span class="linenos">129</span></a>            <span class="n">accel_data</span><span class="p">,</span> <span class="n">accel_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_accelerometer</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">sequences</span><span class="p">,</span> <span class="n">use_falls</span><span class="p">,</span> <span class="n">use_adls</span><span class="p">)</span>
</span><span id="UrFallLoader-130"><a href="#UrFallLoader-130"><span class="linenos">130</span></a>            <span class="n">data_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">accel_data</span><span class="p">)</span>
</span><span id="UrFallLoader-131"><a href="#UrFallLoader-131"><span class="linenos">131</span></a>            <span class="n">names_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">accel_names</span><span class="p">)</span>
</span><span id="UrFallLoader-132"><a href="#UrFallLoader-132"><span class="linenos">132</span></a>        
</span><span id="UrFallLoader-133"><a href="#UrFallLoader-133"><span class="linenos">133</span></a>        <span class="c1"># Load synchronization data</span>
</span><span id="UrFallLoader-134"><a href="#UrFallLoader-134"><span class="linenos">134</span></a>        <span class="k">if</span> <span class="s1">&#39;synchronization&#39;</span> <span class="ow">in</span> <span class="n">data_types</span><span class="p">:</span>
</span><span id="UrFallLoader-135"><a href="#UrFallLoader-135"><span class="linenos">135</span></a>            <span class="n">sync_data</span><span class="p">,</span> <span class="n">sync_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_synchronization</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">sequences</span><span class="p">,</span> <span class="n">use_falls</span><span class="p">,</span> <span class="n">use_adls</span><span class="p">)</span>
</span><span id="UrFallLoader-136"><a href="#UrFallLoader-136"><span class="linenos">136</span></a>            <span class="n">data_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sync_data</span><span class="p">)</span>
</span><span id="UrFallLoader-137"><a href="#UrFallLoader-137"><span class="linenos">137</span></a>            <span class="n">names_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sync_names</span><span class="p">)</span>
</span><span id="UrFallLoader-138"><a href="#UrFallLoader-138"><span class="linenos">138</span></a>        
</span><span id="UrFallLoader-139"><a href="#UrFallLoader-139"><span class="linenos">139</span></a>        <span class="c1"># Note: Depth, RGB, and Video data are image/video files</span>
</span><span id="UrFallLoader-140"><a href="#UrFallLoader-140"><span class="linenos">140</span></a>        <span class="c1"># These would require specialized loading and are not typically loaded into DataFrames</span>
</span><span id="UrFallLoader-141"><a href="#UrFallLoader-141"><span class="linenos">141</span></a>        <span class="k">if</span> <span class="s1">&#39;depth&#39;</span> <span class="ow">in</span> <span class="n">data_types</span> <span class="ow">or</span> <span class="s1">&#39;rgb&#39;</span> <span class="ow">in</span> <span class="n">data_types</span> <span class="ow">or</span> <span class="s1">&#39;video&#39;</span> <span class="ow">in</span> <span class="n">data_types</span><span class="p">:</span>
</span><span id="UrFallLoader-142"><a href="#UrFallLoader-142"><span class="linenos">142</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Note: Depth, RGB, and Video data types contain image/video files.&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader-143"><a href="#UrFallLoader-143"><span class="linenos">143</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;These are not loaded into DataFrames but their paths can be accessed.&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader-144"><a href="#UrFallLoader-144"><span class="linenos">144</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Use the get_file_paths() method to retrieve paths to these files.&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader-145"><a href="#UrFallLoader-145"><span class="linenos">145</span></a>        
</span><span id="UrFallLoader-146"><a href="#UrFallLoader-146"><span class="linenos">146</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data_list</span>
</span><span id="UrFallLoader-147"><a href="#UrFallLoader-147"><span class="linenos">147</span></a>        <span class="k">return</span> <span class="n">data_list</span><span class="p">,</span> <span class="n">names_list</span>
</span><span id="UrFallLoader-148"><a href="#UrFallLoader-148"><span class="linenos">148</span></a>    
</span><span id="UrFallLoader-149"><a href="#UrFallLoader-149"><span class="linenos">149</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_load_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sequences</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> 
</span><span id="UrFallLoader-150"><a href="#UrFallLoader-150"><span class="linenos">150</span></a>                       <span class="n">use_falls</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">use_adls</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="UrFallLoader-151"><a href="#UrFallLoader-151"><span class="linenos">151</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader-152"><a href="#UrFallLoader-152"><span class="linenos">152</span></a><span class="sd">        Load pre-extracted features from CSV files.</span>
</span><span id="UrFallLoader-153"><a href="#UrFallLoader-153"><span class="linenos">153</span></a><span class="sd">        </span>
</span><span id="UrFallLoader-154"><a href="#UrFallLoader-154"><span class="linenos">154</span></a><span class="sd">        Args:</span>
</span><span id="UrFallLoader-155"><a href="#UrFallLoader-155"><span class="linenos">155</span></a><span class="sd">            data_dir: Directory containing the dataset</span>
</span><span id="UrFallLoader-156"><a href="#UrFallLoader-156"><span class="linenos">156</span></a><span class="sd">            sequences: Specific sequences to load</span>
</span><span id="UrFallLoader-157"><a href="#UrFallLoader-157"><span class="linenos">157</span></a><span class="sd">            use_falls: Whether to include fall sequences</span>
</span><span id="UrFallLoader-158"><a href="#UrFallLoader-158"><span class="linenos">158</span></a><span class="sd">            use_adls: Whether to include ADL sequences</span>
</span><span id="UrFallLoader-159"><a href="#UrFallLoader-159"><span class="linenos">159</span></a><span class="sd">            </span>
</span><span id="UrFallLoader-160"><a href="#UrFallLoader-160"><span class="linenos">160</span></a><span class="sd">        Returns:</span>
</span><span id="UrFallLoader-161"><a href="#UrFallLoader-161"><span class="linenos">161</span></a><span class="sd">            Tuple of (data_list, names_list)</span>
</span><span id="UrFallLoader-162"><a href="#UrFallLoader-162"><span class="linenos">162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UrFallLoader-163"><a href="#UrFallLoader-163"><span class="linenos">163</span></a>        <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader-164"><a href="#UrFallLoader-164"><span class="linenos">164</span></a>        <span class="n">names_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader-165"><a href="#UrFallLoader-165"><span class="linenos">165</span></a>        
</span><span id="UrFallLoader-166"><a href="#UrFallLoader-166"><span class="linenos">166</span></a>        <span class="c1"># Load falls features</span>
</span><span id="UrFallLoader-167"><a href="#UrFallLoader-167"><span class="linenos">167</span></a>        <span class="k">if</span> <span class="n">use_falls</span><span class="p">:</span>
</span><span id="UrFallLoader-168"><a href="#UrFallLoader-168"><span class="linenos">168</span></a>            <span class="n">falls_csv</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;urfall-cam0-falls.csv&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader-169"><a href="#UrFallLoader-169"><span class="linenos">169</span></a>            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">falls_csv</span><span class="p">):</span>
</span><span id="UrFallLoader-170"><a href="#UrFallLoader-170"><span class="linenos">170</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">falls_csv</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;feature_columns&#39;</span><span class="p">])</span>
</span><span id="UrFallLoader-171"><a href="#UrFallLoader-171"><span class="linenos">171</span></a>                
</span><span id="UrFallLoader-172"><a href="#UrFallLoader-172"><span class="linenos">172</span></a>                <span class="c1"># Filter by specific sequences if provided</span>
</span><span id="UrFallLoader-173"><a href="#UrFallLoader-173"><span class="linenos">173</span></a>                <span class="k">if</span> <span class="n">sequences</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="UrFallLoader-174"><a href="#UrFallLoader-174"><span class="linenos">174</span></a>                    <span class="n">fall_sequences</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sequences</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;fall-&#39;</span><span class="p">)]</span>
</span><span id="UrFallLoader-175"><a href="#UrFallLoader-175"><span class="linenos">175</span></a>                    <span class="k">if</span> <span class="n">fall_sequences</span><span class="p">:</span>
</span><span id="UrFallLoader-176"><a href="#UrFallLoader-176"><span class="linenos">176</span></a>                        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sequence_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">fall_sequences</span><span class="p">)]</span>
</span><span id="UrFallLoader-177"><a href="#UrFallLoader-177"><span class="linenos">177</span></a>                
</span><span id="UrFallLoader-178"><a href="#UrFallLoader-178"><span class="linenos">178</span></a>                <span class="c1"># Add metadata columns</span>
</span><span id="UrFallLoader-179"><a href="#UrFallLoader-179"><span class="linenos">179</span></a>                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;activity_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fall&#39;</span>
</span><span id="UrFallLoader-180"><a href="#UrFallLoader-180"><span class="linenos">180</span></a>                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;activity_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Falls are labeled as 1</span>
</span><span id="UrFallLoader-181"><a href="#UrFallLoader-181"><span class="linenos">181</span></a>                
</span><span id="UrFallLoader-182"><a href="#UrFallLoader-182"><span class="linenos">182</span></a>                <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="UrFallLoader-183"><a href="#UrFallLoader-183"><span class="linenos">183</span></a>                <span class="n">names_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;urfall-cam0-falls&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader-184"><a href="#UrFallLoader-184"><span class="linenos">184</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="UrFallLoader-185"><a href="#UrFallLoader-185"><span class="linenos">185</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Falls features file not found at </span><span class="si">{</span><span class="n">falls_csv</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader-186"><a href="#UrFallLoader-186"><span class="linenos">186</span></a>        
</span><span id="UrFallLoader-187"><a href="#UrFallLoader-187"><span class="linenos">187</span></a>        <span class="c1"># Load ADLs features</span>
</span><span id="UrFallLoader-188"><a href="#UrFallLoader-188"><span class="linenos">188</span></a>        <span class="k">if</span> <span class="n">use_adls</span><span class="p">:</span>
</span><span id="UrFallLoader-189"><a href="#UrFallLoader-189"><span class="linenos">189</span></a>            <span class="n">adls_csv</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;urfall-cam0-adls.csv&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader-190"><a href="#UrFallLoader-190"><span class="linenos">190</span></a>            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">adls_csv</span><span class="p">):</span>
</span><span id="UrFallLoader-191"><a href="#UrFallLoader-191"><span class="linenos">191</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">adls_csv</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;feature_columns&#39;</span><span class="p">])</span>
</span><span id="UrFallLoader-192"><a href="#UrFallLoader-192"><span class="linenos">192</span></a>                
</span><span id="UrFallLoader-193"><a href="#UrFallLoader-193"><span class="linenos">193</span></a>                <span class="c1"># Filter by specific sequences if provided</span>
</span><span id="UrFallLoader-194"><a href="#UrFallLoader-194"><span class="linenos">194</span></a>                <span class="k">if</span> <span class="n">sequences</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="UrFallLoader-195"><a href="#UrFallLoader-195"><span class="linenos">195</span></a>                    <span class="n">adl_sequences</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sequences</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;adl-&#39;</span><span class="p">)]</span>
</span><span id="UrFallLoader-196"><a href="#UrFallLoader-196"><span class="linenos">196</span></a>                    <span class="k">if</span> <span class="n">adl_sequences</span><span class="p">:</span>
</span><span id="UrFallLoader-197"><a href="#UrFallLoader-197"><span class="linenos">197</span></a>                        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sequence_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">adl_sequences</span><span class="p">)]</span>
</span><span id="UrFallLoader-198"><a href="#UrFallLoader-198"><span class="linenos">198</span></a>                
</span><span id="UrFallLoader-199"><a href="#UrFallLoader-199"><span class="linenos">199</span></a>                <span class="c1"># Add metadata columns</span>
</span><span id="UrFallLoader-200"><a href="#UrFallLoader-200"><span class="linenos">200</span></a>                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;activity_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;adl&#39;</span>
</span><span id="UrFallLoader-201"><a href="#UrFallLoader-201"><span class="linenos">201</span></a>                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;activity_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># ADLs are labeled as 0</span>
</span><span id="UrFallLoader-202"><a href="#UrFallLoader-202"><span class="linenos">202</span></a>                
</span><span id="UrFallLoader-203"><a href="#UrFallLoader-203"><span class="linenos">203</span></a>                <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="UrFallLoader-204"><a href="#UrFallLoader-204"><span class="linenos">204</span></a>                <span class="n">names_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;urfall-cam0-adls&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader-205"><a href="#UrFallLoader-205"><span class="linenos">205</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="UrFallLoader-206"><a href="#UrFallLoader-206"><span class="linenos">206</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: ADLs features file not found at </span><span class="si">{</span><span class="n">adls_csv</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader-207"><a href="#UrFallLoader-207"><span class="linenos">207</span></a>        
</span><span id="UrFallLoader-208"><a href="#UrFallLoader-208"><span class="linenos">208</span></a>        <span class="k">return</span> <span class="n">data_list</span><span class="p">,</span> <span class="n">names_list</span>
</span><span id="UrFallLoader-209"><a href="#UrFallLoader-209"><span class="linenos">209</span></a>    
</span><span id="UrFallLoader-210"><a href="#UrFallLoader-210"><span class="linenos">210</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_load_accelerometer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sequences</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="UrFallLoader-211"><a href="#UrFallLoader-211"><span class="linenos">211</span></a>                            <span class="n">use_falls</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">use_adls</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="UrFallLoader-212"><a href="#UrFallLoader-212"><span class="linenos">212</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader-213"><a href="#UrFallLoader-213"><span class="linenos">213</span></a><span class="sd">        Load accelerometer CSV data files.</span>
</span><span id="UrFallLoader-214"><a href="#UrFallLoader-214"><span class="linenos">214</span></a><span class="sd">        </span>
</span><span id="UrFallLoader-215"><a href="#UrFallLoader-215"><span class="linenos">215</span></a><span class="sd">        Args:</span>
</span><span id="UrFallLoader-216"><a href="#UrFallLoader-216"><span class="linenos">216</span></a><span class="sd">            data_dir: Directory containing the dataset</span>
</span><span id="UrFallLoader-217"><a href="#UrFallLoader-217"><span class="linenos">217</span></a><span class="sd">            sequences: Specific sequences to load</span>
</span><span id="UrFallLoader-218"><a href="#UrFallLoader-218"><span class="linenos">218</span></a><span class="sd">            use_falls: Whether to include fall sequences</span>
</span><span id="UrFallLoader-219"><a href="#UrFallLoader-219"><span class="linenos">219</span></a><span class="sd">            use_adls: Whether to include ADL sequences</span>
</span><span id="UrFallLoader-220"><a href="#UrFallLoader-220"><span class="linenos">220</span></a><span class="sd">            </span>
</span><span id="UrFallLoader-221"><a href="#UrFallLoader-221"><span class="linenos">221</span></a><span class="sd">        Returns:</span>
</span><span id="UrFallLoader-222"><a href="#UrFallLoader-222"><span class="linenos">222</span></a><span class="sd">            Tuple of (data_list, names_list)</span>
</span><span id="UrFallLoader-223"><a href="#UrFallLoader-223"><span class="linenos">223</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UrFallLoader-224"><a href="#UrFallLoader-224"><span class="linenos">224</span></a>        <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader-225"><a href="#UrFallLoader-225"><span class="linenos">225</span></a>        <span class="n">names_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader-226"><a href="#UrFallLoader-226"><span class="linenos">226</span></a>        
</span><span id="UrFallLoader-227"><a href="#UrFallLoader-227"><span class="linenos">227</span></a>        <span class="c1"># Determine which sequences to load</span>
</span><span id="UrFallLoader-228"><a href="#UrFallLoader-228"><span class="linenos">228</span></a>        <span class="n">seq_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader-229"><a href="#UrFallLoader-229"><span class="linenos">229</span></a>        <span class="k">if</span> <span class="n">sequences</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="UrFallLoader-230"><a href="#UrFallLoader-230"><span class="linenos">230</span></a>            <span class="n">seq_list</span> <span class="o">=</span> <span class="n">sequences</span>
</span><span id="UrFallLoader-231"><a href="#UrFallLoader-231"><span class="linenos">231</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="UrFallLoader-232"><a href="#UrFallLoader-232"><span class="linenos">232</span></a>            <span class="k">if</span> <span class="n">use_falls</span><span class="p">:</span>
</span><span id="UrFallLoader-233"><a href="#UrFallLoader-233"><span class="linenos">233</span></a>                <span class="n">seq_list</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;fall-</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">31</span><span class="p">)])</span>
</span><span id="UrFallLoader-234"><a href="#UrFallLoader-234"><span class="linenos">234</span></a>            <span class="k">if</span> <span class="n">use_adls</span><span class="p">:</span>
</span><span id="UrFallLoader-235"><a href="#UrFallLoader-235"><span class="linenos">235</span></a>                <span class="n">seq_list</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;adl-</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)])</span>
</span><span id="UrFallLoader-236"><a href="#UrFallLoader-236"><span class="linenos">236</span></a>        
</span><span id="UrFallLoader-237"><a href="#UrFallLoader-237"><span class="linenos">237</span></a>        <span class="c1"># Load accelerometer data for each sequence</span>
</span><span id="UrFallLoader-238"><a href="#UrFallLoader-238"><span class="linenos">238</span></a>        <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="n">seq_list</span><span class="p">:</span>
</span><span id="UrFallLoader-239"><a href="#UrFallLoader-239"><span class="linenos">239</span></a>            <span class="n">accel_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">seq</span><span class="si">}</span><span class="s2">-acc.csv&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader-240"><a href="#UrFallLoader-240"><span class="linenos">240</span></a>            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">accel_file</span><span class="p">):</span>
</span><span id="UrFallLoader-241"><a href="#UrFallLoader-241"><span class="linenos">241</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="UrFallLoader-242"><a href="#UrFallLoader-242"><span class="linenos">242</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">accel_file</span><span class="p">)</span>
</span><span id="UrFallLoader-243"><a href="#UrFallLoader-243"><span class="linenos">243</span></a>                    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;sequence_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span>
</span><span id="UrFallLoader-244"><a href="#UrFallLoader-244"><span class="linenos">244</span></a>                    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;activity_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fall&#39;</span> <span class="k">if</span> <span class="n">seq</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;fall-&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;adl&#39;</span>
</span><span id="UrFallLoader-245"><a href="#UrFallLoader-245"><span class="linenos">245</span></a>                    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;activity_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">seq</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;fall-&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="UrFallLoader-246"><a href="#UrFallLoader-246"><span class="linenos">246</span></a>                    <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="UrFallLoader-247"><a href="#UrFallLoader-247"><span class="linenos">247</span></a>                    <span class="n">names_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">seq</span><span class="si">}</span><span class="s2">-accelerometer&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader-248"><a href="#UrFallLoader-248"><span class="linenos">248</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="UrFallLoader-249"><a href="#UrFallLoader-249"><span class="linenos">249</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Could not load accelerometer data from </span><span class="si">{</span><span class="n">accel_file</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader-250"><a href="#UrFallLoader-250"><span class="linenos">250</span></a>        
</span><span id="UrFallLoader-251"><a href="#UrFallLoader-251"><span class="linenos">251</span></a>        <span class="k">return</span> <span class="n">data_list</span><span class="p">,</span> <span class="n">names_list</span>
</span><span id="UrFallLoader-252"><a href="#UrFallLoader-252"><span class="linenos">252</span></a>    
</span><span id="UrFallLoader-253"><a href="#UrFallLoader-253"><span class="linenos">253</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_load_synchronization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sequences</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="UrFallLoader-254"><a href="#UrFallLoader-254"><span class="linenos">254</span></a>                              <span class="n">use_falls</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">use_adls</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="UrFallLoader-255"><a href="#UrFallLoader-255"><span class="linenos">255</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader-256"><a href="#UrFallLoader-256"><span class="linenos">256</span></a><span class="sd">        Load synchronization CSV data files.</span>
</span><span id="UrFallLoader-257"><a href="#UrFallLoader-257"><span class="linenos">257</span></a><span class="sd">        </span>
</span><span id="UrFallLoader-258"><a href="#UrFallLoader-258"><span class="linenos">258</span></a><span class="sd">        Args:</span>
</span><span id="UrFallLoader-259"><a href="#UrFallLoader-259"><span class="linenos">259</span></a><span class="sd">            data_dir: Directory containing the dataset</span>
</span><span id="UrFallLoader-260"><a href="#UrFallLoader-260"><span class="linenos">260</span></a><span class="sd">            sequences: Specific sequences to load</span>
</span><span id="UrFallLoader-261"><a href="#UrFallLoader-261"><span class="linenos">261</span></a><span class="sd">            use_falls: Whether to include fall sequences</span>
</span><span id="UrFallLoader-262"><a href="#UrFallLoader-262"><span class="linenos">262</span></a><span class="sd">            use_adls: Whether to include ADL sequences</span>
</span><span id="UrFallLoader-263"><a href="#UrFallLoader-263"><span class="linenos">263</span></a><span class="sd">            </span>
</span><span id="UrFallLoader-264"><a href="#UrFallLoader-264"><span class="linenos">264</span></a><span class="sd">        Returns:</span>
</span><span id="UrFallLoader-265"><a href="#UrFallLoader-265"><span class="linenos">265</span></a><span class="sd">            Tuple of (data_list, names_list)</span>
</span><span id="UrFallLoader-266"><a href="#UrFallLoader-266"><span class="linenos">266</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UrFallLoader-267"><a href="#UrFallLoader-267"><span class="linenos">267</span></a>        <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader-268"><a href="#UrFallLoader-268"><span class="linenos">268</span></a>        <span class="n">names_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader-269"><a href="#UrFallLoader-269"><span class="linenos">269</span></a>        
</span><span id="UrFallLoader-270"><a href="#UrFallLoader-270"><span class="linenos">270</span></a>        <span class="c1"># Determine which sequences to load</span>
</span><span id="UrFallLoader-271"><a href="#UrFallLoader-271"><span class="linenos">271</span></a>        <span class="n">seq_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader-272"><a href="#UrFallLoader-272"><span class="linenos">272</span></a>        <span class="k">if</span> <span class="n">sequences</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="UrFallLoader-273"><a href="#UrFallLoader-273"><span class="linenos">273</span></a>            <span class="n">seq_list</span> <span class="o">=</span> <span class="n">sequences</span>
</span><span id="UrFallLoader-274"><a href="#UrFallLoader-274"><span class="linenos">274</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="UrFallLoader-275"><a href="#UrFallLoader-275"><span class="linenos">275</span></a>            <span class="k">if</span> <span class="n">use_falls</span><span class="p">:</span>
</span><span id="UrFallLoader-276"><a href="#UrFallLoader-276"><span class="linenos">276</span></a>                <span class="n">seq_list</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;fall-</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">31</span><span class="p">)])</span>
</span><span id="UrFallLoader-277"><a href="#UrFallLoader-277"><span class="linenos">277</span></a>            <span class="k">if</span> <span class="n">use_adls</span><span class="p">:</span>
</span><span id="UrFallLoader-278"><a href="#UrFallLoader-278"><span class="linenos">278</span></a>                <span class="n">seq_list</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;adl-</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)])</span>
</span><span id="UrFallLoader-279"><a href="#UrFallLoader-279"><span class="linenos">279</span></a>        
</span><span id="UrFallLoader-280"><a href="#UrFallLoader-280"><span class="linenos">280</span></a>        <span class="c1"># Load synchronization data for each sequence</span>
</span><span id="UrFallLoader-281"><a href="#UrFallLoader-281"><span class="linenos">281</span></a>        <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="n">seq_list</span><span class="p">:</span>
</span><span id="UrFallLoader-282"><a href="#UrFallLoader-282"><span class="linenos">282</span></a>            <span class="n">sync_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">seq</span><span class="si">}</span><span class="s2">-data.csv&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader-283"><a href="#UrFallLoader-283"><span class="linenos">283</span></a>            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">sync_file</span><span class="p">):</span>
</span><span id="UrFallLoader-284"><a href="#UrFallLoader-284"><span class="linenos">284</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="UrFallLoader-285"><a href="#UrFallLoader-285"><span class="linenos">285</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">sync_file</span><span class="p">)</span>
</span><span id="UrFallLoader-286"><a href="#UrFallLoader-286"><span class="linenos">286</span></a>                    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;sequence_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span>
</span><span id="UrFallLoader-287"><a href="#UrFallLoader-287"><span class="linenos">287</span></a>                    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;activity_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fall&#39;</span> <span class="k">if</span> <span class="n">seq</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;fall-&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;adl&#39;</span>
</span><span id="UrFallLoader-288"><a href="#UrFallLoader-288"><span class="linenos">288</span></a>                    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;activity_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">seq</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;fall-&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="UrFallLoader-289"><a href="#UrFallLoader-289"><span class="linenos">289</span></a>                    <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="UrFallLoader-290"><a href="#UrFallLoader-290"><span class="linenos">290</span></a>                    <span class="n">names_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">seq</span><span class="si">}</span><span class="s2">-synchronization&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader-291"><a href="#UrFallLoader-291"><span class="linenos">291</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="UrFallLoader-292"><a href="#UrFallLoader-292"><span class="linenos">292</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Could not load synchronization data from </span><span class="si">{</span><span class="n">sync_file</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader-293"><a href="#UrFallLoader-293"><span class="linenos">293</span></a>        
</span><span id="UrFallLoader-294"><a href="#UrFallLoader-294"><span class="linenos">294</span></a>        <span class="k">return</span> <span class="n">data_list</span><span class="p">,</span> <span class="n">names_list</span>
</span><span id="UrFallLoader-295"><a href="#UrFallLoader-295"><span class="linenos">295</span></a>    
</span><span id="UrFallLoader-296"><a href="#UrFallLoader-296"><span class="linenos">296</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_file_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
</span><span id="UrFallLoader-297"><a href="#UrFallLoader-297"><span class="linenos">297</span></a>                       <span class="n">sequences</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="UrFallLoader-298"><a href="#UrFallLoader-298"><span class="linenos">298</span></a>                       <span class="n">use_falls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">use_adls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="UrFallLoader-299"><a href="#UrFallLoader-299"><span class="linenos">299</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader-300"><a href="#UrFallLoader-300"><span class="linenos">300</span></a><span class="sd">        Get file paths for image/video data types (depth, RGB, video).</span>
</span><span id="UrFallLoader-301"><a href="#UrFallLoader-301"><span class="linenos">301</span></a><span class="sd">        </span>
</span><span id="UrFallLoader-302"><a href="#UrFallLoader-302"><span class="linenos">302</span></a><span class="sd">        Args:</span>
</span><span id="UrFallLoader-303"><a href="#UrFallLoader-303"><span class="linenos">303</span></a><span class="sd">            data_dir: Directory containing the dataset</span>
</span><span id="UrFallLoader-304"><a href="#UrFallLoader-304"><span class="linenos">304</span></a><span class="sd">            data_type: Type of data (&#39;depth&#39;, &#39;rgb&#39;, &#39;video&#39;)</span>
</span><span id="UrFallLoader-305"><a href="#UrFallLoader-305"><span class="linenos">305</span></a><span class="sd">            sequences: Specific sequences to get paths for</span>
</span><span id="UrFallLoader-306"><a href="#UrFallLoader-306"><span class="linenos">306</span></a><span class="sd">            use_falls: Whether to include fall sequences</span>
</span><span id="UrFallLoader-307"><a href="#UrFallLoader-307"><span class="linenos">307</span></a><span class="sd">            use_adls: Whether to include ADL sequences</span>
</span><span id="UrFallLoader-308"><a href="#UrFallLoader-308"><span class="linenos">308</span></a><span class="sd">            </span>
</span><span id="UrFallLoader-309"><a href="#UrFallLoader-309"><span class="linenos">309</span></a><span class="sd">        Returns:</span>
</span><span id="UrFallLoader-310"><a href="#UrFallLoader-310"><span class="linenos">310</span></a><span class="sd">            Dictionary mapping sequence names to file paths</span>
</span><span id="UrFallLoader-311"><a href="#UrFallLoader-311"><span class="linenos">311</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UrFallLoader-312"><a href="#UrFallLoader-312"><span class="linenos">312</span></a>        <span class="k">if</span> <span class="n">data_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">,</span> <span class="s1">&#39;rgb&#39;</span><span class="p">,</span> <span class="s1">&#39;video&#39;</span><span class="p">]:</span>
</span><span id="UrFallLoader-313"><a href="#UrFallLoader-313"><span class="linenos">313</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;data_type must be one of: &#39;depth&#39;, &#39;rgb&#39;, &#39;video&#39;. Got: </span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader-314"><a href="#UrFallLoader-314"><span class="linenos">314</span></a>        
</span><span id="UrFallLoader-315"><a href="#UrFallLoader-315"><span class="linenos">315</span></a>        <span class="n">file_paths</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="UrFallLoader-316"><a href="#UrFallLoader-316"><span class="linenos">316</span></a>        
</span><span id="UrFallLoader-317"><a href="#UrFallLoader-317"><span class="linenos">317</span></a>        <span class="c1"># Determine which sequences to include</span>
</span><span id="UrFallLoader-318"><a href="#UrFallLoader-318"><span class="linenos">318</span></a>        <span class="n">seq_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader-319"><a href="#UrFallLoader-319"><span class="linenos">319</span></a>        <span class="k">if</span> <span class="n">sequences</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="UrFallLoader-320"><a href="#UrFallLoader-320"><span class="linenos">320</span></a>            <span class="n">seq_list</span> <span class="o">=</span> <span class="n">sequences</span>
</span><span id="UrFallLoader-321"><a href="#UrFallLoader-321"><span class="linenos">321</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="UrFallLoader-322"><a href="#UrFallLoader-322"><span class="linenos">322</span></a>            <span class="k">if</span> <span class="n">use_falls</span><span class="p">:</span>
</span><span id="UrFallLoader-323"><a href="#UrFallLoader-323"><span class="linenos">323</span></a>                <span class="n">seq_list</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;fall-</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">31</span><span class="p">)])</span>
</span><span id="UrFallLoader-324"><a href="#UrFallLoader-324"><span class="linenos">324</span></a>            <span class="k">if</span> <span class="n">use_adls</span><span class="p">:</span>
</span><span id="UrFallLoader-325"><a href="#UrFallLoader-325"><span class="linenos">325</span></a>                <span class="n">seq_list</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;adl-</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)])</span>
</span><span id="UrFallLoader-326"><a href="#UrFallLoader-326"><span class="linenos">326</span></a>        
</span><span id="UrFallLoader-327"><a href="#UrFallLoader-327"><span class="linenos">327</span></a>        <span class="c1"># Map data type to file extension</span>
</span><span id="UrFallLoader-328"><a href="#UrFallLoader-328"><span class="linenos">328</span></a>        <span class="n">extension_map</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="UrFallLoader-329"><a href="#UrFallLoader-329"><span class="linenos">329</span></a>            <span class="s1">&#39;depth&#39;</span><span class="p">:</span> <span class="s1">&#39;-cam0-d.zip&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-330"><a href="#UrFallLoader-330"><span class="linenos">330</span></a>            <span class="s1">&#39;rgb&#39;</span><span class="p">:</span> <span class="s1">&#39;-cam0-rgb.zip&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader-331"><a href="#UrFallLoader-331"><span class="linenos">331</span></a>            <span class="s1">&#39;video&#39;</span><span class="p">:</span> <span class="s1">&#39;-cam0.mp4&#39;</span>
</span><span id="UrFallLoader-332"><a href="#UrFallLoader-332"><span class="linenos">332</span></a>        <span class="p">}</span>
</span><span id="UrFallLoader-333"><a href="#UrFallLoader-333"><span class="linenos">333</span></a>        
</span><span id="UrFallLoader-334"><a href="#UrFallLoader-334"><span class="linenos">334</span></a>        <span class="n">ext</span> <span class="o">=</span> <span class="n">extension_map</span><span class="p">[</span><span class="n">data_type</span><span class="p">]</span>
</span><span id="UrFallLoader-335"><a href="#UrFallLoader-335"><span class="linenos">335</span></a>        
</span><span id="UrFallLoader-336"><a href="#UrFallLoader-336"><span class="linenos">336</span></a>        <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="n">seq_list</span><span class="p">:</span>
</span><span id="UrFallLoader-337"><a href="#UrFallLoader-337"><span class="linenos">337</span></a>            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">seq</span><span class="si">}{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader-338"><a href="#UrFallLoader-338"><span class="linenos">338</span></a>            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
</span><span id="UrFallLoader-339"><a href="#UrFallLoader-339"><span class="linenos">339</span></a>                <span class="n">file_paths</span><span class="p">[</span><span class="n">seq</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_path</span>
</span><span id="UrFallLoader-340"><a href="#UrFallLoader-340"><span class="linenos">340</span></a>        
</span><span id="UrFallLoader-341"><a href="#UrFallLoader-341"><span class="linenos">341</span></a>        <span class="k">return</span> <span class="n">file_paths</span>
</span><span id="UrFallLoader-342"><a href="#UrFallLoader-342"><span class="linenos">342</span></a>    
</span><span id="UrFallLoader-343"><a href="#UrFallLoader-343"><span class="linenos">343</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_sliding_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="UrFallLoader-344"><a href="#UrFallLoader-344"><span class="linenos">344</span></a>                               <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="UrFallLoader-345"><a href="#UrFallLoader-345"><span class="linenos">345</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader-346"><a href="#UrFallLoader-346"><span class="linenos">346</span></a><span class="sd">        Create sliding windows from the loaded data.</span>
</span><span id="UrFallLoader-347"><a href="#UrFallLoader-347"><span class="linenos">347</span></a><span class="sd">        </span>
</span><span id="UrFallLoader-348"><a href="#UrFallLoader-348"><span class="linenos">348</span></a><span class="sd">        Args:</span>
</span><span id="UrFallLoader-349"><a href="#UrFallLoader-349"><span class="linenos">349</span></a><span class="sd">            data: List of DataFrames containing the dataset</span>
</span><span id="UrFallLoader-350"><a href="#UrFallLoader-350"><span class="linenos">350</span></a><span class="sd">            names: List of names corresponding to each DataFrame</span>
</span><span id="UrFallLoader-351"><a href="#UrFallLoader-351"><span class="linenos">351</span></a><span class="sd">            window_size: Size of the sliding window (default: 30 frames for depth features)</span>
</span><span id="UrFallLoader-352"><a href="#UrFallLoader-352"><span class="linenos">352</span></a><span class="sd">            step_size: Step size for sliding window (default: 15 frames)</span>
</span><span id="UrFallLoader-353"><a href="#UrFallLoader-353"><span class="linenos">353</span></a><span class="sd">            </span>
</span><span id="UrFallLoader-354"><a href="#UrFallLoader-354"><span class="linenos">354</span></a><span class="sd">        Returns:</span>
</span><span id="UrFallLoader-355"><a href="#UrFallLoader-355"><span class="linenos">355</span></a><span class="sd">            List of dictionaries containing windowed data</span>
</span><span id="UrFallLoader-356"><a href="#UrFallLoader-356"><span class="linenos">356</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UrFallLoader-357"><a href="#UrFallLoader-357"><span class="linenos">357</span></a>        <span class="n">windows_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader-358"><a href="#UrFallLoader-358"><span class="linenos">358</span></a>        
</span><span id="UrFallLoader-359"><a href="#UrFallLoader-359"><span class="linenos">359</span></a>        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span><span id="UrFallLoader-360"><a href="#UrFallLoader-360"><span class="linenos">360</span></a>            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="UrFallLoader-361"><a href="#UrFallLoader-361"><span class="linenos">361</span></a>                <span class="k">continue</span>
</span><span id="UrFallLoader-362"><a href="#UrFallLoader-362"><span class="linenos">362</span></a>            
</span><span id="UrFallLoader-363"><a href="#UrFallLoader-363"><span class="linenos">363</span></a>            <span class="c1"># Get numeric feature columns (exclude metadata columns)</span>
</span><span id="UrFallLoader-364"><a href="#UrFallLoader-364"><span class="linenos">364</span></a>            <span class="n">exclude_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sequence_name&#39;</span><span class="p">,</span> <span class="s1">&#39;frame_number&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;activity_type&#39;</span><span class="p">,</span> <span class="s1">&#39;activity_id&#39;</span><span class="p">]</span>
</span><span id="UrFallLoader-365"><a href="#UrFallLoader-365"><span class="linenos">365</span></a>            <span class="n">feature_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> 
</span><span id="UrFallLoader-366"><a href="#UrFallLoader-366"><span class="linenos">366</span></a>                          <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude_cols</span> <span class="ow">and</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])]</span>
</span><span id="UrFallLoader-367"><a href="#UrFallLoader-367"><span class="linenos">367</span></a>            
</span><span id="UrFallLoader-368"><a href="#UrFallLoader-368"><span class="linenos">368</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">feature_cols</span><span class="p">:</span>
</span><span id="UrFallLoader-369"><a href="#UrFallLoader-369"><span class="linenos">369</span></a>                <span class="k">continue</span>
</span><span id="UrFallLoader-370"><a href="#UrFallLoader-370"><span class="linenos">370</span></a>            
</span><span id="UrFallLoader-371"><a href="#UrFallLoader-371"><span class="linenos">371</span></a>            <span class="n">windows</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader-372"><a href="#UrFallLoader-372"><span class="linenos">372</span></a>            
</span><span id="UrFallLoader-373"><a href="#UrFallLoader-373"><span class="linenos">373</span></a>            <span class="c1"># Create windows for each feature column</span>
</span><span id="UrFallLoader-374"><a href="#UrFallLoader-374"><span class="linenos">374</span></a>            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">feature_cols</span><span class="p">:</span>
</span><span id="UrFallLoader-375"><a href="#UrFallLoader-375"><span class="linenos">375</span></a>                <span class="n">win</span> <span class="o">=</span> <span class="n">sliding_window</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span><span id="UrFallLoader-376"><a href="#UrFallLoader-376"><span class="linenos">376</span></a>                <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">col</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">win</span><span class="p">})</span>
</span><span id="UrFallLoader-377"><a href="#UrFallLoader-377"><span class="linenos">377</span></a>            
</span><span id="UrFallLoader-378"><a href="#UrFallLoader-378"><span class="linenos">378</span></a>            <span class="c1"># Create windows for labels if present</span>
</span><span id="UrFallLoader-379"><a href="#UrFallLoader-379"><span class="linenos">379</span></a>            <span class="k">if</span> <span class="s1">&#39;label&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="UrFallLoader-380"><a href="#UrFallLoader-380"><span class="linenos">380</span></a>                <span class="n">label_windows</span> <span class="o">=</span> <span class="n">sliding_window</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span><span id="UrFallLoader-381"><a href="#UrFallLoader-381"><span class="linenos">381</span></a>                <span class="c1"># Majority voting for each window</span>
</span><span id="UrFallLoader-382"><a href="#UrFallLoader-382"><span class="linenos">382</span></a>                <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader-383"><a href="#UrFallLoader-383"><span class="linenos">383</span></a>                <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">label_windows</span><span class="p">:</span>
</span><span id="UrFallLoader-384"><a href="#UrFallLoader-384"><span class="linenos">384</span></a>                    <span class="n">vals</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="UrFallLoader-385"><a href="#UrFallLoader-385"><span class="linenos">385</span></a>                    <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">counts</span><span class="p">)])</span>
</span><span id="UrFallLoader-386"><a href="#UrFallLoader-386"><span class="linenos">386</span></a>                <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">)})</span>
</span><span id="UrFallLoader-387"><a href="#UrFallLoader-387"><span class="linenos">387</span></a>            
</span><span id="UrFallLoader-388"><a href="#UrFallLoader-388"><span class="linenos">388</span></a>            <span class="c1"># Create activity_id windows</span>
</span><span id="UrFallLoader-389"><a href="#UrFallLoader-389"><span class="linenos">389</span></a>            <span class="k">if</span> <span class="s1">&#39;activity_id&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="UrFallLoader-390"><a href="#UrFallLoader-390"><span class="linenos">390</span></a>                <span class="n">activity_windows</span> <span class="o">=</span> <span class="n">sliding_window</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;activity_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span><span id="UrFallLoader-391"><a href="#UrFallLoader-391"><span class="linenos">391</span></a>                <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;activity_id&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">activity_windows</span><span class="p">})</span>
</span><span id="UrFallLoader-392"><a href="#UrFallLoader-392"><span class="linenos">392</span></a>            
</span><span id="UrFallLoader-393"><a href="#UrFallLoader-393"><span class="linenos">393</span></a>            <span class="n">windows_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="s2">&quot;windows&quot;</span><span class="p">:</span> <span class="n">windows</span><span class="p">})</span>
</span><span id="UrFallLoader-394"><a href="#UrFallLoader-394"><span class="linenos">394</span></a>        
</span><span id="UrFallLoader-395"><a href="#UrFallLoader-395"><span class="linenos">395</span></a>        <span class="k">return</span> <span class="n">windows_data</span>
</span><span id="UrFallLoader-396"><a href="#UrFallLoader-396"><span class="linenos">396</span></a>    
</span><span id="UrFallLoader-397"><a href="#UrFallLoader-397"><span class="linenos">397</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_supported_formats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="UrFallLoader-398"><a href="#UrFallLoader-398"><span class="linenos">398</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader-399"><a href="#UrFallLoader-399"><span class="linenos">399</span></a><span class="sd">        Get list of supported file formats for UrFall dataset.</span>
</span><span id="UrFallLoader-400"><a href="#UrFallLoader-400"><span class="linenos">400</span></a><span class="sd">        </span>
</span><span id="UrFallLoader-401"><a href="#UrFallLoader-401"><span class="linenos">401</span></a><span class="sd">        Returns:</span>
</span><span id="UrFallLoader-402"><a href="#UrFallLoader-402"><span class="linenos">402</span></a><span class="sd">            List of supported file extensions</span>
</span><span id="UrFallLoader-403"><a href="#UrFallLoader-403"><span class="linenos">403</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UrFallLoader-404"><a href="#UrFallLoader-404"><span class="linenos">404</span></a>        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;.zip&#39;</span><span class="p">,</span> <span class="s1">&#39;.mp4&#39;</span><span class="p">]</span>
</span><span id="UrFallLoader-405"><a href="#UrFallLoader-405"><span class="linenos">405</span></a>    
</span><span id="UrFallLoader-406"><a href="#UrFallLoader-406"><span class="linenos">406</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sensor_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">any</span><span class="p">]:</span>
</span><span id="UrFallLoader-407"><a href="#UrFallLoader-407"><span class="linenos">407</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader-408"><a href="#UrFallLoader-408"><span class="linenos">408</span></a><span class="sd">        Get information about sensors in the dataset.</span>
</span><span id="UrFallLoader-409"><a href="#UrFallLoader-409"><span class="linenos">409</span></a><span class="sd">        </span>
</span><span id="UrFallLoader-410"><a href="#UrFallLoader-410"><span class="linenos">410</span></a><span class="sd">        Returns:</span>
</span><span id="UrFallLoader-411"><a href="#UrFallLoader-411"><span class="linenos">411</span></a><span class="sd">            Dictionary containing sensor information</span>
</span><span id="UrFallLoader-412"><a href="#UrFallLoader-412"><span class="linenos">412</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UrFallLoader-413"><a href="#UrFallLoader-413"><span class="linenos">413</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="UrFallLoader-414"><a href="#UrFallLoader-414"><span class="linenos">414</span></a>            <span class="s1">&#39;data_types&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;data_types&#39;</span><span class="p">],</span>
</span><span id="UrFallLoader-415"><a href="#UrFallLoader-415"><span class="linenos">415</span></a>            <span class="s1">&#39;camera&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;camera&#39;</span><span class="p">],</span>
</span><span id="UrFallLoader-416"><a href="#UrFallLoader-416"><span class="linenos">416</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sampling_frequency&#39;</span><span class="p">],</span>
</span><span id="UrFallLoader-417"><a href="#UrFallLoader-417"><span class="linenos">417</span></a>            <span class="s1">&#39;accelerometer_frequency&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;accelerometer_frequency&#39;</span><span class="p">]</span>
</span><span id="UrFallLoader-418"><a href="#UrFallLoader-418"><span class="linenos">418</span></a>        <span class="p">}</span>
</span><span id="UrFallLoader-419"><a href="#UrFallLoader-419"><span class="linenos">419</span></a>    
</span><span id="UrFallLoader-420"><a href="#UrFallLoader-420"><span class="linenos">420</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_activity_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="UrFallLoader-421"><a href="#UrFallLoader-421"><span class="linenos">421</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader-422"><a href="#UrFallLoader-422"><span class="linenos">422</span></a><span class="sd">        Get information about activities in the dataset.</span>
</span><span id="UrFallLoader-423"><a href="#UrFallLoader-423"><span class="linenos">423</span></a><span class="sd">        </span>
</span><span id="UrFallLoader-424"><a href="#UrFallLoader-424"><span class="linenos">424</span></a><span class="sd">        Returns:</span>
</span><span id="UrFallLoader-425"><a href="#UrFallLoader-425"><span class="linenos">425</span></a><span class="sd">            Dictionary mapping activity IDs to labels</span>
</span><span id="UrFallLoader-426"><a href="#UrFallLoader-426"><span class="linenos">426</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UrFallLoader-427"><a href="#UrFallLoader-427"><span class="linenos">427</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;activities&#39;</span><span class="p">]</span>
</span><span id="UrFallLoader-428"><a href="#UrFallLoader-428"><span class="linenos">428</span></a>    
</span><span id="UrFallLoader-429"><a href="#UrFallLoader-429"><span class="linenos">429</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_feature_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="UrFallLoader-430"><a href="#UrFallLoader-430"><span class="linenos">430</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader-431"><a href="#UrFallLoader-431"><span class="linenos">431</span></a><span class="sd">        Get information about pre-extracted features.</span>
</span><span id="UrFallLoader-432"><a href="#UrFallLoader-432"><span class="linenos">432</span></a><span class="sd">        </span>
</span><span id="UrFallLoader-433"><a href="#UrFallLoader-433"><span class="linenos">433</span></a><span class="sd">        Returns:</span>
</span><span id="UrFallLoader-434"><a href="#UrFallLoader-434"><span class="linenos">434</span></a><span class="sd">            Dictionary mapping feature names to descriptions</span>
</span><span id="UrFallLoader-435"><a href="#UrFallLoader-435"><span class="linenos">435</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UrFallLoader-436"><a href="#UrFallLoader-436"><span class="linenos">436</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;feature_descriptions&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>UrFall dataset loader class.</p>

<p>This class handles loading and processing of the UrFall dataset for fall detection.
Supports multiple data types: Depth, RGB, Accelerometer, Synchronization, Video,
and pre-extracted features from depth maps.</p>
</div>


                            <div id="UrFallLoader.__init__" class="classattr">
                                        <input id="UrFallLoader.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">UrFallLoader</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span></span>)</span>

                <label class="view-source-button" for="UrFallLoader.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#UrFallLoader.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="UrFallLoader.__init__-33"><a href="#UrFallLoader.__init__-33"><span class="linenos">33</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">):</span>
</span><span id="UrFallLoader.__init__-34"><a href="#UrFallLoader.__init__-34"><span class="linenos">34</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader.__init__-35"><a href="#UrFallLoader.__init__-35"><span class="linenos">35</span></a><span class="sd">        Initialize UrFall loader with concurrent download support.</span>
</span><span id="UrFallLoader.__init__-36"><a href="#UrFallLoader.__init__-36"><span class="linenos">36</span></a><span class="sd">        </span>
</span><span id="UrFallLoader.__init__-37"><a href="#UrFallLoader.__init__-37"><span class="linenos">37</span></a><span class="sd">        Args:</span>
</span><span id="UrFallLoader.__init__-38"><a href="#UrFallLoader.__init__-38"><span class="linenos">38</span></a><span class="sd">            max_workers: Maximum number of concurrent download threads (default: 8)</span>
</span><span id="UrFallLoader.__init__-39"><a href="#UrFallLoader.__init__-39"><span class="linenos">39</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UrFallLoader.__init__-40"><a href="#UrFallLoader.__init__-40"><span class="linenos">40</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="UrFallLoader.__init__-41"><a href="#UrFallLoader.__init__-41"><span class="linenos">41</span></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;urfall&quot;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-42"><a href="#UrFallLoader.__init__-42"><span class="linenos">42</span></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;UrFall Dataset - University of Rzeszow Fall Detection Dataset with multimodal data&quot;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-43"><a href="#UrFallLoader.__init__-43"><span class="linenos">43</span></a>            <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span>
</span><span id="UrFallLoader.__init__-44"><a href="#UrFallLoader.__init__-44"><span class="linenos">44</span></a>        <span class="p">)</span>
</span><span id="UrFallLoader.__init__-45"><a href="#UrFallLoader.__init__-45"><span class="linenos">45</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="UrFallLoader.__init__-46"><a href="#UrFallLoader.__init__-46"><span class="linenos">46</span></a>            <span class="s1">&#39;data_types&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">,</span> <span class="s1">&#39;rgb&#39;</span><span class="p">,</span> <span class="s1">&#39;accelerometer&#39;</span><span class="p">,</span> <span class="s1">&#39;synchronization&#39;</span><span class="p">,</span> <span class="s1">&#39;video&#39;</span><span class="p">,</span> <span class="s1">&#39;features&#39;</span><span class="p">],</span>
</span><span id="UrFallLoader.__init__-47"><a href="#UrFallLoader.__init__-47"><span class="linenos">47</span></a>            <span class="s1">&#39;camera&#39;</span><span class="p">:</span> <span class="s1">&#39;cam0&#39;</span><span class="p">,</span>  <span class="c1"># Front camera</span>
</span><span id="UrFallLoader.__init__-48"><a href="#UrFallLoader.__init__-48"><span class="linenos">48</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>  <span class="c1"># Depth/RGB camera fps</span>
</span><span id="UrFallLoader.__init__-49"><a href="#UrFallLoader.__init__-49"><span class="linenos">49</span></a>            <span class="s1">&#39;accelerometer_frequency&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>  <span class="c1"># Accelerometer sampling frequency (typical)</span>
</span><span id="UrFallLoader.__init__-50"><a href="#UrFallLoader.__init__-50"><span class="linenos">50</span></a>            <span class="s1">&#39;activities&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="UrFallLoader.__init__-51"><a href="#UrFallLoader.__init__-51"><span class="linenos">51</span></a>                <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Not lying (standing/walking)&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-52"><a href="#UrFallLoader.__init__-52"><span class="linenos">52</span></a>                <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Falling (transient)&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-53"><a href="#UrFallLoader.__init__-53"><span class="linenos">53</span></a>                <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Lying on ground&#39;</span>
</span><span id="UrFallLoader.__init__-54"><a href="#UrFallLoader.__init__-54"><span class="linenos">54</span></a>            <span class="p">},</span>
</span><span id="UrFallLoader.__init__-55"><a href="#UrFallLoader.__init__-55"><span class="linenos">55</span></a>            <span class="s1">&#39;fall_sequences&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">31</span><span class="p">)),</span>  <span class="c1"># fall-01 to fall-30</span>
</span><span id="UrFallLoader.__init__-56"><a href="#UrFallLoader.__init__-56"><span class="linenos">56</span></a>            <span class="s1">&#39;adl_sequences&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)),</span>  <span class="c1"># adl-01 to adl-20</span>
</span><span id="UrFallLoader.__init__-57"><a href="#UrFallLoader.__init__-57"><span class="linenos">57</span></a>            <span class="s1">&#39;feature_columns&#39;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="UrFallLoader.__init__-58"><a href="#UrFallLoader.__init__-58"><span class="linenos">58</span></a>                <span class="s1">&#39;sequence_name&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-59"><a href="#UrFallLoader.__init__-59"><span class="linenos">59</span></a>                <span class="s1">&#39;frame_number&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-60"><a href="#UrFallLoader.__init__-60"><span class="linenos">60</span></a>                <span class="s1">&#39;label&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-61"><a href="#UrFallLoader.__init__-61"><span class="linenos">61</span></a>                <span class="s1">&#39;HeightWidthRatio&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-62"><a href="#UrFallLoader.__init__-62"><span class="linenos">62</span></a>                <span class="s1">&#39;MajorMinorRatio&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-63"><a href="#UrFallLoader.__init__-63"><span class="linenos">63</span></a>                <span class="s1">&#39;BoundingBoxOccupancy&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-64"><a href="#UrFallLoader.__init__-64"><span class="linenos">64</span></a>                <span class="s1">&#39;MaxStdXZ&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-65"><a href="#UrFallLoader.__init__-65"><span class="linenos">65</span></a>                <span class="s1">&#39;HHmaxRatio&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-66"><a href="#UrFallLoader.__init__-66"><span class="linenos">66</span></a>                <span class="s1">&#39;H&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-67"><a href="#UrFallLoader.__init__-67"><span class="linenos">67</span></a>                <span class="s1">&#39;D&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-68"><a href="#UrFallLoader.__init__-68"><span class="linenos">68</span></a>                <span class="s1">&#39;P40&#39;</span>
</span><span id="UrFallLoader.__init__-69"><a href="#UrFallLoader.__init__-69"><span class="linenos">69</span></a>            <span class="p">],</span>
</span><span id="UrFallLoader.__init__-70"><a href="#UrFallLoader.__init__-70"><span class="linenos">70</span></a>            <span class="s1">&#39;feature_descriptions&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="UrFallLoader.__init__-71"><a href="#UrFallLoader.__init__-71"><span class="linenos">71</span></a>                <span class="s1">&#39;HeightWidthRatio&#39;</span><span class="p">:</span> <span class="s1">&#39;Bounding box height to width ratio&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-72"><a href="#UrFallLoader.__init__-72"><span class="linenos">72</span></a>                <span class="s1">&#39;MajorMinorRatio&#39;</span><span class="p">:</span> <span class="s1">&#39;Major to minor axis ratio from BLOB segmentation&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-73"><a href="#UrFallLoader.__init__-73"><span class="linenos">73</span></a>                <span class="s1">&#39;BoundingBoxOccupancy&#39;</span><span class="p">:</span> <span class="s1">&#39;Ratio of bounding box occupied by person pixels&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-74"><a href="#UrFallLoader.__init__-74"><span class="linenos">74</span></a>                <span class="s1">&#39;MaxStdXZ&#39;</span><span class="p">:</span> <span class="s1">&#39;Standard deviation of pixels from centroid (X and Z axis)&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-75"><a href="#UrFallLoader.__init__-75"><span class="linenos">75</span></a>                <span class="s1">&#39;HHmaxRatio&#39;</span><span class="p">:</span> <span class="s1">&#39;Human height in frame to standing height ratio&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-76"><a href="#UrFallLoader.__init__-76"><span class="linenos">76</span></a>                <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="s1">&#39;Actual height in mm&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-77"><a href="#UrFallLoader.__init__-77"><span class="linenos">77</span></a>                <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="s1">&#39;Distance of person center to floor in mm&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.__init__-78"><a href="#UrFallLoader.__init__-78"><span class="linenos">78</span></a>                <span class="s1">&#39;P40&#39;</span><span class="p">:</span> <span class="s1">&#39;Ratio of point clouds in 40cm cuboid to full height cuboid&#39;</span>
</span><span id="UrFallLoader.__init__-79"><a href="#UrFallLoader.__init__-79"><span class="linenos">79</span></a>            <span class="p">}</span>
</span><span id="UrFallLoader.__init__-80"><a href="#UrFallLoader.__init__-80"><span class="linenos">80</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Initialize UrFall loader with concurrent download support.</p>

<p>Args:
    max_workers: Maximum number of concurrent download threads (default: 8)</p>
</div>


                            </div>
                            <div id="UrFallLoader.metadata" class="classattr">
                                <div class="attr variable">
            <span class="name">metadata</span>

        
    </div>
    <a class="headerlink" href="#UrFallLoader.metadata"></a>
    
    

                            </div>
                            <div id="UrFallLoader.load_data" class="classattr">
                                        <input id="UrFallLoader.load_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_data</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">data_types</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">sequences</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">use_falls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">use_adls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="UrFallLoader.load_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#UrFallLoader.load_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="UrFallLoader.load_data-82"><a href="#UrFallLoader.load_data-82"><span class="linenos"> 82</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
</span><span id="UrFallLoader.load_data-83"><a href="#UrFallLoader.load_data-83"><span class="linenos"> 83</span></a>                  <span class="n">data_types</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="UrFallLoader.load_data-84"><a href="#UrFallLoader.load_data-84"><span class="linenos"> 84</span></a>                  <span class="n">sequences</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="UrFallLoader.load_data-85"><a href="#UrFallLoader.load_data-85"><span class="linenos"> 85</span></a>                  <span class="n">use_falls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="UrFallLoader.load_data-86"><a href="#UrFallLoader.load_data-86"><span class="linenos"> 86</span></a>                  <span class="n">use_adls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="UrFallLoader.load_data-87"><a href="#UrFallLoader.load_data-87"><span class="linenos"> 87</span></a>                  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="UrFallLoader.load_data-88"><a href="#UrFallLoader.load_data-88"><span class="linenos"> 88</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader.load_data-89"><a href="#UrFallLoader.load_data-89"><span class="linenos"> 89</span></a><span class="sd">        Load UrFall dataset from the specified directory.</span>
</span><span id="UrFallLoader.load_data-90"><a href="#UrFallLoader.load_data-90"><span class="linenos"> 90</span></a><span class="sd">        </span>
</span><span id="UrFallLoader.load_data-91"><a href="#UrFallLoader.load_data-91"><span class="linenos"> 91</span></a><span class="sd">        Args:</span>
</span><span id="UrFallLoader.load_data-92"><a href="#UrFallLoader.load_data-92"><span class="linenos"> 92</span></a><span class="sd">            data_dir: Directory containing the dataset</span>
</span><span id="UrFallLoader.load_data-93"><a href="#UrFallLoader.load_data-93"><span class="linenos"> 93</span></a><span class="sd">            data_types: List of data types to load. Options: &#39;depth&#39;, &#39;rgb&#39;, &#39;accelerometer&#39;,</span>
</span><span id="UrFallLoader.load_data-94"><a href="#UrFallLoader.load_data-94"><span class="linenos"> 94</span></a><span class="sd">                       &#39;synchronization&#39;, &#39;video&#39;, &#39;features&#39; (default: [&#39;features&#39;])</span>
</span><span id="UrFallLoader.load_data-95"><a href="#UrFallLoader.load_data-95"><span class="linenos"> 95</span></a><span class="sd">            sequences: List of specific sequences to load (e.g., [&#39;fall-01&#39;, &#39;adl-01&#39;])</span>
</span><span id="UrFallLoader.load_data-96"><a href="#UrFallLoader.load_data-96"><span class="linenos"> 96</span></a><span class="sd">                      If None, loads all based on use_falls and use_adls</span>
</span><span id="UrFallLoader.load_data-97"><a href="#UrFallLoader.load_data-97"><span class="linenos"> 97</span></a><span class="sd">            use_falls: Whether to load fall sequences (default: True)</span>
</span><span id="UrFallLoader.load_data-98"><a href="#UrFallLoader.load_data-98"><span class="linenos"> 98</span></a><span class="sd">            use_adls: Whether to load ADL (Activities of Daily Living) sequences (default: True)</span>
</span><span id="UrFallLoader.load_data-99"><a href="#UrFallLoader.load_data-99"><span class="linenos"> 99</span></a><span class="sd">            **kwargs: Additional arguments</span>
</span><span id="UrFallLoader.load_data-100"><a href="#UrFallLoader.load_data-100"><span class="linenos">100</span></a><span class="sd">            </span>
</span><span id="UrFallLoader.load_data-101"><a href="#UrFallLoader.load_data-101"><span class="linenos">101</span></a><span class="sd">        Returns:</span>
</span><span id="UrFallLoader.load_data-102"><a href="#UrFallLoader.load_data-102"><span class="linenos">102</span></a><span class="sd">            Tuple of (data_list, names_list)</span>
</span><span id="UrFallLoader.load_data-103"><a href="#UrFallLoader.load_data-103"><span class="linenos">103</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UrFallLoader.load_data-104"><a href="#UrFallLoader.load_data-104"><span class="linenos">104</span></a>        <span class="c1"># Default to loading pre-extracted features if not specified</span>
</span><span id="UrFallLoader.load_data-105"><a href="#UrFallLoader.load_data-105"><span class="linenos">105</span></a>        <span class="k">if</span> <span class="n">data_types</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="UrFallLoader.load_data-106"><a href="#UrFallLoader.load_data-106"><span class="linenos">106</span></a>            <span class="n">data_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">]</span>
</span><span id="UrFallLoader.load_data-107"><a href="#UrFallLoader.load_data-107"><span class="linenos">107</span></a>        
</span><span id="UrFallLoader.load_data-108"><a href="#UrFallLoader.load_data-108"><span class="linenos">108</span></a>        <span class="c1"># Validate data types</span>
</span><span id="UrFallLoader.load_data-109"><a href="#UrFallLoader.load_data-109"><span class="linenos">109</span></a>        <span class="n">valid_types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;data_types&#39;</span><span class="p">])</span>
</span><span id="UrFallLoader.load_data-110"><a href="#UrFallLoader.load_data-110"><span class="linenos">110</span></a>        <span class="n">requested_types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">data_types</span><span class="p">)</span>
</span><span id="UrFallLoader.load_data-111"><a href="#UrFallLoader.load_data-111"><span class="linenos">111</span></a>        <span class="n">invalid_types</span> <span class="o">=</span> <span class="n">requested_types</span> <span class="o">-</span> <span class="n">valid_types</span>
</span><span id="UrFallLoader.load_data-112"><a href="#UrFallLoader.load_data-112"><span class="linenos">112</span></a>        <span class="k">if</span> <span class="n">invalid_types</span><span class="p">:</span>
</span><span id="UrFallLoader.load_data-113"><a href="#UrFallLoader.load_data-113"><span class="linenos">113</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid data types: </span><span class="si">{</span><span class="n">invalid_types</span><span class="si">}</span><span class="s2">. Valid types: </span><span class="si">{</span><span class="n">valid_types</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader.load_data-114"><a href="#UrFallLoader.load_data-114"><span class="linenos">114</span></a>        
</span><span id="UrFallLoader.load_data-115"><a href="#UrFallLoader.load_data-115"><span class="linenos">115</span></a>        <span class="c1"># Create directory if it doesn&#39;t exist</span>
</span><span id="UrFallLoader.load_data-116"><a href="#UrFallLoader.load_data-116"><span class="linenos">116</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="UrFallLoader.load_data-117"><a href="#UrFallLoader.load_data-117"><span class="linenos">117</span></a>        
</span><span id="UrFallLoader.load_data-118"><a href="#UrFallLoader.load_data-118"><span class="linenos">118</span></a>        <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader.load_data-119"><a href="#UrFallLoader.load_data-119"><span class="linenos">119</span></a>        <span class="n">names_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader.load_data-120"><a href="#UrFallLoader.load_data-120"><span class="linenos">120</span></a>        
</span><span id="UrFallLoader.load_data-121"><a href="#UrFallLoader.load_data-121"><span class="linenos">121</span></a>        <span class="c1"># Load pre-extracted features (CSV files)</span>
</span><span id="UrFallLoader.load_data-122"><a href="#UrFallLoader.load_data-122"><span class="linenos">122</span></a>        <span class="k">if</span> <span class="s1">&#39;features&#39;</span> <span class="ow">in</span> <span class="n">data_types</span><span class="p">:</span>
</span><span id="UrFallLoader.load_data-123"><a href="#UrFallLoader.load_data-123"><span class="linenos">123</span></a>            <span class="n">features_data</span><span class="p">,</span> <span class="n">features_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_features</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">sequences</span><span class="p">,</span> <span class="n">use_falls</span><span class="p">,</span> <span class="n">use_adls</span><span class="p">)</span>
</span><span id="UrFallLoader.load_data-124"><a href="#UrFallLoader.load_data-124"><span class="linenos">124</span></a>            <span class="n">data_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">features_data</span><span class="p">)</span>
</span><span id="UrFallLoader.load_data-125"><a href="#UrFallLoader.load_data-125"><span class="linenos">125</span></a>            <span class="n">names_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">features_names</span><span class="p">)</span>
</span><span id="UrFallLoader.load_data-126"><a href="#UrFallLoader.load_data-126"><span class="linenos">126</span></a>        
</span><span id="UrFallLoader.load_data-127"><a href="#UrFallLoader.load_data-127"><span class="linenos">127</span></a>        <span class="c1"># Load raw accelerometer data</span>
</span><span id="UrFallLoader.load_data-128"><a href="#UrFallLoader.load_data-128"><span class="linenos">128</span></a>        <span class="k">if</span> <span class="s1">&#39;accelerometer&#39;</span> <span class="ow">in</span> <span class="n">data_types</span><span class="p">:</span>
</span><span id="UrFallLoader.load_data-129"><a href="#UrFallLoader.load_data-129"><span class="linenos">129</span></a>            <span class="n">accel_data</span><span class="p">,</span> <span class="n">accel_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_accelerometer</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">sequences</span><span class="p">,</span> <span class="n">use_falls</span><span class="p">,</span> <span class="n">use_adls</span><span class="p">)</span>
</span><span id="UrFallLoader.load_data-130"><a href="#UrFallLoader.load_data-130"><span class="linenos">130</span></a>            <span class="n">data_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">accel_data</span><span class="p">)</span>
</span><span id="UrFallLoader.load_data-131"><a href="#UrFallLoader.load_data-131"><span class="linenos">131</span></a>            <span class="n">names_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">accel_names</span><span class="p">)</span>
</span><span id="UrFallLoader.load_data-132"><a href="#UrFallLoader.load_data-132"><span class="linenos">132</span></a>        
</span><span id="UrFallLoader.load_data-133"><a href="#UrFallLoader.load_data-133"><span class="linenos">133</span></a>        <span class="c1"># Load synchronization data</span>
</span><span id="UrFallLoader.load_data-134"><a href="#UrFallLoader.load_data-134"><span class="linenos">134</span></a>        <span class="k">if</span> <span class="s1">&#39;synchronization&#39;</span> <span class="ow">in</span> <span class="n">data_types</span><span class="p">:</span>
</span><span id="UrFallLoader.load_data-135"><a href="#UrFallLoader.load_data-135"><span class="linenos">135</span></a>            <span class="n">sync_data</span><span class="p">,</span> <span class="n">sync_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_synchronization</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">sequences</span><span class="p">,</span> <span class="n">use_falls</span><span class="p">,</span> <span class="n">use_adls</span><span class="p">)</span>
</span><span id="UrFallLoader.load_data-136"><a href="#UrFallLoader.load_data-136"><span class="linenos">136</span></a>            <span class="n">data_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sync_data</span><span class="p">)</span>
</span><span id="UrFallLoader.load_data-137"><a href="#UrFallLoader.load_data-137"><span class="linenos">137</span></a>            <span class="n">names_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sync_names</span><span class="p">)</span>
</span><span id="UrFallLoader.load_data-138"><a href="#UrFallLoader.load_data-138"><span class="linenos">138</span></a>        
</span><span id="UrFallLoader.load_data-139"><a href="#UrFallLoader.load_data-139"><span class="linenos">139</span></a>        <span class="c1"># Note: Depth, RGB, and Video data are image/video files</span>
</span><span id="UrFallLoader.load_data-140"><a href="#UrFallLoader.load_data-140"><span class="linenos">140</span></a>        <span class="c1"># These would require specialized loading and are not typically loaded into DataFrames</span>
</span><span id="UrFallLoader.load_data-141"><a href="#UrFallLoader.load_data-141"><span class="linenos">141</span></a>        <span class="k">if</span> <span class="s1">&#39;depth&#39;</span> <span class="ow">in</span> <span class="n">data_types</span> <span class="ow">or</span> <span class="s1">&#39;rgb&#39;</span> <span class="ow">in</span> <span class="n">data_types</span> <span class="ow">or</span> <span class="s1">&#39;video&#39;</span> <span class="ow">in</span> <span class="n">data_types</span><span class="p">:</span>
</span><span id="UrFallLoader.load_data-142"><a href="#UrFallLoader.load_data-142"><span class="linenos">142</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Note: Depth, RGB, and Video data types contain image/video files.&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader.load_data-143"><a href="#UrFallLoader.load_data-143"><span class="linenos">143</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;These are not loaded into DataFrames but their paths can be accessed.&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader.load_data-144"><a href="#UrFallLoader.load_data-144"><span class="linenos">144</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Use the get_file_paths() method to retrieve paths to these files.&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader.load_data-145"><a href="#UrFallLoader.load_data-145"><span class="linenos">145</span></a>        
</span><span id="UrFallLoader.load_data-146"><a href="#UrFallLoader.load_data-146"><span class="linenos">146</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data_list</span>
</span><span id="UrFallLoader.load_data-147"><a href="#UrFallLoader.load_data-147"><span class="linenos">147</span></a>        <span class="k">return</span> <span class="n">data_list</span><span class="p">,</span> <span class="n">names_list</span>
</span></pre></div>


            <div class="docstring"><p>Load UrFall dataset from the specified directory.</p>

<p>Args:
    data_dir: Directory containing the dataset
    data_types: List of data types to load. Options: 'depth', 'rgb', 'accelerometer',
               'synchronization', 'video', 'features' (default: ['features'])
    sequences: List of specific sequences to load (e.g., ['fall-01', 'adl-01'])
              If None, loads all based on use_falls and use_adls
    use_falls: Whether to load fall sequences (default: True)
    use_adls: Whether to load ADL (Activities of Daily Living) sequences (default: True)
    **kwargs: Additional arguments</p>

<p>Returns:
    Tuple of (data_list, names_list)</p>
</div>


                            </div>
                            <div id="UrFallLoader.get_file_paths" class="classattr">
                                        <input id="UrFallLoader.get_file_paths-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_file_paths</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">sequences</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">use_falls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">use_adls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="UrFallLoader.get_file_paths-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#UrFallLoader.get_file_paths"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="UrFallLoader.get_file_paths-296"><a href="#UrFallLoader.get_file_paths-296"><span class="linenos">296</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_file_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
</span><span id="UrFallLoader.get_file_paths-297"><a href="#UrFallLoader.get_file_paths-297"><span class="linenos">297</span></a>                       <span class="n">sequences</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="UrFallLoader.get_file_paths-298"><a href="#UrFallLoader.get_file_paths-298"><span class="linenos">298</span></a>                       <span class="n">use_falls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">use_adls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="UrFallLoader.get_file_paths-299"><a href="#UrFallLoader.get_file_paths-299"><span class="linenos">299</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader.get_file_paths-300"><a href="#UrFallLoader.get_file_paths-300"><span class="linenos">300</span></a><span class="sd">        Get file paths for image/video data types (depth, RGB, video).</span>
</span><span id="UrFallLoader.get_file_paths-301"><a href="#UrFallLoader.get_file_paths-301"><span class="linenos">301</span></a><span class="sd">        </span>
</span><span id="UrFallLoader.get_file_paths-302"><a href="#UrFallLoader.get_file_paths-302"><span class="linenos">302</span></a><span class="sd">        Args:</span>
</span><span id="UrFallLoader.get_file_paths-303"><a href="#UrFallLoader.get_file_paths-303"><span class="linenos">303</span></a><span class="sd">            data_dir: Directory containing the dataset</span>
</span><span id="UrFallLoader.get_file_paths-304"><a href="#UrFallLoader.get_file_paths-304"><span class="linenos">304</span></a><span class="sd">            data_type: Type of data (&#39;depth&#39;, &#39;rgb&#39;, &#39;video&#39;)</span>
</span><span id="UrFallLoader.get_file_paths-305"><a href="#UrFallLoader.get_file_paths-305"><span class="linenos">305</span></a><span class="sd">            sequences: Specific sequences to get paths for</span>
</span><span id="UrFallLoader.get_file_paths-306"><a href="#UrFallLoader.get_file_paths-306"><span class="linenos">306</span></a><span class="sd">            use_falls: Whether to include fall sequences</span>
</span><span id="UrFallLoader.get_file_paths-307"><a href="#UrFallLoader.get_file_paths-307"><span class="linenos">307</span></a><span class="sd">            use_adls: Whether to include ADL sequences</span>
</span><span id="UrFallLoader.get_file_paths-308"><a href="#UrFallLoader.get_file_paths-308"><span class="linenos">308</span></a><span class="sd">            </span>
</span><span id="UrFallLoader.get_file_paths-309"><a href="#UrFallLoader.get_file_paths-309"><span class="linenos">309</span></a><span class="sd">        Returns:</span>
</span><span id="UrFallLoader.get_file_paths-310"><a href="#UrFallLoader.get_file_paths-310"><span class="linenos">310</span></a><span class="sd">            Dictionary mapping sequence names to file paths</span>
</span><span id="UrFallLoader.get_file_paths-311"><a href="#UrFallLoader.get_file_paths-311"><span class="linenos">311</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UrFallLoader.get_file_paths-312"><a href="#UrFallLoader.get_file_paths-312"><span class="linenos">312</span></a>        <span class="k">if</span> <span class="n">data_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">,</span> <span class="s1">&#39;rgb&#39;</span><span class="p">,</span> <span class="s1">&#39;video&#39;</span><span class="p">]:</span>
</span><span id="UrFallLoader.get_file_paths-313"><a href="#UrFallLoader.get_file_paths-313"><span class="linenos">313</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;data_type must be one of: &#39;depth&#39;, &#39;rgb&#39;, &#39;video&#39;. Got: </span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader.get_file_paths-314"><a href="#UrFallLoader.get_file_paths-314"><span class="linenos">314</span></a>        
</span><span id="UrFallLoader.get_file_paths-315"><a href="#UrFallLoader.get_file_paths-315"><span class="linenos">315</span></a>        <span class="n">file_paths</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="UrFallLoader.get_file_paths-316"><a href="#UrFallLoader.get_file_paths-316"><span class="linenos">316</span></a>        
</span><span id="UrFallLoader.get_file_paths-317"><a href="#UrFallLoader.get_file_paths-317"><span class="linenos">317</span></a>        <span class="c1"># Determine which sequences to include</span>
</span><span id="UrFallLoader.get_file_paths-318"><a href="#UrFallLoader.get_file_paths-318"><span class="linenos">318</span></a>        <span class="n">seq_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader.get_file_paths-319"><a href="#UrFallLoader.get_file_paths-319"><span class="linenos">319</span></a>        <span class="k">if</span> <span class="n">sequences</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="UrFallLoader.get_file_paths-320"><a href="#UrFallLoader.get_file_paths-320"><span class="linenos">320</span></a>            <span class="n">seq_list</span> <span class="o">=</span> <span class="n">sequences</span>
</span><span id="UrFallLoader.get_file_paths-321"><a href="#UrFallLoader.get_file_paths-321"><span class="linenos">321</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="UrFallLoader.get_file_paths-322"><a href="#UrFallLoader.get_file_paths-322"><span class="linenos">322</span></a>            <span class="k">if</span> <span class="n">use_falls</span><span class="p">:</span>
</span><span id="UrFallLoader.get_file_paths-323"><a href="#UrFallLoader.get_file_paths-323"><span class="linenos">323</span></a>                <span class="n">seq_list</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;fall-</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">31</span><span class="p">)])</span>
</span><span id="UrFallLoader.get_file_paths-324"><a href="#UrFallLoader.get_file_paths-324"><span class="linenos">324</span></a>            <span class="k">if</span> <span class="n">use_adls</span><span class="p">:</span>
</span><span id="UrFallLoader.get_file_paths-325"><a href="#UrFallLoader.get_file_paths-325"><span class="linenos">325</span></a>                <span class="n">seq_list</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;adl-</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)])</span>
</span><span id="UrFallLoader.get_file_paths-326"><a href="#UrFallLoader.get_file_paths-326"><span class="linenos">326</span></a>        
</span><span id="UrFallLoader.get_file_paths-327"><a href="#UrFallLoader.get_file_paths-327"><span class="linenos">327</span></a>        <span class="c1"># Map data type to file extension</span>
</span><span id="UrFallLoader.get_file_paths-328"><a href="#UrFallLoader.get_file_paths-328"><span class="linenos">328</span></a>        <span class="n">extension_map</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="UrFallLoader.get_file_paths-329"><a href="#UrFallLoader.get_file_paths-329"><span class="linenos">329</span></a>            <span class="s1">&#39;depth&#39;</span><span class="p">:</span> <span class="s1">&#39;-cam0-d.zip&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.get_file_paths-330"><a href="#UrFallLoader.get_file_paths-330"><span class="linenos">330</span></a>            <span class="s1">&#39;rgb&#39;</span><span class="p">:</span> <span class="s1">&#39;-cam0-rgb.zip&#39;</span><span class="p">,</span>
</span><span id="UrFallLoader.get_file_paths-331"><a href="#UrFallLoader.get_file_paths-331"><span class="linenos">331</span></a>            <span class="s1">&#39;video&#39;</span><span class="p">:</span> <span class="s1">&#39;-cam0.mp4&#39;</span>
</span><span id="UrFallLoader.get_file_paths-332"><a href="#UrFallLoader.get_file_paths-332"><span class="linenos">332</span></a>        <span class="p">}</span>
</span><span id="UrFallLoader.get_file_paths-333"><a href="#UrFallLoader.get_file_paths-333"><span class="linenos">333</span></a>        
</span><span id="UrFallLoader.get_file_paths-334"><a href="#UrFallLoader.get_file_paths-334"><span class="linenos">334</span></a>        <span class="n">ext</span> <span class="o">=</span> <span class="n">extension_map</span><span class="p">[</span><span class="n">data_type</span><span class="p">]</span>
</span><span id="UrFallLoader.get_file_paths-335"><a href="#UrFallLoader.get_file_paths-335"><span class="linenos">335</span></a>        
</span><span id="UrFallLoader.get_file_paths-336"><a href="#UrFallLoader.get_file_paths-336"><span class="linenos">336</span></a>        <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="n">seq_list</span><span class="p">:</span>
</span><span id="UrFallLoader.get_file_paths-337"><a href="#UrFallLoader.get_file_paths-337"><span class="linenos">337</span></a>            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">seq</span><span class="si">}{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="UrFallLoader.get_file_paths-338"><a href="#UrFallLoader.get_file_paths-338"><span class="linenos">338</span></a>            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
</span><span id="UrFallLoader.get_file_paths-339"><a href="#UrFallLoader.get_file_paths-339"><span class="linenos">339</span></a>                <span class="n">file_paths</span><span class="p">[</span><span class="n">seq</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_path</span>
</span><span id="UrFallLoader.get_file_paths-340"><a href="#UrFallLoader.get_file_paths-340"><span class="linenos">340</span></a>        
</span><span id="UrFallLoader.get_file_paths-341"><a href="#UrFallLoader.get_file_paths-341"><span class="linenos">341</span></a>        <span class="k">return</span> <span class="n">file_paths</span>
</span></pre></div>


            <div class="docstring"><p>Get file paths for image/video data types (depth, RGB, video).</p>

<p>Args:
    data_dir: Directory containing the dataset
    data_type: Type of data ('depth', 'rgb', 'video')
    sequences: Specific sequences to get paths for
    use_falls: Whether to include fall sequences
    use_adls: Whether to include ADL sequences</p>

<p>Returns:
    Dictionary mapping sequence names to file paths</p>
</div>


                            </div>
                            <div id="UrFallLoader.create_sliding_windows" class="classattr">
                                        <input id="UrFallLoader.create_sliding_windows-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_sliding_windows</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>,</span><span class="param">	<span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>,</span><span class="param">	<span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="UrFallLoader.create_sliding_windows-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#UrFallLoader.create_sliding_windows"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="UrFallLoader.create_sliding_windows-343"><a href="#UrFallLoader.create_sliding_windows-343"><span class="linenos">343</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_sliding_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="UrFallLoader.create_sliding_windows-344"><a href="#UrFallLoader.create_sliding_windows-344"><span class="linenos">344</span></a>                               <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="UrFallLoader.create_sliding_windows-345"><a href="#UrFallLoader.create_sliding_windows-345"><span class="linenos">345</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader.create_sliding_windows-346"><a href="#UrFallLoader.create_sliding_windows-346"><span class="linenos">346</span></a><span class="sd">        Create sliding windows from the loaded data.</span>
</span><span id="UrFallLoader.create_sliding_windows-347"><a href="#UrFallLoader.create_sliding_windows-347"><span class="linenos">347</span></a><span class="sd">        </span>
</span><span id="UrFallLoader.create_sliding_windows-348"><a href="#UrFallLoader.create_sliding_windows-348"><span class="linenos">348</span></a><span class="sd">        Args:</span>
</span><span id="UrFallLoader.create_sliding_windows-349"><a href="#UrFallLoader.create_sliding_windows-349"><span class="linenos">349</span></a><span class="sd">            data: List of DataFrames containing the dataset</span>
</span><span id="UrFallLoader.create_sliding_windows-350"><a href="#UrFallLoader.create_sliding_windows-350"><span class="linenos">350</span></a><span class="sd">            names: List of names corresponding to each DataFrame</span>
</span><span id="UrFallLoader.create_sliding_windows-351"><a href="#UrFallLoader.create_sliding_windows-351"><span class="linenos">351</span></a><span class="sd">            window_size: Size of the sliding window (default: 30 frames for depth features)</span>
</span><span id="UrFallLoader.create_sliding_windows-352"><a href="#UrFallLoader.create_sliding_windows-352"><span class="linenos">352</span></a><span class="sd">            step_size: Step size for sliding window (default: 15 frames)</span>
</span><span id="UrFallLoader.create_sliding_windows-353"><a href="#UrFallLoader.create_sliding_windows-353"><span class="linenos">353</span></a><span class="sd">            </span>
</span><span id="UrFallLoader.create_sliding_windows-354"><a href="#UrFallLoader.create_sliding_windows-354"><span class="linenos">354</span></a><span class="sd">        Returns:</span>
</span><span id="UrFallLoader.create_sliding_windows-355"><a href="#UrFallLoader.create_sliding_windows-355"><span class="linenos">355</span></a><span class="sd">            List of dictionaries containing windowed data</span>
</span><span id="UrFallLoader.create_sliding_windows-356"><a href="#UrFallLoader.create_sliding_windows-356"><span class="linenos">356</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UrFallLoader.create_sliding_windows-357"><a href="#UrFallLoader.create_sliding_windows-357"><span class="linenos">357</span></a>        <span class="n">windows_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader.create_sliding_windows-358"><a href="#UrFallLoader.create_sliding_windows-358"><span class="linenos">358</span></a>        
</span><span id="UrFallLoader.create_sliding_windows-359"><a href="#UrFallLoader.create_sliding_windows-359"><span class="linenos">359</span></a>        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span><span id="UrFallLoader.create_sliding_windows-360"><a href="#UrFallLoader.create_sliding_windows-360"><span class="linenos">360</span></a>            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="UrFallLoader.create_sliding_windows-361"><a href="#UrFallLoader.create_sliding_windows-361"><span class="linenos">361</span></a>                <span class="k">continue</span>
</span><span id="UrFallLoader.create_sliding_windows-362"><a href="#UrFallLoader.create_sliding_windows-362"><span class="linenos">362</span></a>            
</span><span id="UrFallLoader.create_sliding_windows-363"><a href="#UrFallLoader.create_sliding_windows-363"><span class="linenos">363</span></a>            <span class="c1"># Get numeric feature columns (exclude metadata columns)</span>
</span><span id="UrFallLoader.create_sliding_windows-364"><a href="#UrFallLoader.create_sliding_windows-364"><span class="linenos">364</span></a>            <span class="n">exclude_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sequence_name&#39;</span><span class="p">,</span> <span class="s1">&#39;frame_number&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;activity_type&#39;</span><span class="p">,</span> <span class="s1">&#39;activity_id&#39;</span><span class="p">]</span>
</span><span id="UrFallLoader.create_sliding_windows-365"><a href="#UrFallLoader.create_sliding_windows-365"><span class="linenos">365</span></a>            <span class="n">feature_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> 
</span><span id="UrFallLoader.create_sliding_windows-366"><a href="#UrFallLoader.create_sliding_windows-366"><span class="linenos">366</span></a>                          <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude_cols</span> <span class="ow">and</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])]</span>
</span><span id="UrFallLoader.create_sliding_windows-367"><a href="#UrFallLoader.create_sliding_windows-367"><span class="linenos">367</span></a>            
</span><span id="UrFallLoader.create_sliding_windows-368"><a href="#UrFallLoader.create_sliding_windows-368"><span class="linenos">368</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">feature_cols</span><span class="p">:</span>
</span><span id="UrFallLoader.create_sliding_windows-369"><a href="#UrFallLoader.create_sliding_windows-369"><span class="linenos">369</span></a>                <span class="k">continue</span>
</span><span id="UrFallLoader.create_sliding_windows-370"><a href="#UrFallLoader.create_sliding_windows-370"><span class="linenos">370</span></a>            
</span><span id="UrFallLoader.create_sliding_windows-371"><a href="#UrFallLoader.create_sliding_windows-371"><span class="linenos">371</span></a>            <span class="n">windows</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader.create_sliding_windows-372"><a href="#UrFallLoader.create_sliding_windows-372"><span class="linenos">372</span></a>            
</span><span id="UrFallLoader.create_sliding_windows-373"><a href="#UrFallLoader.create_sliding_windows-373"><span class="linenos">373</span></a>            <span class="c1"># Create windows for each feature column</span>
</span><span id="UrFallLoader.create_sliding_windows-374"><a href="#UrFallLoader.create_sliding_windows-374"><span class="linenos">374</span></a>            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">feature_cols</span><span class="p">:</span>
</span><span id="UrFallLoader.create_sliding_windows-375"><a href="#UrFallLoader.create_sliding_windows-375"><span class="linenos">375</span></a>                <span class="n">win</span> <span class="o">=</span> <span class="n">sliding_window</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span><span id="UrFallLoader.create_sliding_windows-376"><a href="#UrFallLoader.create_sliding_windows-376"><span class="linenos">376</span></a>                <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">col</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">win</span><span class="p">})</span>
</span><span id="UrFallLoader.create_sliding_windows-377"><a href="#UrFallLoader.create_sliding_windows-377"><span class="linenos">377</span></a>            
</span><span id="UrFallLoader.create_sliding_windows-378"><a href="#UrFallLoader.create_sliding_windows-378"><span class="linenos">378</span></a>            <span class="c1"># Create windows for labels if present</span>
</span><span id="UrFallLoader.create_sliding_windows-379"><a href="#UrFallLoader.create_sliding_windows-379"><span class="linenos">379</span></a>            <span class="k">if</span> <span class="s1">&#39;label&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="UrFallLoader.create_sliding_windows-380"><a href="#UrFallLoader.create_sliding_windows-380"><span class="linenos">380</span></a>                <span class="n">label_windows</span> <span class="o">=</span> <span class="n">sliding_window</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span><span id="UrFallLoader.create_sliding_windows-381"><a href="#UrFallLoader.create_sliding_windows-381"><span class="linenos">381</span></a>                <span class="c1"># Majority voting for each window</span>
</span><span id="UrFallLoader.create_sliding_windows-382"><a href="#UrFallLoader.create_sliding_windows-382"><span class="linenos">382</span></a>                <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="UrFallLoader.create_sliding_windows-383"><a href="#UrFallLoader.create_sliding_windows-383"><span class="linenos">383</span></a>                <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">label_windows</span><span class="p">:</span>
</span><span id="UrFallLoader.create_sliding_windows-384"><a href="#UrFallLoader.create_sliding_windows-384"><span class="linenos">384</span></a>                    <span class="n">vals</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="UrFallLoader.create_sliding_windows-385"><a href="#UrFallLoader.create_sliding_windows-385"><span class="linenos">385</span></a>                    <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">counts</span><span class="p">)])</span>
</span><span id="UrFallLoader.create_sliding_windows-386"><a href="#UrFallLoader.create_sliding_windows-386"><span class="linenos">386</span></a>                <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">)})</span>
</span><span id="UrFallLoader.create_sliding_windows-387"><a href="#UrFallLoader.create_sliding_windows-387"><span class="linenos">387</span></a>            
</span><span id="UrFallLoader.create_sliding_windows-388"><a href="#UrFallLoader.create_sliding_windows-388"><span class="linenos">388</span></a>            <span class="c1"># Create activity_id windows</span>
</span><span id="UrFallLoader.create_sliding_windows-389"><a href="#UrFallLoader.create_sliding_windows-389"><span class="linenos">389</span></a>            <span class="k">if</span> <span class="s1">&#39;activity_id&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="UrFallLoader.create_sliding_windows-390"><a href="#UrFallLoader.create_sliding_windows-390"><span class="linenos">390</span></a>                <span class="n">activity_windows</span> <span class="o">=</span> <span class="n">sliding_window</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;activity_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span><span id="UrFallLoader.create_sliding_windows-391"><a href="#UrFallLoader.create_sliding_windows-391"><span class="linenos">391</span></a>                <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;activity_id&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">activity_windows</span><span class="p">})</span>
</span><span id="UrFallLoader.create_sliding_windows-392"><a href="#UrFallLoader.create_sliding_windows-392"><span class="linenos">392</span></a>            
</span><span id="UrFallLoader.create_sliding_windows-393"><a href="#UrFallLoader.create_sliding_windows-393"><span class="linenos">393</span></a>            <span class="n">windows_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="s2">&quot;windows&quot;</span><span class="p">:</span> <span class="n">windows</span><span class="p">})</span>
</span><span id="UrFallLoader.create_sliding_windows-394"><a href="#UrFallLoader.create_sliding_windows-394"><span class="linenos">394</span></a>        
</span><span id="UrFallLoader.create_sliding_windows-395"><a href="#UrFallLoader.create_sliding_windows-395"><span class="linenos">395</span></a>        <span class="k">return</span> <span class="n">windows_data</span>
</span></pre></div>


            <div class="docstring"><p>Create sliding windows from the loaded data.</p>

<p>Args:
    data: List of DataFrames containing the dataset
    names: List of names corresponding to each DataFrame
    window_size: Size of the sliding window (default: 30 frames for depth features)
    step_size: Step size for sliding window (default: 15 frames)</p>

<p>Returns:
    List of dictionaries containing windowed data</p>
</div>


                            </div>
                            <div id="UrFallLoader.get_supported_formats" class="classattr">
                                        <input id="UrFallLoader.get_supported_formats-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_supported_formats</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="UrFallLoader.get_supported_formats-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#UrFallLoader.get_supported_formats"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="UrFallLoader.get_supported_formats-397"><a href="#UrFallLoader.get_supported_formats-397"><span class="linenos">397</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_supported_formats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="UrFallLoader.get_supported_formats-398"><a href="#UrFallLoader.get_supported_formats-398"><span class="linenos">398</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader.get_supported_formats-399"><a href="#UrFallLoader.get_supported_formats-399"><span class="linenos">399</span></a><span class="sd">        Get list of supported file formats for UrFall dataset.</span>
</span><span id="UrFallLoader.get_supported_formats-400"><a href="#UrFallLoader.get_supported_formats-400"><span class="linenos">400</span></a><span class="sd">        </span>
</span><span id="UrFallLoader.get_supported_formats-401"><a href="#UrFallLoader.get_supported_formats-401"><span class="linenos">401</span></a><span class="sd">        Returns:</span>
</span><span id="UrFallLoader.get_supported_formats-402"><a href="#UrFallLoader.get_supported_formats-402"><span class="linenos">402</span></a><span class="sd">            List of supported file extensions</span>
</span><span id="UrFallLoader.get_supported_formats-403"><a href="#UrFallLoader.get_supported_formats-403"><span class="linenos">403</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UrFallLoader.get_supported_formats-404"><a href="#UrFallLoader.get_supported_formats-404"><span class="linenos">404</span></a>        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;.zip&#39;</span><span class="p">,</span> <span class="s1">&#39;.mp4&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get list of supported file formats for UrFall dataset.</p>

<p>Returns:
    List of supported file extensions</p>
</div>


                            </div>
                            <div id="UrFallLoader.get_sensor_info" class="classattr">
                                        <input id="UrFallLoader.get_sensor_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_sensor_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="nb">any</span><span class="o">&gt;</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="UrFallLoader.get_sensor_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#UrFallLoader.get_sensor_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="UrFallLoader.get_sensor_info-406"><a href="#UrFallLoader.get_sensor_info-406"><span class="linenos">406</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sensor_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">any</span><span class="p">]:</span>
</span><span id="UrFallLoader.get_sensor_info-407"><a href="#UrFallLoader.get_sensor_info-407"><span class="linenos">407</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader.get_sensor_info-408"><a href="#UrFallLoader.get_sensor_info-408"><span class="linenos">408</span></a><span class="sd">        Get information about sensors in the dataset.</span>
</span><span id="UrFallLoader.get_sensor_info-409"><a href="#UrFallLoader.get_sensor_info-409"><span class="linenos">409</span></a><span class="sd">        </span>
</span><span id="UrFallLoader.get_sensor_info-410"><a href="#UrFallLoader.get_sensor_info-410"><span class="linenos">410</span></a><span class="sd">        Returns:</span>
</span><span id="UrFallLoader.get_sensor_info-411"><a href="#UrFallLoader.get_sensor_info-411"><span class="linenos">411</span></a><span class="sd">            Dictionary containing sensor information</span>
</span><span id="UrFallLoader.get_sensor_info-412"><a href="#UrFallLoader.get_sensor_info-412"><span class="linenos">412</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UrFallLoader.get_sensor_info-413"><a href="#UrFallLoader.get_sensor_info-413"><span class="linenos">413</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="UrFallLoader.get_sensor_info-414"><a href="#UrFallLoader.get_sensor_info-414"><span class="linenos">414</span></a>            <span class="s1">&#39;data_types&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;data_types&#39;</span><span class="p">],</span>
</span><span id="UrFallLoader.get_sensor_info-415"><a href="#UrFallLoader.get_sensor_info-415"><span class="linenos">415</span></a>            <span class="s1">&#39;camera&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;camera&#39;</span><span class="p">],</span>
</span><span id="UrFallLoader.get_sensor_info-416"><a href="#UrFallLoader.get_sensor_info-416"><span class="linenos">416</span></a>            <span class="s1">&#39;sampling_frequency&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;sampling_frequency&#39;</span><span class="p">],</span>
</span><span id="UrFallLoader.get_sensor_info-417"><a href="#UrFallLoader.get_sensor_info-417"><span class="linenos">417</span></a>            <span class="s1">&#39;accelerometer_frequency&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;accelerometer_frequency&#39;</span><span class="p">]</span>
</span><span id="UrFallLoader.get_sensor_info-418"><a href="#UrFallLoader.get_sensor_info-418"><span class="linenos">418</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Get information about sensors in the dataset.</p>

<p>Returns:
    Dictionary containing sensor information</p>
</div>


                            </div>
                            <div id="UrFallLoader.get_activity_info" class="classattr">
                                        <input id="UrFallLoader.get_activity_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_activity_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="UrFallLoader.get_activity_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#UrFallLoader.get_activity_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="UrFallLoader.get_activity_info-420"><a href="#UrFallLoader.get_activity_info-420"><span class="linenos">420</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_activity_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="UrFallLoader.get_activity_info-421"><a href="#UrFallLoader.get_activity_info-421"><span class="linenos">421</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader.get_activity_info-422"><a href="#UrFallLoader.get_activity_info-422"><span class="linenos">422</span></a><span class="sd">        Get information about activities in the dataset.</span>
</span><span id="UrFallLoader.get_activity_info-423"><a href="#UrFallLoader.get_activity_info-423"><span class="linenos">423</span></a><span class="sd">        </span>
</span><span id="UrFallLoader.get_activity_info-424"><a href="#UrFallLoader.get_activity_info-424"><span class="linenos">424</span></a><span class="sd">        Returns:</span>
</span><span id="UrFallLoader.get_activity_info-425"><a href="#UrFallLoader.get_activity_info-425"><span class="linenos">425</span></a><span class="sd">            Dictionary mapping activity IDs to labels</span>
</span><span id="UrFallLoader.get_activity_info-426"><a href="#UrFallLoader.get_activity_info-426"><span class="linenos">426</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UrFallLoader.get_activity_info-427"><a href="#UrFallLoader.get_activity_info-427"><span class="linenos">427</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;activities&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get information about activities in the dataset.</p>

<p>Returns:
    Dictionary mapping activity IDs to labels</p>
</div>


                            </div>
                            <div id="UrFallLoader.get_feature_info" class="classattr">
                                        <input id="UrFallLoader.get_feature_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_feature_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="UrFallLoader.get_feature_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#UrFallLoader.get_feature_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="UrFallLoader.get_feature_info-429"><a href="#UrFallLoader.get_feature_info-429"><span class="linenos">429</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_feature_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="UrFallLoader.get_feature_info-430"><a href="#UrFallLoader.get_feature_info-430"><span class="linenos">430</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UrFallLoader.get_feature_info-431"><a href="#UrFallLoader.get_feature_info-431"><span class="linenos">431</span></a><span class="sd">        Get information about pre-extracted features.</span>
</span><span id="UrFallLoader.get_feature_info-432"><a href="#UrFallLoader.get_feature_info-432"><span class="linenos">432</span></a><span class="sd">        </span>
</span><span id="UrFallLoader.get_feature_info-433"><a href="#UrFallLoader.get_feature_info-433"><span class="linenos">433</span></a><span class="sd">        Returns:</span>
</span><span id="UrFallLoader.get_feature_info-434"><a href="#UrFallLoader.get_feature_info-434"><span class="linenos">434</span></a><span class="sd">            Dictionary mapping feature names to descriptions</span>
</span><span id="UrFallLoader.get_feature_info-435"><a href="#UrFallLoader.get_feature_info-435"><span class="linenos">435</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UrFallLoader.get_feature_info-436"><a href="#UrFallLoader.get_feature_info-436"><span class="linenos">436</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;feature_descriptions&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get information about pre-extracted features.</p>

<p>Returns:
    Dictionary mapping feature names to descriptions</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="core/base_classes.html#BaseDatasetLoader">gaitsetpy.core.base_classes.BaseDatasetLoader</a></dt>
                                <dd id="UrFallLoader.name" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.name">name</a></dd>
                <dd id="UrFallLoader.description" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.description">description</a></dd>
                <dd id="UrFallLoader.data" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.data">data</a></dd>
                <dd id="UrFallLoader.max_workers" class="variable"><a href="core/base_classes.html#BaseDatasetLoader.max_workers">max_workers</a></dd>
                <dd id="UrFallLoader.download_files_concurrent" class="function"><a href="core/base_classes.html#BaseDatasetLoader.download_files_concurrent">download_files_concurrent</a></dd>
                <dd id="UrFallLoader.set_max_workers" class="function"><a href="core/base_classes.html#BaseDatasetLoader.set_max_workers">set_max_workers</a></dd>
                <dd id="UrFallLoader.get_download_stats" class="function"><a href="core/base_classes.html#BaseDatasetLoader.get_download_stats">get_download_stats</a></dd>
                <dd id="UrFallLoader.get_info" class="function"><a href="core/base_classes.html#BaseDatasetLoader.get_info">get_info</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="load_daphnet_data">
                            <input id="load_daphnet_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_daphnet_data</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="load_daphnet_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#load_daphnet_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="load_daphnet_data-177"><a href="#load_daphnet_data-177"><span class="linenos">177</span></a><span class="k">def</span><span class="w"> </span><span class="nf">load_daphnet_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="load_daphnet_data-178"><a href="#load_daphnet_data-178"><span class="linenos">178</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="load_daphnet_data-179"><a href="#load_daphnet_data-179"><span class="linenos">179</span></a><span class="sd">    Legacy function for loading Daphnet data.</span>
</span><span id="load_daphnet_data-180"><a href="#load_daphnet_data-180"><span class="linenos">180</span></a><span class="sd">    </span>
</span><span id="load_daphnet_data-181"><a href="#load_daphnet_data-181"><span class="linenos">181</span></a><span class="sd">    Args:</span>
</span><span id="load_daphnet_data-182"><a href="#load_daphnet_data-182"><span class="linenos">182</span></a><span class="sd">        data_dir: Directory to store the dataset</span>
</span><span id="load_daphnet_data-183"><a href="#load_daphnet_data-183"><span class="linenos">183</span></a><span class="sd">        </span>
</span><span id="load_daphnet_data-184"><a href="#load_daphnet_data-184"><span class="linenos">184</span></a><span class="sd">    Returns:</span>
</span><span id="load_daphnet_data-185"><a href="#load_daphnet_data-185"><span class="linenos">185</span></a><span class="sd">        Tuple of (data_list, names_list)</span>
</span><span id="load_daphnet_data-186"><a href="#load_daphnet_data-186"><span class="linenos">186</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="load_daphnet_data-187"><a href="#load_daphnet_data-187"><span class="linenos">187</span></a>    <span class="n">loader</span> <span class="o">=</span> <span class="n">DaphnetLoader</span><span class="p">()</span>
</span><span id="load_daphnet_data-188"><a href="#load_daphnet_data-188"><span class="linenos">188</span></a>    <span class="k">return</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Legacy function for loading Daphnet data.</p>

<p>Args:
    data_dir: Directory to store the dataset</p>

<p>Returns:
    Tuple of (data_list, names_list)</p>
</div>


                </section>
                <section id="create_sliding_windows">
                            <input id="create_sliding_windows-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_sliding_windows</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">daphnet</span>, </span><span class="param"><span class="n">daphnet_names</span>, </span><span class="param"><span class="n">window_size</span><span class="o">=</span><span class="mi">192</span>, </span><span class="param"><span class="n">step_size</span><span class="o">=</span><span class="mi">32</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="create_sliding_windows-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_sliding_windows"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_sliding_windows-191"><a href="#create_sliding_windows-191"><span class="linenos">191</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_sliding_windows</span><span class="p">(</span><span class="n">daphnet</span><span class="p">,</span> <span class="n">daphnet_names</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">192</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="mi">32</span><span class="p">):</span>
</span><span id="create_sliding_windows-192"><a href="#create_sliding_windows-192"><span class="linenos">192</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_sliding_windows-193"><a href="#create_sliding_windows-193"><span class="linenos">193</span></a><span class="sd">    Legacy function for creating sliding windows.</span>
</span><span id="create_sliding_windows-194"><a href="#create_sliding_windows-194"><span class="linenos">194</span></a><span class="sd">    </span>
</span><span id="create_sliding_windows-195"><a href="#create_sliding_windows-195"><span class="linenos">195</span></a><span class="sd">    Args:</span>
</span><span id="create_sliding_windows-196"><a href="#create_sliding_windows-196"><span class="linenos">196</span></a><span class="sd">        daphnet: List of dataframes containing Daphnet data</span>
</span><span id="create_sliding_windows-197"><a href="#create_sliding_windows-197"><span class="linenos">197</span></a><span class="sd">        daphnet_names: List of names of the Daphnet dataframes</span>
</span><span id="create_sliding_windows-198"><a href="#create_sliding_windows-198"><span class="linenos">198</span></a><span class="sd">        window_size: Size of the sliding window</span>
</span><span id="create_sliding_windows-199"><a href="#create_sliding_windows-199"><span class="linenos">199</span></a><span class="sd">        step_size: Step size for the sliding window</span>
</span><span id="create_sliding_windows-200"><a href="#create_sliding_windows-200"><span class="linenos">200</span></a><span class="sd">        </span>
</span><span id="create_sliding_windows-201"><a href="#create_sliding_windows-201"><span class="linenos">201</span></a><span class="sd">    Returns:</span>
</span><span id="create_sliding_windows-202"><a href="#create_sliding_windows-202"><span class="linenos">202</span></a><span class="sd">        List of dictionaries containing sliding windows for each DataFrame</span>
</span><span id="create_sliding_windows-203"><a href="#create_sliding_windows-203"><span class="linenos">203</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_sliding_windows-204"><a href="#create_sliding_windows-204"><span class="linenos">204</span></a>    <span class="n">loader</span> <span class="o">=</span> <span class="n">DaphnetLoader</span><span class="p">()</span>
</span><span id="create_sliding_windows-205"><a href="#create_sliding_windows-205"><span class="linenos">205</span></a>    <span class="k">return</span> <span class="n">loader</span><span class="o">.</span><span class="n">create_sliding_windows</span><span class="p">(</span><span class="n">daphnet</span><span class="p">,</span> <span class="n">daphnet_names</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Legacy function for creating sliding windows.</p>

<p>Args:
    daphnet: List of dataframes containing Daphnet data
    daphnet_names: List of names of the Daphnet dataframes
    window_size: Size of the sliding window
    step_size: Step size for the sliding window</p>

<p>Returns:
    List of dictionaries containing sliding windows for each DataFrame</p>
</div>


                </section>
                <section id="load_mobifall_data">
                            <input id="load_mobifall_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_mobifall_data</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="load_mobifall_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#load_mobifall_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="load_mobifall_data-111"><a href="#load_mobifall_data-111"><span class="linenos">111</span></a><span class="k">def</span><span class="w"> </span><span class="nf">load_mobifall_data</span><span class="p">():</span>
</span><span id="load_mobifall_data-112"><a href="#load_mobifall_data-112"><span class="linenos">112</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="load_mobifall_data-113"><a href="#load_mobifall_data-113"><span class="linenos">113</span></a><span class="sd">    Legacy function for loading MobiFall data.</span>
</span><span id="load_mobifall_data-114"><a href="#load_mobifall_data-114"><span class="linenos">114</span></a><span class="sd">    </span>
</span><span id="load_mobifall_data-115"><a href="#load_mobifall_data-115"><span class="linenos">115</span></a><span class="sd">    Returns:</span>
</span><span id="load_mobifall_data-116"><a href="#load_mobifall_data-116"><span class="linenos">116</span></a><span class="sd">        Tuple of (data_list, names_list)</span>
</span><span id="load_mobifall_data-117"><a href="#load_mobifall_data-117"><span class="linenos">117</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="load_mobifall_data-118"><a href="#load_mobifall_data-118"><span class="linenos">118</span></a>    <span class="n">loader</span> <span class="o">=</span> <span class="n">MobiFallLoader</span><span class="p">()</span>
</span><span id="load_mobifall_data-119"><a href="#load_mobifall_data-119"><span class="linenos">119</span></a>    <span class="k">return</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Legacy function for loading MobiFall data.</p>

<p>Returns:
    Tuple of (data_list, names_list)</p>
</div>


                </section>
                <section id="load_arduous_data">
                            <input id="load_arduous_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_arduous_data</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="load_arduous_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#load_arduous_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="load_arduous_data-111"><a href="#load_arduous_data-111"><span class="linenos">111</span></a><span class="k">def</span><span class="w"> </span><span class="nf">load_arduous_data</span><span class="p">():</span>
</span><span id="load_arduous_data-112"><a href="#load_arduous_data-112"><span class="linenos">112</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="load_arduous_data-113"><a href="#load_arduous_data-113"><span class="linenos">113</span></a><span class="sd">    Legacy function for loading Arduous data.</span>
</span><span id="load_arduous_data-114"><a href="#load_arduous_data-114"><span class="linenos">114</span></a><span class="sd">    </span>
</span><span id="load_arduous_data-115"><a href="#load_arduous_data-115"><span class="linenos">115</span></a><span class="sd">    Returns:</span>
</span><span id="load_arduous_data-116"><a href="#load_arduous_data-116"><span class="linenos">116</span></a><span class="sd">        Tuple of (data_list, names_list)</span>
</span><span id="load_arduous_data-117"><a href="#load_arduous_data-117"><span class="linenos">117</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="load_arduous_data-118"><a href="#load_arduous_data-118"><span class="linenos">118</span></a>    <span class="n">loader</span> <span class="o">=</span> <span class="n">ArduousLoader</span><span class="p">()</span>
</span><span id="load_arduous_data-119"><a href="#load_arduous_data-119"><span class="linenos">119</span></a>    <span class="k">return</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Legacy function for loading Arduous data.</p>

<p>Returns:
    Tuple of (data_list, names_list)</p>
</div>


                </section>
                <section id="load_physionet_data">
                            <input id="load_physionet_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_physionet_data</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="load_physionet_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#load_physionet_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="load_physionet_data-338"><a href="#load_physionet_data-338"><span class="linenos">338</span></a><span class="k">def</span><span class="w"> </span><span class="nf">load_physionet_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="load_physionet_data-339"><a href="#load_physionet_data-339"><span class="linenos">339</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="load_physionet_data-340"><a href="#load_physionet_data-340"><span class="linenos">340</span></a><span class="sd">    Legacy function to load PhysioNet data.</span>
</span><span id="load_physionet_data-341"><a href="#load_physionet_data-341"><span class="linenos">341</span></a><span class="sd">    </span>
</span><span id="load_physionet_data-342"><a href="#load_physionet_data-342"><span class="linenos">342</span></a><span class="sd">    Args:</span>
</span><span id="load_physionet_data-343"><a href="#load_physionet_data-343"><span class="linenos">343</span></a><span class="sd">        data_dir: Directory containing the dataset</span>
</span><span id="load_physionet_data-344"><a href="#load_physionet_data-344"><span class="linenos">344</span></a><span class="sd">        </span>
</span><span id="load_physionet_data-345"><a href="#load_physionet_data-345"><span class="linenos">345</span></a><span class="sd">    Returns:</span>
</span><span id="load_physionet_data-346"><a href="#load_physionet_data-346"><span class="linenos">346</span></a><span class="sd">        Tuple of (data_list, names_list)</span>
</span><span id="load_physionet_data-347"><a href="#load_physionet_data-347"><span class="linenos">347</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="load_physionet_data-348"><a href="#load_physionet_data-348"><span class="linenos">348</span></a>    <span class="n">loader</span> <span class="o">=</span> <span class="n">PhysioNetLoader</span><span class="p">()</span>
</span><span id="load_physionet_data-349"><a href="#load_physionet_data-349"><span class="linenos">349</span></a>    <span class="k">return</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Legacy function to load PhysioNet data.</p>

<p>Args:
    data_dir: Directory containing the dataset</p>

<p>Returns:
    Tuple of (data_list, names_list)</p>
</div>


                </section>
                <section id="create_physionet_windows">
                            <input id="create_physionet_windows-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_physionet_windows</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>,</span><span class="param">	<span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">600</span>,</span><span class="param">	<span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="create_physionet_windows-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_physionet_windows"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_physionet_windows-352"><a href="#create_physionet_windows-352"><span class="linenos">352</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_physionet_windows</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> 
</span><span id="create_physionet_windows-353"><a href="#create_physionet_windows-353"><span class="linenos">353</span></a>                           <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">600</span><span class="p">,</span> <span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="create_physionet_windows-354"><a href="#create_physionet_windows-354"><span class="linenos">354</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_physionet_windows-355"><a href="#create_physionet_windows-355"><span class="linenos">355</span></a><span class="sd">    Legacy function to create sliding windows from PhysioNet data.</span>
</span><span id="create_physionet_windows-356"><a href="#create_physionet_windows-356"><span class="linenos">356</span></a><span class="sd">    </span>
</span><span id="create_physionet_windows-357"><a href="#create_physionet_windows-357"><span class="linenos">357</span></a><span class="sd">    Args:</span>
</span><span id="create_physionet_windows-358"><a href="#create_physionet_windows-358"><span class="linenos">358</span></a><span class="sd">        data: List of DataFrames</span>
</span><span id="create_physionet_windows-359"><a href="#create_physionet_windows-359"><span class="linenos">359</span></a><span class="sd">        names: List of names</span>
</span><span id="create_physionet_windows-360"><a href="#create_physionet_windows-360"><span class="linenos">360</span></a><span class="sd">        window_size: Size of sliding window</span>
</span><span id="create_physionet_windows-361"><a href="#create_physionet_windows-361"><span class="linenos">361</span></a><span class="sd">        step_size: Step size for sliding window</span>
</span><span id="create_physionet_windows-362"><a href="#create_physionet_windows-362"><span class="linenos">362</span></a><span class="sd">        </span>
</span><span id="create_physionet_windows-363"><a href="#create_physionet_windows-363"><span class="linenos">363</span></a><span class="sd">    Returns:</span>
</span><span id="create_physionet_windows-364"><a href="#create_physionet_windows-364"><span class="linenos">364</span></a><span class="sd">        List of sliding window dictionaries</span>
</span><span id="create_physionet_windows-365"><a href="#create_physionet_windows-365"><span class="linenos">365</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_physionet_windows-366"><a href="#create_physionet_windows-366"><span class="linenos">366</span></a>    <span class="n">loader</span> <span class="o">=</span> <span class="n">PhysioNetLoader</span><span class="p">()</span>
</span><span id="create_physionet_windows-367"><a href="#create_physionet_windows-367"><span class="linenos">367</span></a>    <span class="k">return</span> <span class="n">loader</span><span class="o">.</span><span class="n">create_sliding_windows</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span> 
</span></pre></div>


            <div class="docstring"><p>Legacy function to create sliding windows from PhysioNet data.</p>

<p>Args:
    data: List of DataFrames
    names: List of names
    window_size: Size of sliding window
    step_size: Step size for sliding window</p>

<p>Returns:
    List of sliding window dictionaries</p>
</div>


                </section>
                <section id="load_harup_data">
                            <input id="load_harup_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_harup_data</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">subjects</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">activities</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">trials</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="load_harup_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#load_harup_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="load_harup_data-399"><a href="#load_harup_data-399"><span class="linenos">399</span></a><span class="k">def</span><span class="w"> </span><span class="nf">load_harup_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subjects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">activities</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="load_harup_data-400"><a href="#load_harup_data-400"><span class="linenos">400</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="load_harup_data-401"><a href="#load_harup_data-401"><span class="linenos">401</span></a><span class="sd">    Legacy function for loading HAR-UP data.</span>
</span><span id="load_harup_data-402"><a href="#load_harup_data-402"><span class="linenos">402</span></a><span class="sd">    </span>
</span><span id="load_harup_data-403"><a href="#load_harup_data-403"><span class="linenos">403</span></a><span class="sd">    Args:</span>
</span><span id="load_harup_data-404"><a href="#load_harup_data-404"><span class="linenos">404</span></a><span class="sd">        data_dir: Directory containing the dataset</span>
</span><span id="load_harup_data-405"><a href="#load_harup_data-405"><span class="linenos">405</span></a><span class="sd">        subjects: List of subject IDs to load (default: all subjects)</span>
</span><span id="load_harup_data-406"><a href="#load_harup_data-406"><span class="linenos">406</span></a><span class="sd">        activities: List of activity IDs to load (default: all activities)</span>
</span><span id="load_harup_data-407"><a href="#load_harup_data-407"><span class="linenos">407</span></a><span class="sd">        trials: List of trial IDs to load (default: all trials)</span>
</span><span id="load_harup_data-408"><a href="#load_harup_data-408"><span class="linenos">408</span></a><span class="sd">        </span>
</span><span id="load_harup_data-409"><a href="#load_harup_data-409"><span class="linenos">409</span></a><span class="sd">    Returns:</span>
</span><span id="load_harup_data-410"><a href="#load_harup_data-410"><span class="linenos">410</span></a><span class="sd">        Tuple of (data_list, names_list)</span>
</span><span id="load_harup_data-411"><a href="#load_harup_data-411"><span class="linenos">411</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="load_harup_data-412"><a href="#load_harup_data-412"><span class="linenos">412</span></a>    <span class="n">loader</span> <span class="o">=</span> <span class="n">HARUPLoader</span><span class="p">()</span>
</span><span id="load_harup_data-413"><a href="#load_harup_data-413"><span class="linenos">413</span></a>    <span class="k">return</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">subjects</span><span class="p">,</span> <span class="n">activities</span><span class="p">,</span> <span class="n">trials</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Legacy function for loading HAR-UP data.</p>

<p>Args:
    data_dir: Directory containing the dataset
    subjects: List of subject IDs to load (default: all subjects)
    activities: List of activity IDs to load (default: all activities)
    trials: List of trial IDs to load (default: all trials)</p>

<p>Returns:
    Tuple of (data_list, names_list)</p>
</div>


                </section>
                <section id="create_harup_windows">
                            <input id="create_harup_windows-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_harup_windows</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">harup_data</span>, </span><span class="param"><span class="n">harup_names</span>, </span><span class="param"><span class="n">window_size</span><span class="o">=</span><span class="mi">100</span>, </span><span class="param"><span class="n">step_size</span><span class="o">=</span><span class="mi">50</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="create_harup_windows-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_harup_windows"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_harup_windows-416"><a href="#create_harup_windows-416"><span class="linenos">416</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_harup_windows</span><span class="p">(</span><span class="n">harup_data</span><span class="p">,</span> <span class="n">harup_names</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
</span><span id="create_harup_windows-417"><a href="#create_harup_windows-417"><span class="linenos">417</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_harup_windows-418"><a href="#create_harup_windows-418"><span class="linenos">418</span></a><span class="sd">    Legacy function for creating sliding windows from HAR-UP data.</span>
</span><span id="create_harup_windows-419"><a href="#create_harup_windows-419"><span class="linenos">419</span></a><span class="sd">    </span>
</span><span id="create_harup_windows-420"><a href="#create_harup_windows-420"><span class="linenos">420</span></a><span class="sd">    Args:</span>
</span><span id="create_harup_windows-421"><a href="#create_harup_windows-421"><span class="linenos">421</span></a><span class="sd">        harup_data: List of dataframes containing HAR-UP data</span>
</span><span id="create_harup_windows-422"><a href="#create_harup_windows-422"><span class="linenos">422</span></a><span class="sd">        harup_names: List of names of the HAR-UP dataframes</span>
</span><span id="create_harup_windows-423"><a href="#create_harup_windows-423"><span class="linenos">423</span></a><span class="sd">        window_size: Size of the sliding window</span>
</span><span id="create_harup_windows-424"><a href="#create_harup_windows-424"><span class="linenos">424</span></a><span class="sd">        step_size: Step size for the sliding window</span>
</span><span id="create_harup_windows-425"><a href="#create_harup_windows-425"><span class="linenos">425</span></a><span class="sd">        </span>
</span><span id="create_harup_windows-426"><a href="#create_harup_windows-426"><span class="linenos">426</span></a><span class="sd">    Returns:</span>
</span><span id="create_harup_windows-427"><a href="#create_harup_windows-427"><span class="linenos">427</span></a><span class="sd">        List of dictionaries containing sliding windows for each DataFrame</span>
</span><span id="create_harup_windows-428"><a href="#create_harup_windows-428"><span class="linenos">428</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_harup_windows-429"><a href="#create_harup_windows-429"><span class="linenos">429</span></a>    <span class="n">loader</span> <span class="o">=</span> <span class="n">HARUPLoader</span><span class="p">()</span>
</span><span id="create_harup_windows-430"><a href="#create_harup_windows-430"><span class="linenos">430</span></a>    <span class="k">return</span> <span class="n">loader</span><span class="o">.</span><span class="n">create_sliding_windows</span><span class="p">(</span><span class="n">harup_data</span><span class="p">,</span> <span class="n">harup_names</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Legacy function for creating sliding windows from HAR-UP data.</p>

<p>Args:
    harup_data: List of dataframes containing HAR-UP data
    harup_names: List of names of the HAR-UP dataframes
    window_size: Size of the sliding window
    step_size: Step size for the sliding window</p>

<p>Returns:
    List of dictionaries containing sliding windows for each DataFrame</p>
</div>


                </section>
                <section id="extract_harup_features">
                            <input id="extract_harup_features-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">extract_harup_features</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">windows_data</span>, </span><span class="param"><span class="n">time_domain</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="n">freq_domain</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="extract_harup_features-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#extract_harup_features"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="extract_harup_features-433"><a href="#extract_harup_features-433"><span class="linenos">433</span></a><span class="k">def</span><span class="w"> </span><span class="nf">extract_harup_features</span><span class="p">(</span><span class="n">windows_data</span><span class="p">,</span> <span class="n">time_domain</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">freq_domain</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="extract_harup_features-434"><a href="#extract_harup_features-434"><span class="linenos">434</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="extract_harup_features-435"><a href="#extract_harup_features-435"><span class="linenos">435</span></a><span class="sd">    Legacy function for extracting features from HAR-UP windows.</span>
</span><span id="extract_harup_features-436"><a href="#extract_harup_features-436"><span class="linenos">436</span></a><span class="sd">    </span>
</span><span id="extract_harup_features-437"><a href="#extract_harup_features-437"><span class="linenos">437</span></a><span class="sd">    Args:</span>
</span><span id="extract_harup_features-438"><a href="#extract_harup_features-438"><span class="linenos">438</span></a><span class="sd">        windows_data: List of dictionaries containing sliding windows</span>
</span><span id="extract_harup_features-439"><a href="#extract_harup_features-439"><span class="linenos">439</span></a><span class="sd">        time_domain: Whether to extract time domain features</span>
</span><span id="extract_harup_features-440"><a href="#extract_harup_features-440"><span class="linenos">440</span></a><span class="sd">        freq_domain: Whether to extract frequency domain features</span>
</span><span id="extract_harup_features-441"><a href="#extract_harup_features-441"><span class="linenos">441</span></a><span class="sd">        </span>
</span><span id="extract_harup_features-442"><a href="#extract_harup_features-442"><span class="linenos">442</span></a><span class="sd">    Returns:</span>
</span><span id="extract_harup_features-443"><a href="#extract_harup_features-443"><span class="linenos">443</span></a><span class="sd">        List of dictionaries containing extracted features</span>
</span><span id="extract_harup_features-444"><a href="#extract_harup_features-444"><span class="linenos">444</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="extract_harup_features-445"><a href="#extract_harup_features-445"><span class="linenos">445</span></a>    <span class="n">loader</span> <span class="o">=</span> <span class="n">HARUPLoader</span><span class="p">()</span>
</span><span id="extract_harup_features-446"><a href="#extract_harup_features-446"><span class="linenos">446</span></a>    <span class="k">return</span> <span class="n">loader</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">windows_data</span><span class="p">,</span> <span class="n">time_domain</span><span class="p">,</span> <span class="n">freq_domain</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Legacy function for extracting features from HAR-UP windows.</p>

<p>Args:
    windows_data: List of dictionaries containing sliding windows
    time_domain: Whether to extract time domain features
    freq_domain: Whether to extract frequency domain features</p>

<p>Returns:
    List of dictionaries containing extracted features</p>
</div>


                </section>
                <section id="load_urfall_data">
                            <input id="load_urfall_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_urfall_data</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">data_types</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">sequences</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">use_falls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">use_adls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="load_urfall_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#load_urfall_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="load_urfall_data-440"><a href="#load_urfall_data-440"><span class="linenos">440</span></a><span class="k">def</span><span class="w"> </span><span class="nf">load_urfall_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_types</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="load_urfall_data-441"><a href="#load_urfall_data-441"><span class="linenos">441</span></a>                     <span class="n">sequences</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="load_urfall_data-442"><a href="#load_urfall_data-442"><span class="linenos">442</span></a>                     <span class="n">use_falls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">use_adls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="load_urfall_data-443"><a href="#load_urfall_data-443"><span class="linenos">443</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="load_urfall_data-444"><a href="#load_urfall_data-444"><span class="linenos">444</span></a><span class="sd">    Load UrFall dataset using the legacy function interface.</span>
</span><span id="load_urfall_data-445"><a href="#load_urfall_data-445"><span class="linenos">445</span></a><span class="sd">    </span>
</span><span id="load_urfall_data-446"><a href="#load_urfall_data-446"><span class="linenos">446</span></a><span class="sd">    Args:</span>
</span><span id="load_urfall_data-447"><a href="#load_urfall_data-447"><span class="linenos">447</span></a><span class="sd">        data_dir: Directory containing the dataset</span>
</span><span id="load_urfall_data-448"><a href="#load_urfall_data-448"><span class="linenos">448</span></a><span class="sd">        data_types: List of data types to load</span>
</span><span id="load_urfall_data-449"><a href="#load_urfall_data-449"><span class="linenos">449</span></a><span class="sd">        sequences: List of specific sequences to load</span>
</span><span id="load_urfall_data-450"><a href="#load_urfall_data-450"><span class="linenos">450</span></a><span class="sd">        use_falls: Whether to load fall sequences</span>
</span><span id="load_urfall_data-451"><a href="#load_urfall_data-451"><span class="linenos">451</span></a><span class="sd">        use_adls: Whether to load ADL sequences</span>
</span><span id="load_urfall_data-452"><a href="#load_urfall_data-452"><span class="linenos">452</span></a><span class="sd">        </span>
</span><span id="load_urfall_data-453"><a href="#load_urfall_data-453"><span class="linenos">453</span></a><span class="sd">    Returns:</span>
</span><span id="load_urfall_data-454"><a href="#load_urfall_data-454"><span class="linenos">454</span></a><span class="sd">        Tuple of (data_list, names_list)</span>
</span><span id="load_urfall_data-455"><a href="#load_urfall_data-455"><span class="linenos">455</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="load_urfall_data-456"><a href="#load_urfall_data-456"><span class="linenos">456</span></a>    <span class="n">loader</span> <span class="o">=</span> <span class="n">UrFallLoader</span><span class="p">()</span>
</span><span id="load_urfall_data-457"><a href="#load_urfall_data-457"><span class="linenos">457</span></a>    <span class="k">return</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">data_types</span><span class="o">=</span><span class="n">data_types</span><span class="p">,</span> <span class="n">sequences</span><span class="o">=</span><span class="n">sequences</span><span class="p">,</span>
</span><span id="load_urfall_data-458"><a href="#load_urfall_data-458"><span class="linenos">458</span></a>                           <span class="n">use_falls</span><span class="o">=</span><span class="n">use_falls</span><span class="p">,</span> <span class="n">use_adls</span><span class="o">=</span><span class="n">use_adls</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Load UrFall dataset using the legacy function interface.</p>

<p>Args:
    data_dir: Directory containing the dataset
    data_types: List of data types to load
    sequences: List of specific sequences to load
    use_falls: Whether to load fall sequences
    use_adls: Whether to load ADL sequences</p>

<p>Returns:
    Tuple of (data_list, names_list)</p>
</div>


                </section>
                <section id="create_urfall_windows">
                            <input id="create_urfall_windows-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_urfall_windows</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">urfall_data</span>, </span><span class="param"><span class="n">urfall_names</span>, </span><span class="param"><span class="n">window_size</span><span class="o">=</span><span class="mi">30</span>, </span><span class="param"><span class="n">step_size</span><span class="o">=</span><span class="mi">15</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="create_urfall_windows-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_urfall_windows"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_urfall_windows-461"><a href="#create_urfall_windows-461"><span class="linenos">461</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_urfall_windows</span><span class="p">(</span><span class="n">urfall_data</span><span class="p">,</span> <span class="n">urfall_names</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="mi">15</span><span class="p">):</span>
</span><span id="create_urfall_windows-462"><a href="#create_urfall_windows-462"><span class="linenos">462</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_urfall_windows-463"><a href="#create_urfall_windows-463"><span class="linenos">463</span></a><span class="sd">    Create sliding windows from UrFall data using the legacy function interface.</span>
</span><span id="create_urfall_windows-464"><a href="#create_urfall_windows-464"><span class="linenos">464</span></a><span class="sd">    </span>
</span><span id="create_urfall_windows-465"><a href="#create_urfall_windows-465"><span class="linenos">465</span></a><span class="sd">    Args:</span>
</span><span id="create_urfall_windows-466"><a href="#create_urfall_windows-466"><span class="linenos">466</span></a><span class="sd">        urfall_data: List of DataFrames</span>
</span><span id="create_urfall_windows-467"><a href="#create_urfall_windows-467"><span class="linenos">467</span></a><span class="sd">        urfall_names: List of names</span>
</span><span id="create_urfall_windows-468"><a href="#create_urfall_windows-468"><span class="linenos">468</span></a><span class="sd">        window_size: Size of sliding window</span>
</span><span id="create_urfall_windows-469"><a href="#create_urfall_windows-469"><span class="linenos">469</span></a><span class="sd">        step_size: Step size for sliding window</span>
</span><span id="create_urfall_windows-470"><a href="#create_urfall_windows-470"><span class="linenos">470</span></a><span class="sd">        </span>
</span><span id="create_urfall_windows-471"><a href="#create_urfall_windows-471"><span class="linenos">471</span></a><span class="sd">    Returns:</span>
</span><span id="create_urfall_windows-472"><a href="#create_urfall_windows-472"><span class="linenos">472</span></a><span class="sd">        List of dictionaries containing windowed data</span>
</span><span id="create_urfall_windows-473"><a href="#create_urfall_windows-473"><span class="linenos">473</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_urfall_windows-474"><a href="#create_urfall_windows-474"><span class="linenos">474</span></a>    <span class="n">loader</span> <span class="o">=</span> <span class="n">UrFallLoader</span><span class="p">()</span>
</span><span id="create_urfall_windows-475"><a href="#create_urfall_windows-475"><span class="linenos">475</span></a>    <span class="k">return</span> <span class="n">loader</span><span class="o">.</span><span class="n">create_sliding_windows</span><span class="p">(</span><span class="n">urfall_data</span><span class="p">,</span> <span class="n">urfall_names</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create sliding windows from UrFall data using the legacy function interface.</p>

<p>Args:
    urfall_data: List of DataFrames
    urfall_names: List of names
    window_size: Size of sliding window
    step_size: Step size for sliding window</p>

<p>Returns:
    List of dictionaries containing windowed data</p>
</div>


                </section>
                <section id="download_dataset">
                            <input id="download_dataset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">download_dataset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">dataset_name</span>, </span><span class="param"><span class="n">data_dir</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="download_dataset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#download_dataset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="download_dataset-25"><a href="#download_dataset-25"><span class="linenos">25</span></a><span class="k">def</span><span class="w"> </span><span class="nf">download_dataset</span><span class="p">(</span><span class="n">dataset_name</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">):</span>
</span><span id="download_dataset-26"><a href="#download_dataset-26"><span class="linenos">26</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Download the dataset.&quot;&quot;&quot;</span>
</span><span id="download_dataset-27"><a href="#download_dataset-27"><span class="linenos">27</span></a>    <span class="k">if</span> <span class="n">dataset_name</span> <span class="o">==</span> <span class="s2">&quot;daphnet&quot;</span><span class="p">:</span>
</span><span id="download_dataset-28"><a href="#download_dataset-28"><span class="linenos">28</span></a>        <span class="n">download_daphnet_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</span><span id="download_dataset-29"><a href="#download_dataset-29"><span class="linenos">29</span></a>    <span class="k">elif</span> <span class="n">dataset_name</span> <span class="o">==</span> <span class="s2">&quot;mobifall&quot;</span><span class="p">:</span>
</span><span id="download_dataset-30"><a href="#download_dataset-30"><span class="linenos">30</span></a>        <span class="n">download_mobifall_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</span><span id="download_dataset-31"><a href="#download_dataset-31"><span class="linenos">31</span></a>    <span class="k">elif</span> <span class="n">dataset_name</span> <span class="o">==</span> <span class="s2">&quot;arduous&quot;</span><span class="p">:</span>
</span><span id="download_dataset-32"><a href="#download_dataset-32"><span class="linenos">32</span></a>        <span class="n">download_arduous_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</span><span id="download_dataset-33"><a href="#download_dataset-33"><span class="linenos">33</span></a>    <span class="k">elif</span> <span class="n">dataset_name</span> <span class="o">==</span> <span class="s2">&quot;harup&quot;</span><span class="p">:</span>
</span><span id="download_dataset-34"><a href="#download_dataset-34"><span class="linenos">34</span></a>        <span class="n">download_harup_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</span><span id="download_dataset-35"><a href="#download_dataset-35"><span class="linenos">35</span></a>    <span class="k">elif</span> <span class="n">dataset_name</span> <span class="o">==</span> <span class="s2">&quot;urfall&quot;</span><span class="p">:</span>
</span><span id="download_dataset-36"><a href="#download_dataset-36"><span class="linenos">36</span></a>        <span class="n">download_urfall_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</span><span id="download_dataset-37"><a href="#download_dataset-37"><span class="linenos">37</span></a>    <span class="k">elif</span> <span class="n">dataset_name</span> <span class="o">==</span> <span class="s2">&quot;physionet&quot;</span><span class="p">:</span>
</span><span id="download_dataset-38"><a href="#download_dataset-38"><span class="linenos">38</span></a>        <span class="c1"># PhysioNet dataset is handled by the PhysioNetLoader itself</span>
</span><span id="download_dataset-39"><a href="#download_dataset-39"><span class="linenos">39</span></a>        <span class="k">pass</span>
</span><span id="download_dataset-40"><a href="#download_dataset-40"><span class="linenos">40</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="download_dataset-41"><a href="#download_dataset-41"><span class="linenos">41</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataset </span><span class="si">{</span><span class="n">dataset_name</span><span class="si">}</span><span class="s2"> not supported.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Download the dataset.</p>
</div>


                </section>
                <section id="extract_dataset">
                            <input id="extract_dataset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">extract_dataset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">dataset_name</span>, </span><span class="param"><span class="n">data_dir</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="extract_dataset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#extract_dataset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="extract_dataset-243"><a href="#extract_dataset-243"><span class="linenos">243</span></a><span class="k">def</span><span class="w"> </span><span class="nf">extract_dataset</span><span class="p">(</span><span class="n">dataset_name</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">):</span>
</span><span id="extract_dataset-244"><a href="#extract_dataset-244"><span class="linenos">244</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract the dataset.&quot;&quot;&quot;</span>
</span><span id="extract_dataset-245"><a href="#extract_dataset-245"><span class="linenos">245</span></a>    <span class="k">if</span> <span class="n">dataset_name</span> <span class="o">==</span> <span class="s2">&quot;daphnet&quot;</span><span class="p">:</span>
</span><span id="extract_dataset-246"><a href="#extract_dataset-246"><span class="linenos">246</span></a>        <span class="n">extract_daphnet_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</span><span id="extract_dataset-247"><a href="#extract_dataset-247"><span class="linenos">247</span></a>    <span class="k">elif</span> <span class="n">dataset_name</span> <span class="o">==</span> <span class="s2">&quot;mobifall&quot;</span><span class="p">:</span>
</span><span id="extract_dataset-248"><a href="#extract_dataset-248"><span class="linenos">248</span></a>        <span class="n">extract_mobifall_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</span><span id="extract_dataset-249"><a href="#extract_dataset-249"><span class="linenos">249</span></a>    <span class="k">elif</span> <span class="n">dataset_name</span> <span class="o">==</span> <span class="s2">&quot;arduous&quot;</span><span class="p">:</span>
</span><span id="extract_dataset-250"><a href="#extract_dataset-250"><span class="linenos">250</span></a>        <span class="n">extract_arduous_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</span><span id="extract_dataset-251"><a href="#extract_dataset-251"><span class="linenos">251</span></a>    <span class="k">elif</span> <span class="n">dataset_name</span> <span class="o">==</span> <span class="s2">&quot;harup&quot;</span><span class="p">:</span>
</span><span id="extract_dataset-252"><a href="#extract_dataset-252"><span class="linenos">252</span></a>        <span class="n">extract_harup_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</span><span id="extract_dataset-253"><a href="#extract_dataset-253"><span class="linenos">253</span></a>    <span class="k">elif</span> <span class="n">dataset_name</span> <span class="o">==</span> <span class="s2">&quot;urfall&quot;</span><span class="p">:</span>
</span><span id="extract_dataset-254"><a href="#extract_dataset-254"><span class="linenos">254</span></a>        <span class="n">extract_urfall_data</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</span><span id="extract_dataset-255"><a href="#extract_dataset-255"><span class="linenos">255</span></a>    <span class="k">elif</span> <span class="n">dataset_name</span> <span class="o">==</span> <span class="s2">&quot;physionet&quot;</span><span class="p">:</span>
</span><span id="extract_dataset-256"><a href="#extract_dataset-256"><span class="linenos">256</span></a>        <span class="c1"># PhysioNet dataset is handled by the PhysioNetLoader itself</span>
</span><span id="extract_dataset-257"><a href="#extract_dataset-257"><span class="linenos">257</span></a>        <span class="k">pass</span>
</span><span id="extract_dataset-258"><a href="#extract_dataset-258"><span class="linenos">258</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="extract_dataset-259"><a href="#extract_dataset-259"><span class="linenos">259</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataset </span><span class="si">{</span><span class="n">dataset_name</span><span class="si">}</span><span class="s2"> not supported.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Extract the dataset.</p>
</div>


                </section>
                <section id="sliding_window">
                            <input id="sliding_window-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sliding_window</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data</span>, </span><span class="param"><span class="n">window_size</span>, </span><span class="param"><span class="n">step_size</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="sliding_window-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#sliding_window"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="sliding_window-320"><a href="#sliding_window-320"><span class="linenos">320</span></a><span class="k">def</span><span class="w"> </span><span class="nf">sliding_window</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">):</span>
</span><span id="sliding_window-321"><a href="#sliding_window-321"><span class="linenos">321</span></a>    <span class="k">if</span> <span class="n">window_size</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">step_size</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="sliding_window-322"><a href="#sliding_window-322"><span class="linenos">322</span></a>        <span class="k">return</span> <span class="p">[]</span>
</span><span id="sliding_window-323"><a href="#sliding_window-323"><span class="linenos">323</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">window_size</span><span class="p">:</span>
</span><span id="sliding_window-324"><a href="#sliding_window-324"><span class="linenos">324</span></a>        <span class="k">return</span> <span class="p">[]</span>
</span><span id="sliding_window-325"><a href="#sliding_window-325"><span class="linenos">325</span></a>    <span class="n">num_windows</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">window_size</span><span class="p">)</span> <span class="o">//</span> <span class="n">step_size</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="sliding_window-326"><a href="#sliding_window-326"><span class="linenos">326</span></a>    <span class="n">windows</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="sliding_window-327"><a href="#sliding_window-327"><span class="linenos">327</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_windows</span><span class="p">):</span>
</span><span id="sliding_window-328"><a href="#sliding_window-328"><span class="linenos">328</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">step_size</span>
</span><span id="sliding_window-329"><a href="#sliding_window-329"><span class="linenos">329</span></a>        <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">window_size</span>
</span><span id="sliding_window-330"><a href="#sliding_window-330"><span class="linenos">330</span></a>        <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">])</span>
</span><span id="sliding_window-331"><a href="#sliding_window-331"><span class="linenos">331</span></a>    <span class="k">return</span> <span class="n">windows</span>
</span></pre></div>


    

                </section>
                <section id="get_dataset_manager">
                            <input id="get_dataset_manager-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_dataset_manager</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_dataset_manager-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_dataset_manager"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_dataset_manager-53"><a href="#get_dataset_manager-53"><span class="linenos">53</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_dataset_manager</span><span class="p">():</span>
</span><span id="get_dataset_manager-54"><a href="#get_dataset_manager-54"><span class="linenos">54</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the singleton DatasetManager instance.&quot;&quot;&quot;</span>
</span><span id="get_dataset_manager-55"><a href="#get_dataset_manager-55"><span class="linenos">55</span></a>    <span class="k">return</span> <span class="n">DatasetManager</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Get the singleton DatasetManager instance.</p>
</div>


                </section>
                <section id="get_available_datasets">
                            <input id="get_available_datasets-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_available_datasets</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_available_datasets-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_available_datasets"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_available_datasets-58"><a href="#get_available_datasets-58"><span class="linenos">58</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_available_datasets</span><span class="p">():</span>
</span><span id="get_available_datasets-59"><a href="#get_available_datasets-59"><span class="linenos">59</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get list of available dataset names.&quot;&quot;&quot;</span>
</span><span id="get_available_datasets-60"><a href="#get_available_datasets-60"><span class="linenos">60</span></a>    <span class="k">return</span> <span class="n">DatasetManager</span><span class="p">()</span><span class="o">.</span><span class="n">get_available_components</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Get list of available dataset names.</p>
</div>


                </section>
                <section id="load_dataset">
                            <input id="load_dataset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_dataset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="load_dataset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#load_dataset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="load_dataset-63"><a href="#load_dataset-63"><span class="linenos">63</span></a><span class="k">def</span><span class="w"> </span><span class="nf">load_dataset</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="load_dataset-64"><a href="#load_dataset-64"><span class="linenos">64</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="load_dataset-65"><a href="#load_dataset-65"><span class="linenos">65</span></a><span class="sd">    Load a dataset using the DatasetManager.</span>
</span><span id="load_dataset-66"><a href="#load_dataset-66"><span class="linenos">66</span></a><span class="sd">    </span>
</span><span id="load_dataset-67"><a href="#load_dataset-67"><span class="linenos">67</span></a><span class="sd">    Args:</span>
</span><span id="load_dataset-68"><a href="#load_dataset-68"><span class="linenos">68</span></a><span class="sd">        name: Name of the dataset loader</span>
</span><span id="load_dataset-69"><a href="#load_dataset-69"><span class="linenos">69</span></a><span class="sd">        data_dir: Directory containing the dataset</span>
</span><span id="load_dataset-70"><a href="#load_dataset-70"><span class="linenos">70</span></a><span class="sd">        **kwargs: Additional arguments for the loader</span>
</span><span id="load_dataset-71"><a href="#load_dataset-71"><span class="linenos">71</span></a><span class="sd">        </span>
</span><span id="load_dataset-72"><a href="#load_dataset-72"><span class="linenos">72</span></a><span class="sd">    Returns:</span>
</span><span id="load_dataset-73"><a href="#load_dataset-73"><span class="linenos">73</span></a><span class="sd">        Dataset loader instance with loaded data</span>
</span><span id="load_dataset-74"><a href="#load_dataset-74"><span class="linenos">74</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="load_dataset-75"><a href="#load_dataset-75"><span class="linenos">75</span></a>    <span class="k">return</span> <span class="n">DatasetManager</span><span class="p">()</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Load a dataset using the DatasetManager.</p>

<p>Args:
    name: Name of the dataset loader
    data_dir: Directory containing the dataset
    **kwargs: Additional arguments for the loader</p>

<p>Returns:
    Dataset loader instance with loaded data</p>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>